[0m11:56:44.112577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AB9E82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AC3BDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AE4ABA00>]}


============================== 11:56:44.120150 | 3bc744ac-3861-4099-b8c6-56291d2cd0ef ==============================
[0m11:56:44.120150 [info ] [MainThread]: Running with dbt=1.8.5
[0m11:56:44.122160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m11:56:44.204764 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'packages': 'dbt-labs/dbt-utils', 'version': '1.1.1', 'unrendered': {'packages': 'dbt-labs/dbt-utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  

Error encountered in E:\Programing\DE\Practice\dbt-snowflake\dbtairflow\dbt_project.yml
[0m11:56:44.207776 [debug] [MainThread]: Command `dbt deps` failed at 11:56:44.207776 after 0.19 seconds
[0m11:56:44.208781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AB9E82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AE5EE0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220AE5EE880>]}
[0m11:56:44.208781 [debug] [MainThread]: Flushing usage events
[0m11:58:57.027080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B313C82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B31D6ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B33EDCFA0>]}


============================== 11:58:57.033827 | 6c297d92-9ec8-4c26-a9fd-236b55f713ec ==============================
[0m11:58:57.033827 [info ] [MainThread]: Running with dbt=1.8.5
[0m11:58:57.035895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:58:57.130438 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'packages': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'packages': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  

Error encountered in E:\Programing\DE\Practice\dbt-snowflake\dbtairflow\dbt_project.yml
[0m11:58:57.134954 [debug] [MainThread]: Command `dbt deps` failed at 11:58:57.134954 after 0.20 seconds
[0m11:58:57.136149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B313C82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B33F728E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B33F722E0>]}
[0m11:58:57.136149 [debug] [MainThread]: Flushing usage events
[0m11:59:51.234518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016956C282E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016957610B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695952D6D0>]}


============================== 11:59:51.240519 | 226940cb-cc91-42d1-a5b9-d948373a9685 ==============================
[0m11:59:51.240519 [info ] [MainThread]: Running with dbt=1.8.5
[0m11:59:51.242519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:51.422371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '226940cb-cc91-42d1-a5b9-d948373a9685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001695970B2E0>]}
[0m11:59:51.479273 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-remt3q1u'
[0m11:59:51.480326 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:59:51.999730 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:59:52.001699 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m11:59:52.567556 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m11:59:52.569270 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `Datavault-UK/dbtvault` package is deprecated in favor of
`Datavault-UK/automate_dv`. Please update your `packages.yml` configuration to
use `Datavault-UK/automate_dv` instead.
[0m11:59:52.571284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '226940cb-cc91-42d1-a5b9-d948373a9685', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016959273790>]}
[0m11:59:52.576998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_constraints.json
[0m11:59:53.161326 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_constraints.json 200
[0m11:59:53.163324 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m11:59:53.380609 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m11:59:53.385490 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:59:53.512984 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:59:53.519470 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m11:59:53.660231 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m11:59:53.665737 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=1.0.0', '<2.0.0', '>=0.8.0', '<0.9.0']
[0m11:59:53.672187 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 412, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 325, in reduce
    raise VersionsNotCompatibleError()
dbt_common.exceptions.base.VersionsNotCompatibleError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\registry.py", line 103, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 414, in reduce_versions
    raise VersionsNotCompatibleError(
dbt_common.exceptions.base.VersionsNotCompatibleError: Could not find a satisfactory version from options: ['>=1.0.0', '<2.0.0', '>=0.8.0', '<0.9.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\main.py", line 447, in deps
    results = task.run()
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\task\deps.py", line 217, in run
    self.lock()
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\task\deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\registry.py", line 106, in resolved
    raise DependencyError(new_msg) from e
dbt.exceptions.DependencyError: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=1.0.0', '<2.0.0', '>=0.8.0', '<0.9.0']

[0m11:59:53.676504 [debug] [MainThread]: Command `dbt deps` failed at 11:59:53.675968 after 2.52 seconds
[0m11:59:53.677556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016956C282E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016956A93130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016956A93BE0>]}
[0m11:59:53.678102 [debug] [MainThread]: Flushing usage events
[0m12:01:27.151597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAE5A82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAEF4ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB10BBFD0>]}


============================== 12:01:27.158133 | e2cdfa6f-93bf-4a05-a327-d9fc0ebfbe16 ==============================
[0m12:01:27.158133 [info ] [MainThread]: Running with dbt=1.8.5
[0m12:01:27.159809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:01:27.296851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2cdfa6f-93bf-4a05-a327-d9fc0ebfbe16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB10BBF10>]}
[0m12:01:27.338011 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-8l4_io4i'
[0m12:01:27.339010 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:01:27.871224 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:01:27.873423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m12:01:28.248002 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m12:01:28.249014 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `Datavault-UK/dbtvault` package is deprecated in favor of
`Datavault-UK/automate_dv`. Please update your `packages.yml` configuration to
use `Datavault-UK/automate_dv` instead.
[0m12:01:28.250478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e2cdfa6f-93bf-4a05-a327-d9fc0ebfbe16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB0EAD790>]}
[0m12:01:28.256504 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_constraints.json
[0m12:01:28.856502 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_constraints.json 200
[0m12:01:28.859027 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:01:29.233852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:01:29.239357 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:01:29.365817 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:01:29.372500 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<0.9.0', '>=1.0.0', '<2.0.0']
[0m12:01:29.376141 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 412, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 325, in reduce
    raise VersionsNotCompatibleError()
dbt_common.exceptions.base.VersionsNotCompatibleError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\registry.py", line 103, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt_common\semver.py", line 414, in reduce_versions
    raise VersionsNotCompatibleError(
dbt_common.exceptions.base.VersionsNotCompatibleError: Could not find a satisfactory version from options: ['>=0.8.0', '<0.9.0', '>=1.0.0', '<2.0.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\cli\main.py", line 447, in deps
    results = task.run()
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\task\deps.py", line 217, in run
    self.lock()
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\task\deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "C:\Users\admin\.conda\envs\dbt-snowflake\lib\site-packages\dbt\deps\registry.py", line 106, in resolved
    raise DependencyError(new_msg) from e
dbt.exceptions.DependencyError: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<0.9.0', '>=1.0.0', '<2.0.0']

[0m12:01:29.381702 [debug] [MainThread]: Command `dbt deps` failed at 12:01:29.381702 after 2.34 seconds
[0m12:01:29.382695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAE5A82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAE4103A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAE410FA0>]}
[0m12:01:29.382695 [debug] [MainThread]: Flushing usage events
[0m12:01:49.370918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286661782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C99BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C99EB0>]}


============================== 12:01:49.378854 | 197a76ed-970b-4513-9307-d0aa43eea333 ==============================
[0m12:01:49.378854 [info ] [MainThread]: Running with dbt=1.8.5
[0m12:01:49.380852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:49.514196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '197a76ed-970b-4513-9307-d0aa43eea333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C71280>]}
[0m12:01:49.557155 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-v5zdjg7l'
[0m12:01:49.558338 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:01:49.692285 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:01:49.693591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:01:49.737242 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:01:49.753798 [info ] [MainThread]: Updating lock file in file path: E:\Programing\DE\Practice\dbt-snowflake\dbtairflow/package-lock.yml
[0m12:01:49.767499 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-y1wdj_s3'
[0m12:01:49.772290 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:01:50.662018 [info ] [MainThread]: Installed from version 0.8.6
[0m12:01:50.663014 [info ] [MainThread]: Updated version available: 1.2.0
[0m12:01:50.664018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '197a76ed-970b-4513-9307-d0aa43eea333', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C11790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668DEBA60>]}
[0m12:01:50.665018 [info ] [MainThread]: 
[0m12:01:50.666016 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:01:50.668045 [debug] [MainThread]: Command `dbt deps` succeeded at 12:01:50.668045 after 1.38 seconds
[0m12:01:50.669049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286661782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C71F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668C11FD0>]}
[0m12:01:50.669049 [debug] [MainThread]: Flushing usage events
[0m12:02:18.741516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9CD082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9D6DDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9F7CCA00>]}


============================== 12:02:18.749098 | e8c6835f-b63f-40fd-8933-70a70f2cff8d ==============================
[0m12:02:18.749098 [info ] [MainThread]: Running with dbt=1.8.5
[0m12:02:18.751121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:18.913625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c6835f-b63f-40fd-8933-70a70f2cff8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9F7ECE80>]}
[0m12:02:18.963473 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-y6pbp7yk'
[0m12:02:18.965388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:02:19.011661 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:02:19.013681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:02:19.156322 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:02:19.172215 [info ] [MainThread]: Updating lock file in file path: E:\Programing\DE\Practice\dbt-snowflake\dbtairflow/package-lock.yml
[0m12:02:19.229440 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-c05b3p6m'
[0m12:02:19.234070 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:02:19.927512 [info ] [MainThread]: Installed from version 1.1.1
[0m12:02:19.928514 [info ] [MainThread]: Updated version available: 1.2.0
[0m12:02:19.930521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8c6835f-b63f-40fd-8933-70a70f2cff8d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9D6AB190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9F354760>]}
[0m12:02:19.930521 [info ] [MainThread]: 
[0m12:02:19.931509 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:02:19.935163 [debug] [MainThread]: Command `dbt deps` succeeded at 12:02:19.934148 after 1.30 seconds
[0m12:02:19.935163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9CD082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9F7ECE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9F8638B0>]}
[0m12:02:19.936168 [debug] [MainThread]: Flushing usage events
[0m12:02:59.139638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AF7F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6B019ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6B231AFA0>]}


============================== 12:02:59.145422 | b2eae16d-7e04-49c5-b515-94932d5417d1 ==============================
[0m12:02:59.145422 [info ] [MainThread]: Running with dbt=1.8.5
[0m12:02:59.146430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:59.270900 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  Additional properties are not allowed ('version' was unexpected)
  

Error encountered in E:\Programing\DE\Practice\dbt-snowflake\dbtairflow\dbt_project.yml
[0m12:02:59.275794 [debug] [MainThread]: Command `dbt deps` failed at 12:02:59.274768 after 0.22 seconds
[0m12:02:59.276974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AF7F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6B0193AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6B2353E20>]}
[0m12:02:59.278399 [debug] [MainThread]: Flushing usage events
[0m12:03:10.461037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB046C82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB071E9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB071E9E20>]}


============================== 12:03:10.466874 | cf2e8929-b336-4afc-8987-21758f0bdf07 ==============================
[0m12:03:10.466874 [info ] [MainThread]: Running with dbt=1.8.5
[0m12:03:10.469479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\dbtairflow\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:10.604665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf2e8929-b336-4afc-8987-21758f0bdf07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB071E9FA0>]}
[0m12:03:10.653606 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-d45xhm15'
[0m12:03:10.654116 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:03:11.224672 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:03:11.225666 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:03:11.362023 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:03:11.374620 [info ] [MainThread]: Updating lock file in file path: E:\Programing\DE\Practice\dbt-snowflake\dbtairflow/package-lock.yml
[0m12:03:11.415916 [debug] [MainThread]: Set downloads directory='C:\Users\admin\AppData\Local\Temp\dbt-downloads-y3j7x237'
[0m12:03:11.420996 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:03:12.283263 [info ] [MainThread]: Installed from version 1.2.0
[0m12:03:12.284262 [info ] [MainThread]: Up to date!
[0m12:03:12.286391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf2e8929-b336-4afc-8987-21758f0bdf07', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB072CA130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB07281AF0>]}
[0m12:03:12.288914 [debug] [MainThread]: Command `dbt deps` succeeded at 12:03:12.288914 after 1.90 seconds
[0m12:03:12.289911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB046C82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0506B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB07192DC0>]}
[0m12:03:12.290917 [debug] [MainThread]: Flushing usage events
[0m00:03:08.439730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCA3482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCCE5CC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCCE5CFA0>]}


============================== 00:03:08.446943 | b90d3cab-eb0a-4cd0-8818-4e9933e6dd59 ==============================
[0m00:03:08.446943 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:03:08.448949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:03:13.413998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDB2F9A0>]}
[0m00:03:13.527792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCC9A8670>]}
[0m00:03:13.530799 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:03:13.582257 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m00:03:13.584260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:03:13.586262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDC4D340>]}
[0m00:03:17.504700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:03:17.506380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDEB8C10>]}
[0m00:03:18.017677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCC3E5970>]}
[0m00:03:18.255339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDF39730>]}
[0m00:03:18.256861 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 565 macros
[0m00:03:18.258011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b90d3cab-eb0a-4cd0-8818-4e9933e6dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDDE6130>]}
[0m00:03:18.260786 [info ] [MainThread]: 
[0m00:03:18.262297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:18.270229 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m00:03:18.293387 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m00:03:18.295374 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m00:03:18.295374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:30.284180 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m00:03:30.284260 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:03:30.285305 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:03:30.285305 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:03:30.287076 [debug] [ThreadPool]: On list_dbt_db: No close available on handle
[0m00:03:30.287076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:30.287076 [debug] [MainThread]: Connection 'list_dbt_db' was properly closed.
[0m00:03:30.287076 [info ] [MainThread]: 
[0m00:03:30.287076 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m00:03:30.287076 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dbt_db"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m00:03:30.294601 [debug] [MainThread]: Command `dbt run` failed at 00:03:30.294601 after 21.96 seconds
[0m00:03:30.294601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCA3482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCF250C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CCDDE6970>]}
[0m00:03:30.294601 [debug] [MainThread]: Flushing usage events
[0m00:04:28.750073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197504382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019752F50BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019752F50D90>]}


============================== 00:04:28.756020 | fcd4b224-7491-4656-be18-8b2bad98d5cb ==============================
[0m00:04:28.756020 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:04:28.756020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:29.549495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd4b224-7491-4656-be18-8b2bad98d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975087B490>]}
[0m00:04:29.667021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd4b224-7491-4656-be18-8b2bad98d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019753CBA7F0>]}
[0m00:04:29.670016 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:04:29.691115 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m00:04:30.063112 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 0 files added, 0 files changed.
[0m00:04:30.064120 [debug] [MainThread]: Partial parsing: deleted file: dbtairflow://models\marts\int_order_items.sql
[0m00:04:30.065141 [debug] [MainThread]: Partial parsing: deleted file: dbtairflow://models\staging\stg_tpch_line_items.sql
[0m00:04:30.065141 [debug] [MainThread]: Partial parsing: deleted file: dbtairflow://models\marts\int_order_items_summary.sql
[0m00:04:30.066529 [debug] [MainThread]: Partial parsing: deleted file: dbtairflow://models\marts\fct_orders.sql
[0m00:04:30.346831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:04:30.346831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:04:30.489854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:04:30.521983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd4b224-7491-4656-be18-8b2bad98d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197540F9DC0>]}
[0m00:04:30.725659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd4b224-7491-4656-be18-8b2bad98d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019753EA33A0>]}
[0m00:04:30.726941 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:04:30.727454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd4b224-7491-4656-be18-8b2bad98d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197540F92E0>]}
[0m00:04:30.731471 [info ] [MainThread]: 
[0m00:04:30.732483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:30.734985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m00:04:30.757110 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m00:04:30.758146 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m00:04:30.758665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:42.536986 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m00:04:42.536986 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:04:42.536986 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:04:42.536986 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:04:42.536986 [debug] [ThreadPool]: On list_dbt_db: No close available on handle
[0m00:04:42.536986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:42.536986 [debug] [MainThread]: Connection 'list_dbt_db' was properly closed.
[0m00:04:42.536986 [info ] [MainThread]: 
[0m00:04:42.536986 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 11.80 seconds (11.80s).
[0m00:04:42.548026 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dbt_db"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m00:04:42.549345 [debug] [MainThread]: Command `dbt run` failed at 00:04:42.549345 after 13.92 seconds
[0m00:04:42.549345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197504382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197541D2B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019753FEDA00>]}
[0m00:04:42.552227 [debug] [MainThread]: Flushing usage events
[0m00:28:14.317913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFC8382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF358B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF358DC0>]}


============================== 00:28:14.330157 | 99d67dea-5ca6-4ada-9bfb-b20d9a57061e ==============================
[0m00:28:14.330157 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:28:14.331980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:28:14.335189 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:28:14.337202 [debug] [MainThread]: Command `dbt run` failed at 00:28:14.337027 after 0.10 seconds
[0m00:28:14.338420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFC8382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF13D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF3101C0>]}
[0m00:28:14.339044 [debug] [MainThread]: Flushing usage events
[0m00:30:01.261381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FA1482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCC5FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCC5FF70>]}


============================== 00:30:01.278883 | b8cf2637-25f9-402d-888f-728124e6380e ==============================
[0m00:30:01.278883 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:30:01.282159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:01.289728 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:30:01.293759 [debug] [MainThread]: Command `dbt run` failed at 00:30:01.293113 after 0.19 seconds
[0m00:30:01.295801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FA1482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCC2C220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCC2C0A0>]}
[0m00:30:01.297669 [debug] [MainThread]: Flushing usage events
[0m00:30:28.838731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7DFB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00ACBBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00ACBF40>]}


============================== 00:30:28.844759 | a9a303e5-d9c0-4847-a44a-8fbb80f08e00 ==============================
[0m00:30:28.844759 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:30:28.846650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:28.849668 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:30:28.851449 [debug] [MainThread]: Command `dbt run` failed at 00:30:28.850944 after 0.10 seconds
[0m00:30:28.852143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7DFB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00A9CC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00A9C880>]}
[0m00:30:28.852805 [debug] [MainThread]: Flushing usage events
[0m00:32:44.451905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A5B82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4D0CA400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4D0CA0A0>]}


============================== 00:32:44.461874 | eb0f51a0-f59f-4ebd-9412-814829003bd6 ==============================
[0m00:32:44.461874 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:32:44.463847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:32:44.470532 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:32:44.473785 [debug] [MainThread]: Command `dbt run` failed at 00:32:44.473131 after 0.18 seconds
[0m00:32:44.475048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A5B82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4D09B220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4D09B0A0>]}
[0m00:32:44.476999 [debug] [MainThread]: Flushing usage events
[0m00:33:20.939004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEBC582E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEC62EEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEE716A00>]}


============================== 00:33:20.946623 | f3c8337a-cd6a-49b1-8825-a489b0f1e459 ==============================
[0m00:33:20.946623 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:33:20.947866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profile dbtairflow', 'send_anonymous_usage_stats': 'True'}
[0m00:33:21.005587 [info ] [MainThread]: dbt version: 1.8.5
[0m00:33:21.006848 [info ] [MainThread]: python version: 3.9.19
[0m00:33:21.008279 [info ] [MainThread]: python path: C:\Users\admin\.conda\envs\dbt-snowflake\python.exe
[0m00:33:21.009521 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m00:33:25.655033 [info ] [MainThread]: Using profiles dir at C:\Users\admin\.dbt
[0m00:33:25.656516 [info ] [MainThread]: Using profiles.yml file at C:\Users\admin\.dbt\profiles.yml
[0m00:33:25.658014 [info ] [MainThread]: Using dbt_project.yml file at E:\Programing\DE\Practice\dbt-snowflake\aiflow-dag\dags\dbt\dbtairflow\dbt_project.yml
[0m00:33:25.660494 [info ] [MainThread]: adapter type: snowflake
[0m00:33:25.661687 [info ] [MainThread]: adapter version: 1.8.3
[0m00:33:25.822865 [info ] [MainThread]: Configuration:
[0m00:33:25.824121 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:33:25.825379 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:33:25.826623 [info ] [MainThread]: Required dependencies:
[0m00:33:25.827874 [debug] [MainThread]: Executing "git --help"
[0m00:33:25.876461 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:33:25.877634 [debug] [MainThread]: STDERR: "b''"
[0m00:33:25.878857 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:33:25.880938 [info ] [MainThread]: Connection:
[0m00:33:25.882878 [info ] [MainThread]:   account: https://gg39262.europe-west4.gcp.snowflakecomputing.com
[0m00:33:25.884078 [info ] [MainThread]:   user: ANDREWCAO002
[0m00:33:25.884648 [info ] [MainThread]:   database: dbt_db
[0m00:33:25.885904 [info ] [MainThread]:   warehouse: dbt_wh
[0m00:33:25.887824 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:33:25.889695 [info ] [MainThread]:   schema: dbt_db.dbt_schema
[0m00:33:25.891629 [info ] [MainThread]:   authenticator: None
[0m00:33:25.893464 [info ] [MainThread]:   oauth_client_id: None
[0m00:33:25.894723 [info ] [MainThread]:   query_tag: None
[0m00:33:25.895936 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:33:25.897890 [info ] [MainThread]:   host: None
[0m00:33:25.899649 [info ] [MainThread]:   port: None
[0m00:33:25.901016 [info ] [MainThread]:   proxy_host: None
[0m00:33:25.903460 [info ] [MainThread]:   proxy_port: None
[0m00:33:25.905753 [info ] [MainThread]:   protocol: None
[0m00:33:25.907809 [info ] [MainThread]:   connect_retries: 1
[0m00:33:25.909227 [info ] [MainThread]:   connect_timeout: None
[0m00:33:25.911116 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:33:25.913059 [info ] [MainThread]:   retry_all: False
[0m00:33:25.914344 [info ] [MainThread]:   insecure_mode: False
[0m00:33:25.915638 [info ] [MainThread]:   reuse_connections: None
[0m00:33:25.918321 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:33:25.920763 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:33:25.923059 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:33:25.924541 [debug] [MainThread]: On debug: select 1 as id
[0m00:33:25.925846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:38.081630 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m00:33:38.082917 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m00:33:38.084168 [debug] [MainThread]: On debug: No close available on handle
[0m00:33:38.085313 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:33:38.086643 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:33:38.088809 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:33:38.093435 [debug] [MainThread]: Command `dbt debug` failed at 00:33:38.093435 after 17.29 seconds
[0m00:33:38.094696 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:33:38.095920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEBC582E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEF54FAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEF54F040>]}
[0m00:33:38.097073 [debug] [MainThread]: Flushing usage events
[0m00:34:42.762384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9208F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B92340BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B92340BF70>]}


============================== 00:34:42.769828 | 6fe96a8d-49aa-429b-aad1-be87de4aaee6 ==============================
[0m00:34:42.769828 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:34:42.771198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:34:42.775397 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:34:42.778124 [debug] [MainThread]: Command `dbt run` failed at 00:34:42.778124 after 0.15 seconds
[0m00:34:42.779320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9208F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9233DC220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9233DC0A0>]}
[0m00:34:42.779903 [debug] [MainThread]: Flushing usage events
[0m00:35:37.336752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDFB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C0ACACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C0ACAF10>]}


============================== 00:35:37.345957 | 4450ae1c-a068-4627-b6e8-fa5cfbac3652 ==============================
[0m00:35:37.345957 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:35:37.347938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:37.352282 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtairflow'
[0m00:35:37.355451 [debug] [MainThread]: Command `dbt run` failed at 00:35:37.354908 after 0.15 seconds
[0m00:35:37.357227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDFB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C060D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C0A517F0>]}
[0m00:35:37.358602 [debug] [MainThread]: Flushing usage events
[0m00:36:08.838521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF24E82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF2E8FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF4FFD070>]}


============================== 00:36:08.847402 | 8fb84318-28a6-43e3-9e2b-437aa55ea0d5 ==============================
[0m00:36:08.847402 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:36:08.848848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\admin\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profile dbtairflow --log-level debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:36:08.887157 [info ] [MainThread]: dbt version: 1.8.5
[0m00:36:08.888432 [info ] [MainThread]: python version: 3.9.19
[0m00:36:08.889934 [info ] [MainThread]: python path: C:\Users\admin\.conda\envs\dbt-snowflake\python.exe
[0m00:36:08.892542 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m00:36:09.520015 [info ] [MainThread]: Using profiles dir at C:\Users\admin\.dbt
[0m00:36:09.521211 [info ] [MainThread]: Using profiles.yml file at C:\Users\admin\.dbt\profiles.yml
[0m00:36:09.521960 [info ] [MainThread]: Using dbt_project.yml file at E:\Programing\DE\Practice\dbt-snowflake\aiflow-dag\dags\dbt\dbtairflow\dbt_project.yml
[0m00:36:09.524507 [info ] [MainThread]: adapter type: snowflake
[0m00:36:09.525735 [info ] [MainThread]: adapter version: 1.8.3
[0m00:36:09.700039 [info ] [MainThread]: Configuration:
[0m00:36:09.701349 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:36:09.702589 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:36:09.703851 [info ] [MainThread]: Required dependencies:
[0m00:36:09.705695 [debug] [MainThread]: Executing "git --help"
[0m00:36:09.778581 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:36:09.781108 [debug] [MainThread]: STDERR: "b''"
[0m00:36:09.782999 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:36:09.784933 [info ] [MainThread]: Connection:
[0m00:36:09.786840 [info ] [MainThread]:   account: https://gg39262.europe-west4.gcp.snowflakecomputing.com
[0m00:36:09.788085 [info ] [MainThread]:   user: ANDREWCAO002
[0m00:36:09.789971 [info ] [MainThread]:   database: dbt_db
[0m00:36:09.791791 [info ] [MainThread]:   warehouse: dbt_wh
[0m00:36:09.793170 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:36:09.795027 [info ] [MainThread]:   schema: dbt_db.dbt_schema
[0m00:36:09.796221 [info ] [MainThread]:   authenticator: None
[0m00:36:09.798677 [info ] [MainThread]:   oauth_client_id: None
[0m00:36:09.800643 [info ] [MainThread]:   query_tag: None
[0m00:36:09.801932 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:36:09.803841 [info ] [MainThread]:   host: None
[0m00:36:09.805259 [info ] [MainThread]:   port: None
[0m00:36:09.807189 [info ] [MainThread]:   proxy_host: None
[0m00:36:09.808476 [info ] [MainThread]:   proxy_port: None
[0m00:36:09.810436 [info ] [MainThread]:   protocol: None
[0m00:36:09.811662 [info ] [MainThread]:   connect_retries: 1
[0m00:36:09.813595 [info ] [MainThread]:   connect_timeout: None
[0m00:36:09.816093 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:36:09.818054 [info ] [MainThread]:   retry_all: False
[0m00:36:09.820023 [info ] [MainThread]:   insecure_mode: False
[0m00:36:09.821807 [info ] [MainThread]:   reuse_connections: None
[0m00:36:09.823856 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:36:09.825832 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:36:09.827737 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:36:09.830141 [debug] [MainThread]: On debug: select 1 as id
[0m00:36:09.832904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:36:21.693672 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m00:36:21.696676 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m00:36:21.699427 [debug] [MainThread]: On debug: No close available on handle
[0m00:36:21.703635 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:36:21.708944 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:36:21.713257 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:36:21.726371 [debug] [MainThread]: Command `dbt debug` failed at 00:36:21.725689 after 13.01 seconds
[0m00:36:21.745799 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:36:21.760696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF24E82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF5DF5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CF4FCDA00>]}
[0m00:36:21.765561 [debug] [MainThread]: Flushing usage events
[0m00:39:51.191921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053C0382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053EB4CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053EB4CF70>]}


============================== 00:39:51.202339 | ac53ccbe-a0e7-44a3-87f8-b40517f57d49 ==============================
[0m00:39:51.202339 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:39:51.203592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:39:52.151041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053C9F48B0>]}
[0m00:39:52.241282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E9D2100>]}
[0m00:39:52.243788 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:39:52.305364 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:39:52.594542 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:39:52.595899 [debug] [MainThread]: previous checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, current checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09
[0m00:39:52.597159 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:39:52.598492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E073D30>]}
[0m00:39:57.228298 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:39:57.229523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053FDC3310>]}
[0m00:39:57.430940 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:39:57.432335 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:39:57.605211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:39:57.628865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053FC56130>]}
[0m00:39:57.865630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053FD26760>]}
[0m00:39:57.866846 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:39:57.867951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac53ccbe-a0e7-44a3-87f8-b40517f57d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053FC53730>]}
[0m00:39:57.870411 [info ] [MainThread]: 
[0m00:39:57.872176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:39:57.874092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:39:57.892846 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:39:57.894166 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:39:57.895323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:01.307569 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.412 seconds
[0m00:40:01.311517 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:40:02.015411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_dbt_schema)
[0m00:40:02.022960 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "dbt_schema"
"
[0m00:40:02.031983 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_dbt_schema"
[0m00:40:02.033188 [debug] [ThreadPool]: On create_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "create_DBT_DB_dbt_schema"} */
create schema if not exists DBT_DB.dbt_schema
[0m00:40:02.034454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:03.666696 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b6a264-0001-3c09-0002-0e420002f096
[0m00:40:03.667404 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT_SCHEMA' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:40:03.669178 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m00:40:03.669935 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:40:03.671075 [debug] [ThreadPool]: On create_DBT_DB_dbt_schema: Close
[0m00:40:04.371127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:04.372435 [debug] [MainThread]: Connection 'create_DBT_DB_dbt_schema' was properly closed.
[0m00:40:04.373703 [info ] [MainThread]: 
[0m00:40:04.375562 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m00:40:04.377441 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT_SCHEMA' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:40:04.381652 [debug] [MainThread]: Command `dbt run` failed at 00:40:04.381652 after 13.34 seconds
[0m00:40:04.383467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053C0382E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053FC3C1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205411C7430>]}
[0m00:40:04.385150 [debug] [MainThread]: Flushing usage events
[0m00:41:26.420039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B67EA882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60159CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60159CF70>]}


============================== 00:41:26.429794 | eebd10bb-e9c4-4e49-b310-1641ebc68c38 ==============================
[0m00:41:26.429794 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:41:26.431804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:27.416840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebd10bb-e9c4-4e49-b310-1641ebc68c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B602383460>]}
[0m00:41:27.535486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eebd10bb-e9c4-4e49-b310-1641ebc68c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B601535E80>]}
[0m00:41:27.538253 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:41:27.562099 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:41:28.007622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:28.008562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:28.020016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:41:28.128954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebd10bb-e9c4-4e49-b310-1641ebc68c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B602781130>]}
[0m00:41:28.461359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebd10bb-e9c4-4e49-b310-1641ebc68c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B602626040>]}
[0m00:41:28.463580 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:41:28.465891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebd10bb-e9c4-4e49-b310-1641ebc68c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6023976D0>]}
[0m00:41:28.468486 [info ] [MainThread]: 
[0m00:41:28.471055 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:41:28.474906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:41:28.508700 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:41:28.509987 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:41:28.510791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:30.579538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.068 seconds
[0m00:41:30.582164 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:41:31.591076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DB, now create_DBT_DB_dbt_schema)
[0m00:41:31.592312 [debug] [ThreadPool]: Creating schema "database: "DBT_DB"
schema: "dbt_schema"
"
[0m00:41:31.601614 [debug] [ThreadPool]: Using snowflake connection "create_DBT_DB_dbt_schema"
[0m00:41:31.602811 [debug] [ThreadPool]: On create_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "create_DBT_DB_dbt_schema"} */
create schema if not exists DBT_DB.dbt_schema
[0m00:41:31.603427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:33.132078 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b6a265-0001-3c27-0002-0e420002e0d6
[0m00:41:33.133271 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT_SCHEMA' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:41:33.135067 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m00:41:33.135762 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:41:33.137005 [debug] [ThreadPool]: On create_DBT_DB_dbt_schema: Close
[0m00:41:33.948526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:33.950475 [debug] [MainThread]: Connection 'create_DBT_DB_dbt_schema' was properly closed.
[0m00:41:33.951695 [info ] [MainThread]: 
[0m00:41:33.953528 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m00:41:33.955958 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT_SCHEMA' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:41:33.960238 [debug] [MainThread]: Command `dbt run` failed at 00:41:33.959417 after 7.68 seconds
[0m00:41:33.961745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B67EA882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6039F9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6039F9970>]}
[0m00:41:33.963111 [debug] [MainThread]: Flushing usage events
[0m00:41:56.064426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAFEED82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA81A21BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA81A21F70>]}


============================== 00:41:56.075477 | 4ecada95-a4cd-4a1c-834e-644632b6e0c4 ==============================
[0m00:41:56.075477 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:41:56.077583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:41:57.033158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82803460>]}
[0m00:41:57.132487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA819B5E80>]}
[0m00:41:57.135293 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:41:57.157790 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:41:57.394397 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:41:57.396171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAFFF41F10>]}
[0m00:42:00.112758 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:42:00.114006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA83D95CD0>]}
[0m00:42:00.246922 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:42:00.248080 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:42:00.389124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:42:00.408915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA829A7130>]}
[0m00:42:00.623518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA83D564C0>]}
[0m00:42:00.624708 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:42:00.625953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA83D5F5E0>]}
[0m00:42:00.628588 [info ] [MainThread]: 
[0m00:42:00.629708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:42:00.632761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:42:00.653224 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:42:00.653903 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:42:00.655037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:02.417747 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.763 seconds
[0m00:42:02.420750 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:42:03.233312 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:42:03.253149 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:42:03.254291 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:42:03.255091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:05.091615 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.836 seconds
[0m00:42:05.095456 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:42:06.230817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAFF462A00>]}
[0m00:42:06.232756 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:42:06.234025 [info ] [MainThread]: 
[0m00:42:06.245771 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:42:06.247544 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:42:06.249099 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:42:06.250368 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:42:06.268361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:42:06.272366 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:42:06.332430 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:42:06.336594 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:42:06.337913 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:42:06.339182 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:42:07.839199 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.500 seconds
[0m00:42:07.891980 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:42:08.762020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecada95-a4cd-4a1c-834e-644632b6e0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8414B3D0>]}
[0m00:42:08.763936 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.51s]
[0m00:42:08.765828 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:42:08.775123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:08.776298 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:42:08.777132 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:42:08.778366 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:42:08.779576 [info ] [MainThread]: 
[0m00:42:08.780781 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m00:42:08.782590 [debug] [MainThread]: Command end result
[0m00:42:08.861765 [info ] [MainThread]: 
[0m00:42:08.863159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:42:08.864512 [info ] [MainThread]: 
[0m00:42:08.866447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:42:08.869719 [debug] [MainThread]: Command `dbt run` succeeded at 00:42:08.869206 after 12.94 seconds
[0m00:42:08.870505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAFEED82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAFFF41D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA82A3B9A0>]}
[0m00:42:08.871775 [debug] [MainThread]: Flushing usage events
[0m00:44:49.241241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D96B82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC1CBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC1CBFA0>]}


============================== 00:44:49.249420 | 2ea6af21-a480-4eed-928b-089d89d8dff0 ==============================
[0m00:44:49.249420 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:44:49.250735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:50.120164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC1A6430>]}
[0m00:44:50.211286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC0624F0>]}
[0m00:44:50.214213 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:44:50.238949 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:44:50.486329 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:44:50.487581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DB6F3D30>]}
[0m00:44:53.257015 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:44:53.258268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DE41B370>]}
[0m00:44:53.417285 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:44:53.419000 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:44:53.572694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:44:53.592955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DE3DE130>]}
[0m00:44:53.799506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DD037220>]}
[0m00:44:53.800629 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:44:53.801787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DE40F2B0>]}
[0m00:44:53.804222 [info ] [MainThread]: 
[0m00:44:53.805443 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:44:53.807833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:44:53.825697 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:44:53.827015 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:44:53.828241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:55.778974 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.951 seconds
[0m00:44:55.782639 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:44:56.601977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:44:56.619279 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:44:56.619978 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:44:56.621226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:58.340106 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.718 seconds
[0m00:44:58.343214 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:44:59.667757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DD037340>]}
[0m00:44:59.669492 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:44:59.670120 [info ] [MainThread]: 
[0m00:44:59.678372 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:44:59.679738 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:44:59.680935 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:44:59.682166 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:44:59.698669 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:44:59.700621 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:44:59.755189 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:44:59.757841 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:44:59.759173 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:44:59.760498 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:45:01.464045 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6a269-0001-3c27-0002-0e420002e15a
[0m00:45:01.464757 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
View 'STG_TPCH_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:45:01.466008 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:45:02.255539 [debug] [Thread-1  ]: Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003041 (42710): SQL compilation error:
  View 'STG_TPCH_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:45:02.259350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ea6af21-a480-4eed-928b-089d89d8dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DD037340>]}
[0m00:45:02.261868 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt_schema.stg_tpch_orders ................ [[31mERROR[0m in 2.58s]
[0m00:45:02.264490 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:45:02.268551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:02.269767 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:45:02.270389 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:45:02.271660 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:45:02.272937 [info ] [MainThread]: 
[0m00:45:02.274707 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m00:45:02.276673 [debug] [MainThread]: Command end result
[0m00:45:02.355770 [info ] [MainThread]: 
[0m00:45:02.358373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:45:02.359655 [info ] [MainThread]: 
[0m00:45:02.361475 [error] [MainThread]:   Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003041 (42710): SQL compilation error:
  View 'STG_TPCH_ORDERS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:45:02.363578 [info ] [MainThread]: 
[0m00:45:02.365469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:45:02.368010 [debug] [MainThread]: Command `dbt run` failed at 00:45:02.368010 after 13.26 seconds
[0m00:45:02.369284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D96B82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC0624F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DBD133D0>]}
[0m00:45:02.371045 [debug] [MainThread]: Flushing usage events
[0m00:45:59.146957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC14882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC3FA1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC3FA1FD0>]}


============================== 00:45:59.155309 | 57d03654-a153-4e9c-8e30-0de1c23571f7 ==============================
[0m00:45:59.155309 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:45:59.157085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'send_anonymous_usage_stats': 'True'}
[0m00:46:00.091813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC18CB0D0>]}
[0m00:46:00.189051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4D1A8B0>]}
[0m00:46:00.192195 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:46:00.222813 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:46:00.598186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:00.598793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:00.608631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:46:00.706371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC5061130>]}
[0m00:46:01.018070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4DC6220>]}
[0m00:46:01.019812 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:46:01.021220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4C796D0>]}
[0m00:46:01.025018 [info ] [MainThread]: 
[0m00:46:01.027210 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:01.030920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:46:01.064890 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:46:01.066152 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:46:01.067392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:03.155009 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.087 seconds
[0m00:46:03.158611 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:46:04.184749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:46:04.201634 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:46:04.202851 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:46:04.204137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:05.922434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.719 seconds
[0m00:46:05.926228 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:46:06.745957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4C796D0>]}
[0m00:46:06.747707 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:46:06.749576 [info ] [MainThread]: 
[0m00:46:06.757294 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:46:06.759146 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:46:06.761102 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:46:06.762600 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:46:06.782591 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:46:06.783815 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:46:06.839086 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:46:06.843316 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:46:06.844633 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:46:06.845241 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:46:08.383511 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6a26a-0001-3c09-0002-0e420002f10a
[0m00:46:08.384703 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
[0m00:46:08.385919 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:46:09.302016 [debug] [Thread-1  ]: Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:46:09.304846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d03654-a153-4e9c-8e30-0de1c23571f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4C796D0>]}
[0m00:46:09.306105 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt_schema.stg_tpch_orders ................ [[31mERROR[0m in 2.54s]
[0m00:46:09.308525 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:46:09.311119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:09.312044 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:46:09.313301 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:46:09.313916 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:46:09.314567 [info ] [MainThread]: 
[0m00:46:09.316308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m00:46:09.318472 [debug] [MainThread]: Command end result
[0m00:46:09.395748 [info ] [MainThread]: 
[0m00:46:09.397626 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:46:09.398930 [info ] [MainThread]: 
[0m00:46:09.400806 [error] [MainThread]:   Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:46:09.403372 [info ] [MainThread]: 
[0m00:46:09.405388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:46:09.408610 [debug] [MainThread]: Command `dbt run` failed at 00:46:09.407977 after 10.39 seconds
[0m00:46:09.409917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC14882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC4D1A8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC3AD3910>]}
[0m00:46:09.411744 [debug] [MainThread]: Flushing usage events
[0m00:53:17.506271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEBC082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEE720BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEE720FD0>]}


============================== 00:53:17.513371 | 1ac71428-4a64-4b3d-bdce-d0dfced76056 ==============================
[0m00:53:17.513371 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:53:17.515285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:18.397610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEC04C0D0>]}
[0m00:53:18.488756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF49A8B0>]}
[0m00:53:18.491835 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:53:18.519351 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:53:18.920140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:18.921344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:18.931764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:53:19.034813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF7E1130>]}
[0m00:53:19.364815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF546220>]}
[0m00:53:19.366030 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:53:19.367337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF3F96D0>]}
[0m00:53:19.369835 [info ] [MainThread]: 
[0m00:53:19.372119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:19.375407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:53:19.402530 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:53:19.403782 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:53:19.404393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:21.331039 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.926 seconds
[0m00:53:21.334219 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:53:22.146443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:53:22.165302 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:53:22.166601 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:53:22.167881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:23.582867 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.415 seconds
[0m00:53:23.586233 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:53:24.397724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF3F96D0>]}
[0m00:53:24.399509 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:53:24.400916 [info ] [MainThread]: 
[0m00:53:24.408456 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:53:24.410516 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:53:24.412637 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:53:24.414538 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:53:24.431580 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:53:24.433508 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:53:24.484769 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:53:24.488214 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:53:24.490174 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:53:24.490801 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:53:26.252670 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6a271-0001-3be1-0002-0e4200030142
[0m00:53:26.253879 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
[0m00:53:26.255790 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:53:27.162630 [debug] [Thread-1  ]: Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:53:27.166191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac71428-4a64-4b3d-bdce-d0dfced76056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEDCA6A90>]}
[0m00:53:27.167289 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt_schema.stg_tpch_orders ................ [[31mERROR[0m in 2.75s]
[0m00:53:27.170312 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:53:27.173054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:27.174219 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:53:27.175422 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:53:27.176026 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:53:27.177207 [info ] [MainThread]: 
[0m00:53:27.178907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m00:53:27.181675 [debug] [MainThread]: Command end result
[0m00:53:27.256996 [info ] [MainThread]: 
[0m00:53:27.258996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:53:27.260221 [info ] [MainThread]: 
[0m00:53:27.261470 [error] [MainThread]:   Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:53:27.264551 [info ] [MainThread]: 
[0m00:53:27.265959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:53:27.268412 [debug] [MainThread]: Command `dbt run` failed at 00:53:27.268301 after 9.90 seconds
[0m00:53:27.269523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEBC082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEF49A8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EEE254910>]}
[0m00:53:27.270267 [debug] [MainThread]: Flushing usage events
[0m00:55:18.098246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249966F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002499920BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002499920BFD0>]}


============================== 00:55:18.105653 | d42eb618-7413-45b0-a02d-46542233273c ==============================
[0m00:55:18.105653 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:55:18.107053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:18.959759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024996B3C0D0>]}
[0m00:55:19.059127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024999F8B8B0>]}
[0m00:55:19.061693 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:55:19.092451 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:55:19.481270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:19.482499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:19.493457 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:55:19.596334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002499A2D1130>]}
[0m00:55:19.925773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002499A036220>]}
[0m00:55:19.927595 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:55:19.929078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024999EE96D0>]}
[0m00:55:19.932912 [info ] [MainThread]: 
[0m00:55:19.935490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:19.938608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:55:19.968481 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:55:19.969665 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:55:19.972135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:21.950783 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.978 seconds
[0m00:55:21.954400 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:55:23.077404 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:55:23.093289 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:55:23.094600 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:55:23.095777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.020470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.925 seconds
[0m00:55:25.024396 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:55:25.948133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024999EE96D0>]}
[0m00:55:25.949407 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:55:25.950651 [info ] [MainThread]: 
[0m00:55:25.959328 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:55:25.961162 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:55:25.963208 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:55:25.964484 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:55:25.984240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:55:25.985987 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:55:26.049742 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:55:26.052257 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:55:26.053516 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:55:26.054775 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:55:27.794063 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b6a273-0001-3be1-0002-0e4200030162
[0m00:55:27.795377 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
[0m00:55:27.796611 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:55:28.613498 [debug] [Thread-1  ]: Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:55:28.616669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd42eb618-7413-45b0-a02d-46542233273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002499B51C490>]}
[0m00:55:28.617915 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt_schema.stg_tpch_orders ................ [[31mERROR[0m in 2.65s]
[0m00:55:28.620354 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:55:28.622885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:28.624090 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:55:28.625220 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:55:28.625932 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:55:28.627080 [info ] [MainThread]: 
[0m00:55:28.628623 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m00:55:28.631475 [debug] [MainThread]: Command end result
[0m00:55:28.707410 [info ] [MainThread]: 
[0m00:55:28.709131 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:55:28.710996 [info ] [MainThread]: 
[0m00:55:28.712219 [error] [MainThread]:   Database Error in model stg_tpch_orders (models\staging\stg_tpch_orders.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on view 'STG_TPCH_ORDERS'
  compiled Code at target\run\dbtairflow\models\staging\stg_tpch_orders.sql
[0m00:55:28.714767 [info ] [MainThread]: 
[0m00:55:28.716577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:55:28.719123 [debug] [MainThread]: Command `dbt run` failed at 00:55:28.718514 after 10.74 seconds
[0m00:55:28.719725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249966F82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024999F8B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024998D44910>]}
[0m00:55:28.721970 [debug] [MainThread]: Flushing usage events
[0m00:55:50.840808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022120D782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022123891C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022123891FA0>]}


============================== 00:55:50.848234 | b4aecbc6-c7ae-4471-bcd2-5712ec8af573 ==============================
[0m00:55:50.848234 [info ] [MainThread]: Running with dbt=1.8.5
[0m00:55:50.850761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:51.744146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022123866430>]}
[0m00:55:51.838325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221237244F0>]}
[0m00:55:51.840524 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:55:51.865320 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m00:55:52.104002 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:55:52.105953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022122DB3D30>]}
[0m00:55:54.871878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:55:54.873052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125AE3C70>]}
[0m00:55:55.015139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:55:55.016945 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m00:55:55.150275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtairflow.marts
[0m00:55:55.171413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125BAD130>]}
[0m00:55:55.384879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212471E2B0>]}
[0m00:55:55.386085 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 565 macros
[0m00:55:55.387317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022124728A30>]}
[0m00:55:55.390372 [info ] [MainThread]: 
[0m00:55:55.391590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:55:55.393415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m00:55:55.414086 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m00:55:55.415528 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m00:55:55.416132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:56.969369 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.553 seconds
[0m00:55:56.973106 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m00:55:57.792271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m00:55:57.814140 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m00:55:57.815440 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m00:55:57.816060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:59.541816 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.726 seconds
[0m00:55:59.545304 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m00:56:00.353925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125A58D30>]}
[0m00:56:00.355398 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:56:00.356673 [info ] [MainThread]: 
[0m00:56:00.364876 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m00:56:00.366209 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m00:56:00.368212 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m00:56:00.369837 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m00:56:00.386385 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m00:56:00.388380 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m00:56:00.440652 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m00:56:00.444002 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m00:56:00.445302 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m00:56:00.446623 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:56:01.884459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.438 seconds
[0m00:56:01.933777 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m00:56:03.116197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4aecbc6-c7ae-4471-bcd2-5712ec8af573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125A58F40>]}
[0m00:56:03.117916 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.75s]
[0m00:56:03.120019 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m00:56:03.123090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:03.124299 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m00:56:03.125408 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m00:56:03.126130 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m00:56:03.127246 [info ] [MainThread]: 
[0m00:56:03.128712 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m00:56:03.131409 [debug] [MainThread]: Command end result
[0m00:56:03.206085 [info ] [MainThread]: 
[0m00:56:03.207966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:56:03.209836 [info ] [MainThread]: 
[0m00:56:03.211670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:56:03.215097 [debug] [MainThread]: Command `dbt run` succeeded at 00:56:03.214431 after 12.49 seconds
[0m00:56:03.216325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022120D782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125A761F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221212B8790>]}
[0m00:56:03.217558 [debug] [MainThread]: Flushing usage events
[0m01:42:52.400097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD07482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD325CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD325CF70>]}


============================== 01:42:52.410838 | 6eaab0df-eeac-4d78-97f6-b9e90e8f688d ==============================
[0m01:42:52.410838 [info ] [MainThread]: Running with dbt=1.8.5
[0m01:42:52.412741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:42:53.832360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eaab0df-eeac-4d78-97f6-b9e90e8f688d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD3F4AAF0>]}
[0m01:42:53.925400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eaab0df-eeac-4d78-97f6-b9e90e8f688d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD32175E0>]}
[0m01:42:53.928413 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:42:53.960857 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m01:42:54.214090 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:42:54.215488 [debug] [MainThread]: previous checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, current checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa
[0m01:42:54.216026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6eaab0df-eeac-4d78-97f6-b9e90e8f688d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2782F10>]}
[0m01:42:57.038105 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:42:57.039929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6eaab0df-eeac-4d78-97f6-b9e90e8f688d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD555ED00>]}
[0m01:42:57.207609 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtairflow.fct_orders' (models\marts\fct_orders.sql) depends on a node named 'int_order_items_summary' which was not found
[0m01:42:57.210133 [debug] [MainThread]: Command `dbt run` failed at 01:42:57.209960 after 4.94 seconds
[0m01:42:57.217443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD07482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD407CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD3FDDF10>]}
[0m01:42:57.218535 [debug] [MainThread]: Flushing usage events
[0m01:43:20.604320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EECD082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EED6E5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEF7F7C40>]}


============================== 01:43:20.612821 | 5712cf7d-1aff-473d-88c5-c534661a0f03 ==============================
[0m01:43:20.612821 [info ] [MainThread]: Running with dbt=1.8.5
[0m01:43:20.614674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:43:21.549160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5712cf7d-1aff-473d-88c5-c534661a0f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEF7F67F0>]}
[0m01:43:21.657976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5712cf7d-1aff-473d-88c5-c534661a0f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF0508340>]}
[0m01:43:21.661279 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:43:21.686008 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m01:43:21.952771 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:43:21.953946 [debug] [MainThread]: previous checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, current checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa
[0m01:43:21.954910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5712cf7d-1aff-473d-88c5-c534661a0f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEED433A0>]}
[0m01:43:24.897597 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:43:24.898846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5712cf7d-1aff-473d-88c5-c534661a0f03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF1B1ECA0>]}
[0m01:43:25.058204 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtairflow.int_order_items_sum' (models\marts\int_order_items_sum.sql) depends on a node named 'int_order_items' which was not found
[0m01:43:25.061575 [debug] [MainThread]: Command `dbt run` failed at 01:43:25.060824 after 4.57 seconds
[0m01:43:25.062823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EECD082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF0588790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF0588C40>]}
[0m01:43:25.064057 [debug] [MainThread]: Flushing usage events
[0m01:43:50.206066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A36C182E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A39732BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A39732FD0>]}


============================== 01:43:50.213714 | c41043b6-c369-482b-8994-1a0b13a0f923 ==============================
[0m01:43:50.213714 [info ] [MainThread]: Running with dbt=1.8.5
[0m01:43:50.214979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:51.118849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A39707D90>]}
[0m01:43:51.217962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A4415B0>]}
[0m01:43:51.221013 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:43:51.245478 [debug] [MainThread]: checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, vars: {}, profile: , target: , version: 1.8.5
[0m01:43:51.482545 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:43:51.483887 [debug] [MainThread]: previous checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09, current checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa
[0m01:43:51.485049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A38C52FA0>]}
[0m01:43:54.529601 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:43:54.530821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B90ABB0>]}
[0m01:43:54.814892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B9A0130>]}
[0m01:43:55.041044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B930160>]}
[0m01:43:55.042220 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 565 macros
[0m01:43:55.043431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B922D90>]}
[0m01:43:55.045879 [info ] [MainThread]: 
[0m01:43:55.047070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:43:55.054260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m01:43:55.072319 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m01:43:55.072899 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m01:43:55.073491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:57.257322 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.184 seconds
[0m01:43:57.260957 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m01:43:58.071864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m01:43:58.089967 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m01:43:58.090709 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m01:43:58.091969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:59.611546 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.519 seconds
[0m01:43:59.614704 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m01:44:00.348648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A5A97C0>]}
[0m01:44:00.349841 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m01:44:00.351139 [info ] [MainThread]: 
[0m01:44:00.366541 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m01:44:00.367707 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m01:44:00.369076 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m01:44:00.370382 [info ] [Thread-2  ]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m01:44:00.372297 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m01:44:00.374889 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m01:44:00.376796 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m01:44:00.377910 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m01:44:00.399129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m01:44:00.405643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m01:44:00.408819 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m01:44:00.410278 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m01:44:00.460611 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m01:44:00.466233 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m01:44:00.469412 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m01:44:00.471797 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m01:44:00.472826 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m01:44:00.474181 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m01:44:00.475640 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:44:00.476349 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:44:02.165628 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.689 seconds
[0m01:44:02.212460 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m01:44:02.215026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.740 seconds
[0m01:44:02.219903 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m01:44:02.989577 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3BB25460>]}
[0m01:44:02.991547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3BDBC670>]}
[0m01:44:02.993627 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.61s]
[0m01:44:02.995341 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.62s]
[0m01:44:02.998716 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m01:44:03.000564 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m01:44:03.004096 [debug] [Thread-4  ]: Began running node model.dbtairflow.int_order_items
[0m01:44:03.005740 [info ] [Thread-4  ]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m01:44:03.007588 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.int_order_items'
[0m01:44:03.009783 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.int_order_items
[0m01:44:03.021677 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.int_order_items"
[0m01:44:03.025255 [debug] [Thread-4  ]: Began executing node model.dbtairflow.int_order_items
[0m01:44:03.102093 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.int_order_items"
[0m01:44:03.112311 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.int_order_items"
[0m01:44:03.113627 [debug] [Thread-4  ]: On model.dbtairflow.int_order_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.int_order_items"} */
create or replace transient table DBT_DB.dbt_schema.int_order_items
         as
        (select
    line_item.order_item_key,
    line_item.part_key,
    line_item.line_number,
    line_item.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    DBT_DB.dbt_schema.stg_tpch_orders as orders
join
    DBT_DB.dbt_schema.stg_tpch_line_items as line_item
        on orders.order_key = line_item.order_key
order by
    orders.order_date
        );
[0m01:44:03.114865 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:44:11.691018 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 8.576 seconds
[0m01:44:11.694836 [debug] [Thread-4  ]: On model.dbtairflow.int_order_items: Close
[0m01:44:12.607646 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3BB25460>]}
[0m01:44:12.609495 [info ] [Thread-4  ]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 9.60s]
[0m01:44:12.612470 [debug] [Thread-4  ]: Finished running node model.dbtairflow.int_order_items
[0m01:44:12.613799 [debug] [Thread-6  ]: Began running node model.dbtairflow.int_order_items_sum
[0m01:44:12.615941 [info ] [Thread-6  ]: 4 of 5 START sql table model dbt_schema.int_order_items_sum .................... [RUN]
[0m01:44:12.618017 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.int_order_items_sum'
[0m01:44:12.619351 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.int_order_items_sum
[0m01:44:12.626027 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.int_order_items_sum"
[0m01:44:12.628900 [debug] [Thread-6  ]: Began executing node model.dbtairflow.int_order_items_sum
[0m01:44:12.635472 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.int_order_items_sum"
[0m01:44:12.638423 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.int_order_items_sum"
[0m01:44:12.639638 [debug] [Thread-6  ]: On model.dbtairflow.int_order_items_sum: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.int_order_items_sum"} */
create or replace transient table DBT_DB.dbt_schema.int_order_items_sum
         as
        (select 
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(item_discount_amount) as item_discount_amount
from
    DBT_DB.dbt_schema.int_order_items
group by
    order_key
        );
[0m01:44:12.641395 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m01:44:15.680042 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.039 seconds
[0m01:44:15.683261 [debug] [Thread-6  ]: On model.dbtairflow.int_order_items_sum: Close
[0m01:44:16.602177 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3BDFCEB0>]}
[0m01:44:16.604109 [info ] [Thread-6  ]: 4 of 5 OK created sql table model dbt_schema.int_order_items_sum ............... [[32mSUCCESS 1[0m in 3.98s]
[0m01:44:16.605982 [debug] [Thread-6  ]: Finished running node model.dbtairflow.int_order_items_sum
[0m01:44:16.607804 [debug] [Thread-8  ]: Began running node model.dbtairflow.fct_orders
[0m01:44:16.609148 [info ] [Thread-8  ]: 5 of 5 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m01:44:16.611099 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.fct_orders'
[0m01:44:16.612412 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.fct_orders
[0m01:44:16.619472 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m01:44:16.626701 [debug] [Thread-8  ]: Began executing node model.dbtairflow.fct_orders
[0m01:44:16.633499 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m01:44:16.636489 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m01:44:16.638136 [debug] [Thread-8  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    DBT_DB.dbt_schema.stg_tpch_orders as orders
join
    DBT_DB.dbt_schema.int_order_items_sum as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
        );
[0m01:44:16.639535 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m01:44:20.288256 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.649 seconds
[0m01:44:20.293299 [debug] [Thread-8  ]: On model.dbtairflow.fct_orders: Close
[0m01:44:21.210846 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41043b6-c369-482b-8994-1a0b13a0f923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A38CB6A90>]}
[0m01:44:21.212527 [info ] [Thread-8  ]: 5 of 5 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 4.60s]
[0m01:44:21.215032 [debug] [Thread-8  ]: Finished running node model.dbtairflow.fct_orders
[0m01:44:21.218162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:21.219300 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m01:44:21.220017 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m01:44:21.221148 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_line_items' was properly closed.
[0m01:44:21.221854 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m01:44:21.222496 [debug] [MainThread]: Connection 'model.dbtairflow.int_order_items' was properly closed.
[0m01:44:21.224673 [debug] [MainThread]: Connection 'model.dbtairflow.int_order_items_sum' was properly closed.
[0m01:44:21.225970 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m01:44:21.227783 [info ] [MainThread]: 
[0m01:44:21.230306 [info ] [MainThread]: Finished running 2 view models, 3 table models in 0 hours 0 minutes and 26.18 seconds (26.18s).
[0m01:44:21.233386 [debug] [MainThread]: Command end result
[0m01:44:21.309865 [info ] [MainThread]: 
[0m01:44:21.311734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:44:21.313027 [info ] [MainThread]: 
[0m01:44:21.314852 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:44:21.317660 [debug] [MainThread]: Command `dbt run` succeeded at 01:44:21.317660 after 31.23 seconds
[0m01:44:21.318929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A36C182E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A392723D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A686190>]}
[0m01:44:21.320084 [debug] [MainThread]: Flushing usage events
[0m02:36:20.724100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123069682E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012309480B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012309480D60>]}


============================== 02:36:20.732459 | 913ff5f6-5cef-4fd2-a08a-39121b6a65ff ==============================
[0m02:36:20.732459 [info ] [MainThread]: Running with dbt=1.8.5
[0m02:36:20.733712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:36:21.779978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230A1432E0>]}
[0m02:36:21.852264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123092739A0>]}
[0m02:36:21.854795 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m02:36:21.875126 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m02:36:22.040707 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:36:22.041856 [debug] [MainThread]: previous checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, current checksum: 643640a45b16e0d012867be4ac17daaa0c3ce97300faec3ce9a6de300b5e1c09
[0m02:36:22.042975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123089A1850>]}
[0m02:36:23.845627 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:36:23.846752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230A34C9D0>]}
[0m02:36:24.169426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230B7C2130>]}
[0m02:36:24.364334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230B81FF10>]}
[0m02:36:24.365543 [info ] [MainThread]: Found 3 models, 9 data tests, 2 sources, 565 macros
[0m02:36:24.366703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230B7E9A00>]}
[0m02:36:24.368679 [info ] [MainThread]: 
[0m02:36:24.370558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:36:24.376850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m02:36:24.391563 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m02:36:24.392298 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m02:36:24.392984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:25.989860 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.597 seconds
[0m02:36:25.992147 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m02:36:26.679529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m02:36:26.691391 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m02:36:26.692009 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m02:36:26.692644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:28.057741 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.365 seconds
[0m02:36:28.059750 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m02:36:28.763883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230A377940>]}
[0m02:36:28.766241 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m02:36:28.767509 [info ] [MainThread]: 
[0m02:36:28.776615 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m02:36:28.777677 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m02:36:28.778844 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m02:36:28.781317 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m02:36:28.780154 [info ] [Thread-3  ]: 2 of 3 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m02:36:28.782475 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m02:36:28.783841 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m02:36:28.796028 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m02:36:28.796755 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m02:36:28.803381 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m02:36:28.804616 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m02:36:28.805257 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m02:36:28.843562 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m02:36:28.848053 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m02:36:28.850806 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m02:36:28.851433 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m02:36:28.852640 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:36:28.854933 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m02:36:28.857886 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m02:36:28.859657 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:36:30.352049 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.499 seconds
[0m02:36:30.352709 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.494 seconds
[0m02:36:30.380081 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m02:36:30.382898 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m02:36:31.086605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230BB7A520>]}
[0m02:36:31.088397 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.30s]
[0m02:36:31.089712 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m02:36:31.113653 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230B6FB7C0>]}
[0m02:36:31.114756 [info ] [Thread-3  ]: 2 of 3 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.33s]
[0m02:36:31.116233 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m02:36:31.117521 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m02:36:31.118759 [info ] [Thread-5  ]: 3 of 3 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m02:36:31.120503 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.fct_orders'
[0m02:36:31.121680 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m02:36:31.126929 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m02:36:31.128210 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m02:36:31.152162 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m02:36:31.155258 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m02:36:31.155942 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

with int_order_items_sum as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key

),

select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from
    DBT_DB.dbt_schema.stg_tpch_orders as orders
join
    int_order_items_sum as order_item_summary
        on orders.order_key = order_item_summary.order_key
order by order_date
        );
[0m02:36:31.156618 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m02:36:32.374935 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01b6a2d8-0001-3be1-0002-0e42000302c2
[0m02:36:32.375615 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 0 unexpected 'with'.
syntax error line 36 at position 0 unexpected 'select'.
syntax error line 38 at position 22 unexpected '.'.
syntax error line 39 at position 22 unexpected '.'.
syntax error line 44 at position 11 unexpected 'orders'.
[0m02:36:32.376802 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m02:36:33.053012 [debug] [Thread-5  ]: Database Error in model fct_orders (models\marts\fct_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 0 unexpected 'with'.
  syntax error line 36 at position 0 unexpected 'select'.
  syntax error line 38 at position 22 unexpected '.'.
  syntax error line 39 at position 22 unexpected '.'.
  syntax error line 44 at position 11 unexpected 'orders'.
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m02:36:33.053615 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913ff5f6-5cef-4fd2-a08a-39121b6a65ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230BC38FD0>]}
[0m02:36:33.054881 [error] [Thread-5  ]: 3 of 3 ERROR creating sql table model dbt_schema.fct_orders .................... [[31mERROR[0m in 1.93s]
[0m02:36:33.056105 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m02:36:33.058658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:33.059251 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m02:36:33.059826 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m02:36:33.060474 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_line_items' was properly closed.
[0m02:36:33.061632 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m02:36:33.062201 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m02:36:33.062787 [info ] [MainThread]: 
[0m02:36:33.064044 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m02:36:33.065872 [debug] [MainThread]: Command end result
[0m02:36:33.111418 [info ] [MainThread]: 
[0m02:36:33.112640 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:36:33.113931 [info ] [MainThread]: 
[0m02:36:33.115187 [error] [MainThread]:   Database Error in model fct_orders (models\marts\fct_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 0 unexpected 'with'.
  syntax error line 36 at position 0 unexpected 'select'.
  syntax error line 38 at position 22 unexpected '.'.
  syntax error line 39 at position 22 unexpected '.'.
  syntax error line 44 at position 11 unexpected 'orders'.
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m02:36:33.117712 [info ] [MainThread]: 
[0m02:36:33.118873 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m02:36:33.120658 [debug] [MainThread]: Command `dbt run` failed at 02:36:33.120537 after 12.48 seconds
[0m02:36:33.121317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123069682E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230A4AD3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001230B81F8E0>]}
[0m02:36:33.121833 [debug] [MainThread]: Flushing usage events
[0m02:39:56.339127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A2CF82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A580CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A580CF40>]}


============================== 02:39:56.345034 | 0eac16f1-baef-4737-90b6-d114a202c599 ==============================
[0m02:39:56.345034 [info ] [MainThread]: Running with dbt=1.8.5
[0m02:39:56.346267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:39:56.921826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A64FB940>]}
[0m02:39:56.975369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A64D3490>]}
[0m02:39:56.976836 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m02:39:56.992772 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m02:39:57.221748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:39:57.223014 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fct_orders.sql
[0m02:39:57.520517 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:39:57.521605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A64D3160>]}
[0m02:39:57.732976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7B9A130>]}
[0m02:39:57.900009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7B92E80>]}
[0m02:39:57.900653 [info ] [MainThread]: Found 3 models, 9 data tests, 2 sources, 565 macros
[0m02:39:57.901181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7B09B20>]}
[0m02:39:57.903509 [info ] [MainThread]: 
[0m02:39:57.905437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:39:57.911333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m02:39:57.926253 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m02:39:57.926913 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m02:39:57.927108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:59.473236 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.546 seconds
[0m02:39:59.475289 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m02:40:00.174968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m02:40:00.186220 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m02:40:00.186852 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m02:40:00.187380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:01.496317 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.309 seconds
[0m02:40:01.498791 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m02:40:02.214952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A5696340>]}
[0m02:40:02.216682 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m02:40:02.217804 [info ] [MainThread]: 
[0m02:40:02.225285 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m02:40:02.226505 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m02:40:02.227705 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m02:40:02.228893 [info ] [Thread-3  ]: 2 of 3 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m02:40:02.230620 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m02:40:02.231313 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m02:40:02.232678 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m02:40:02.233310 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m02:40:02.257740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m02:40:02.262953 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m02:40:02.264722 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m02:40:02.265358 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m02:40:02.300726 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m02:40:02.308002 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m02:40:02.310561 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m02:40:02.312386 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m02:40:02.312964 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m02:40:02.314259 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m02:40:02.315459 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:40:02.316643 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:40:03.883124 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.567 seconds
[0m02:40:03.908058 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m02:40:03.909884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.594 seconds
[0m02:40:03.914825 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m02:40:04.591371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7EF6580>]}
[0m02:40:04.592545 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.36s]
[0m02:40:04.594344 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m02:40:04.611598 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A64D3B20>]}
[0m02:40:04.612865 [info ] [Thread-3  ]: 2 of 3 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.38s]
[0m02:40:04.614646 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m02:40:04.616453 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m02:40:04.617103 [info ] [Thread-5  ]: 3 of 3 START sql table model dbt_schema.fct_orders ............................. [RUN]
[0m02:40:04.618949 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.fct_orders'
[0m02:40:04.619552 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m02:40:04.624086 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m02:40:04.626064 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m02:40:04.652368 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m02:40:04.655220 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m02:40:04.655955 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

int_order_items_sum as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
),

final as (
    select
        orders.*,
        order_item_summary.gross_item_sales_amount,
        order_item_summary.item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        int_order_items_sum as order_item_summary
            on orders.order_key = order_item_summary.order_key
    order by 
        orders.order_date
)

select * from final
        );
[0m02:40:04.657161 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m02:40:09.091749 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.435 seconds
[0m02:40:09.094228 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m02:40:09.775784 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac16f1-baef-4737-90b6-d114a202c599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7F48DC0>]}
[0m02:40:09.777049 [info ] [Thread-5  ]: 3 of 3 OK created sql table model dbt_schema.fct_orders ........................ [[32mSUCCESS 1[0m in 5.16s]
[0m02:40:09.778945 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m02:40:09.781379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:09.782018 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m02:40:09.782614 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m02:40:09.783758 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_line_items' was properly closed.
[0m02:40:09.783758 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m02:40:09.784772 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m02:40:09.785802 [info ] [MainThread]: 
[0m02:40:09.787015 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m02:40:09.789083 [debug] [MainThread]: Command end result
[0m02:40:09.829743 [info ] [MainThread]: 
[0m02:40:09.831113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:40:09.831891 [info ] [MainThread]: 
[0m02:40:09.833168 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:40:09.834946 [debug] [MainThread]: Command `dbt run` succeeded at 02:40:09.834439 after 13.57 seconds
[0m02:40:09.835636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A2CF82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A5353400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A7AF9340>]}
[0m02:40:09.836248 [debug] [MainThread]: Flushing usage events
[0m03:10:43.886550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F303FF82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F306B0CB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F306B0CD60>]}


============================== 03:10:43.894550 | 27c46b28-13c0-4f5d-8329-254f86ec4300 ==============================
[0m03:10:43.894550 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:10:43.895551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:10:44.738586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27c46b28-13c0-4f5d-8329-254f86ec4300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3077D32E0>]}
[0m03:10:44.797711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27c46b28-13c0-4f5d-8329-254f86ec4300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3069049A0>]}
[0m03:10:44.799704 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:10:44.819275 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:10:45.003621 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtairflow: staging\tpch_sources.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |               - relationships:
    19 |                   to: source('tpch', 'orders')
    20 |                   field: o_orderkey
    21 |        - name: region
    22 |         columns:
    23 |           - name: R_REGIONKEY
    24 |             tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 8, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 21, column 8
[0m03:10:45.006626 [debug] [MainThread]: Command `dbt run` failed at 03:10:45.006626 after 1.21 seconds
[0m03:10:45.007624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F303FF82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30783AD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3077CC8B0>]}
[0m03:10:45.008618 [debug] [MainThread]: Flushing usage events
[0m03:12:11.385933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81C8782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F392C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F392FA0>]}


============================== 03:12:11.391872 | ef850595-309a-4638-aaf1-dfb567dabb3c ==============================
[0m03:12:11.391872 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:12:11.392875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'send_anonymous_usage_stats': 'True'}
[0m03:12:11.948022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef850595-309a-4638-aaf1-dfb567dabb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F36F430>]}
[0m03:12:12.003104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef850595-309a-4638-aaf1-dfb567dabb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F2234F0>]}
[0m03:12:12.005097 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:12:12.021071 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:12:12.276190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 1 files changed.
[0m03:12:12.277190 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_part.sql
[0m03:12:12.278220 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_customer.sql
[0m03:12:12.278220 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_nation.sql
[0m03:12:12.279484 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_supplier.sql
[0m03:12:12.280007 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_region.sql
[0m03:12:12.280007 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_partsupp.sql
[0m03:12:12.281031 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_region.sql
[0m03:12:12.282438 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\staging\tpch_sources.yml
[0m03:12:12.706621 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:12:12.707649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef850595-309a-4638-aaf1-dfb567dabb3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82043A520>]}
[0m03:12:13.978521 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtairflow.stg_tpch_part' (models\staging\stg_tpch_part.sql) depends on a source named 'tpch.part' which was not found
[0m03:12:13.981765 [debug] [MainThread]: Command `dbt run` failed at 03:12:13.980757 after 2.67 seconds
[0m03:12:13.983091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81C8782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F324CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82006A9D0>]}
[0m03:12:13.984254 [debug] [MainThread]: Flushing usage events
[0m03:12:20.956850 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m03:13:11.929327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467A5A82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467D0BBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467D0BBFA0>]}


============================== 03:13:11.936397 | 53445b94-ad6e-4265-ba39-2a96e4157cba ==============================
[0m03:13:11.936397 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:13:11.939406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:13:12.840338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467D096430>]}
[0m03:13:12.953833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467CF524F0>]}
[0m03:13:12.956843 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:13:12.994778 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:13:13.395872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 1 files changed.
[0m03:13:13.396878 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_part.sql
[0m03:13:13.398878 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_customer.sql
[0m03:13:13.399877 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_supplier.sql
[0m03:13:13.399877 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_nation.sql
[0m03:13:13.400878 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_partsupp.sql
[0m03:13:13.401880 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_region.sql
[0m03:13:13.402878 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\staging\stg_tpch_region.sql
[0m03:13:13.404876 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\staging\tpch_sources.yml
[0m03:13:14.134024 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:13:14.135037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467DDBF310>]}
[0m03:13:14.585326 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.source_relationships_tpch_region_R_REGIONKEY__N_REGIONKEY__source_tpch_nations_.3a01aae092' (models\staging\tpch_sources.yml) depends on a source named 'tpch.nations' in package '' which was not found
[0m03:13:14.586330 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtairflow.source_relationships_tpch_nation_N_NATIONKEY__S_NATIONKEY__source_tpch_SUPPLIER_.64807b110c' (models\staging\tpch_sources.yml) depends on a source named 'tpch.SUPPLIER' in package '' which was not found
[0m03:13:14.727841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F61FEE0>]}
[0m03:13:15.248635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467E156790>]}
[0m03:13:15.250635 [info ] [MainThread]: Found 10 models, 9 data tests, 8 sources, 565 macros
[0m03:13:15.251325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F5DD070>]}
[0m03:13:15.255375 [info ] [MainThread]: 
[0m03:13:15.257376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:15.267977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:13:15.301643 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:13:15.304357 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:13:15.306091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:17.730945 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.425 seconds
[0m03:13:17.733781 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:13:18.553615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:13:18.571292 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:13:18.572624 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:13:18.573643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:20.296364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.724 seconds
[0m03:13:20.302294 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:13:21.116876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467E0B01F0>]}
[0m03:13:21.118888 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:13:21.119886 [info ] [MainThread]: 
[0m03:13:21.142188 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:13:21.144205 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:13:21.145458 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:13:21.148505 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:13:21.150877 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:13:21.147500 [info ] [Thread-1  ]: 1 of 10 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:13:21.153335 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:13:21.155367 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:13:21.157375 [debug] [Thread-9  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:13:21.159359 [info ] [Thread-3  ]: 2 of 10 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:13:21.162360 [info ] [Thread-4  ]: 3 of 10 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:13:21.166364 [info ] [Thread-5  ]: 4 of 10 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:13:21.170954 [info ] [Thread-6  ]: 5 of 10 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:13:21.176247 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:13:21.178969 [info ] [Thread-7  ]: 6 of 10 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:13:21.181381 [info ] [Thread-8  ]: 7 of 10 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:13:21.184397 [info ] [Thread-9  ]: 8 of 10 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:13:21.187401 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:13:21.189405 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:13:21.193403 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:13:21.196399 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:13:21.199136 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:13:21.202513 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:13:21.205050 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:13:21.208063 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:13:21.211043 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:13:21.214047 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:13:21.216045 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:13:21.218039 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:13:21.244302 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:13:21.246615 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:13:21.248645 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:13:21.250991 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:13:21.263004 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:13:21.271894 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:13:21.281770 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:13:21.291358 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:13:21.453333 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:13:21.462157 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:13:21.465851 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:13:21.477759 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:13:21.480974 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:13:21.483211 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:13:21.486446 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:13:21.494109 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:13:21.540968 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:13:21.575936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:13:21.587295 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:13:21.590880 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:13:21.592318 [debug] [Thread-9  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:13:21.601892 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:13:21.611095 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:13:21.617992 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:13:21.626991 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:13:21.636994 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:13:21.640006 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:13:21.642493 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:13:21.652292 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:13:21.656042 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:13:21.660045 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:13:21.662045 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:13:21.664048 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:13:21.667042 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:13:21.669595 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:13:21.672958 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:13:21.674348 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:13:21.677874 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:13:21.679194 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:13:21.682232 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:13:21.684675 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:13:21.686703 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:13:21.688705 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:13:21.691701 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:13:21.693699 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:13:21.695710 [debug] [Thread-9  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:13:21.697712 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:13:21.707710 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:13:21.709702 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:13:21.718105 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:13:21.727102 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:13:24.187354 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.470 seconds
[0m03:13:24.243662 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:13:24.269457 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.542 seconds
[0m03:13:24.271894 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.574 seconds
[0m03:13:24.278124 [debug] [Thread-9  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:13:24.281914 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.572 seconds
[0m03:13:24.296698 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:13:24.307760 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.618 seconds
[0m03:13:24.313512 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:13:24.315175 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.621 seconds
[0m03:13:24.322349 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:13:24.328032 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.621 seconds
[0m03:13:24.333413 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.651 seconds
[0m03:13:24.339466 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:13:24.350737 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:13:24.359364 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:13:25.215625 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F928C70>]}
[0m03:13:25.217893 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F91BA60>]}
[0m03:13:25.219915 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F9588B0>]}
[0m03:13:25.221909 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F928910>]}
[0m03:13:25.222926 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F94DE20>]}
[0m03:13:25.223933 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F91BD90>]}
[0m03:13:25.224941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F928970>]}
[0m03:13:25.229496 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F94DFD0>]}
[0m03:13:25.227500 [info ] [Thread-6  ]: 5 of 10 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 4.02s]
[0m03:13:25.231632 [info ] [Thread-4  ]: 3 of 10 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 4.03s]
[0m03:13:25.233826 [info ] [Thread-9  ]: 8 of 10 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 4.01s]
[0m03:13:25.235845 [info ] [Thread-5  ]: 4 of 10 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 4.03s]
[0m03:13:25.237920 [info ] [Thread-7  ]: 6 of 10 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 4.02s]
[0m03:13:25.240041 [info ] [Thread-3  ]: 2 of 10 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 4.04s]
[0m03:13:25.242154 [info ] [Thread-1  ]: 1 of 10 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 4.05s]
[0m03:13:25.243169 [info ] [Thread-8  ]: 7 of 10 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 4.02s]
[0m03:13:25.244544 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:13:25.247052 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:13:25.248250 [debug] [Thread-9  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:13:25.250627 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:13:25.252654 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:13:25.254718 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:13:25.256961 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:13:25.258008 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:13:25.262480 [debug] [Thread-2  ]: Began running node model.dbtairflow.fct_orders
[0m03:13:25.265008 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_region
[0m03:13:25.266022 [info ] [Thread-2  ]: 9 of 10 START sql table model dbt_schema.fct_orders ............................ [RUN]
[0m03:13:25.268381 [info ] [Thread-6  ]: 10 of 10 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:13:25.270421 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.fct_orders'
[0m03:13:25.271937 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.dim_region)
[0m03:13:25.273439 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:13:25.274453 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_region
[0m03:13:25.283358 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:13:25.291389 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:13:25.294386 [debug] [Thread-2  ]: Began executing node model.dbtairflow.fct_orders
[0m03:13:25.340553 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:13:25.343069 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_region
[0m03:13:25.348722 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:13:25.353144 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:13:25.355113 [debug] [Thread-2  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

int_order_items_sum as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
),

final as (
    select
        orders.*,
        order_item_summary.gross_item_sales_amount,
        order_item_summary.item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        int_order_items_sum as order_item_summary
            on orders.order_key = order_item_summary.order_key
    order by 
        orders.order_date
)

select * from final
        );
[0m03:13:25.356228 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:13:25.357245 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:13:25.358571 [debug] [Thread-6  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:13:25.362116 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:13:28.272787 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.911 seconds
[0m03:13:28.277388 [debug] [Thread-6  ]: On model.dbtairflow.dim_region: Close
[0m03:13:29.202280 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467E164C40>]}
[0m03:13:29.204304 [info ] [Thread-6  ]: 10 of 10 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.93s]
[0m03:13:29.208299 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_region
[0m03:13:29.727282 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.370 seconds
[0m03:13:29.731281 [debug] [Thread-2  ]: On model.dbtairflow.fct_orders: Close
[0m03:13:30.540084 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53445b94-ad6e-4265-ba39-2a96e4157cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467E2B5670>]}
[0m03:13:30.543231 [info ] [Thread-2  ]: 9 of 10 OK created sql table model dbt_schema.fct_orders ....................... [[32mSUCCESS 1[0m in 5.27s]
[0m03:13:30.545273 [debug] [Thread-2  ]: Finished running node model.dbtairflow.fct_orders
[0m03:13:30.555296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:30.555810 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:13:30.556841 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:13:30.558838 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_customer' was properly closed.
[0m03:13:30.560269 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_line_items' was properly closed.
[0m03:13:30.560269 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_nation' was properly closed.
[0m03:13:30.562286 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m03:13:30.564062 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:13:30.565079 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_partsupp' was properly closed.
[0m03:13:30.566625 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_region' was properly closed.
[0m03:13:30.567656 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_supplier' was properly closed.
[0m03:13:30.569651 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:13:30.571966 [info ] [MainThread]: 
[0m03:13:30.575012 [info ] [MainThread]: Finished running 8 view models, 2 table models in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m03:13:30.580287 [debug] [MainThread]: Command end result
[0m03:13:30.674233 [info ] [MainThread]: 
[0m03:13:30.676284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:30.678314 [info ] [MainThread]: 
[0m03:13:30.680018 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m03:13:30.685040 [debug] [MainThread]: Command `dbt run` succeeded at 03:13:30.685040 after 18.87 seconds
[0m03:13:30.687630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467A5A82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467CBF4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001467F54A6D0>]}
[0m03:13:30.689652 [debug] [MainThread]: Flushing usage events
[0m03:19:53.874949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57AC482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57D75DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57D75DFA0>]}


============================== 03:19:53.882921 | 368df3d8-9d36-42b5-a0bf-9a75cadbdd60 ==============================
[0m03:19:53.882921 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:19:53.883948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:19:54.877864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57D736430>]}
[0m03:19:54.944536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57D5F24F0>]}
[0m03:19:54.947525 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:19:54.965579 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:19:55.394269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m03:19:55.396271 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_supplier.sql
[0m03:19:55.396271 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_customer.sql
[0m03:19:55.397274 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_nation.sql
[0m03:19:55.398276 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_part.sql
[0m03:19:55.399275 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\dim_orders.sql
[0m03:19:55.869876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E99E130>]}
[0m03:19:56.163257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E99F520>]}
[0m03:19:56.164589 [info ] [MainThread]: Found 15 models, 9 data tests, 8 sources, 565 macros
[0m03:19:56.164589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E86EA60>]}
[0m03:19:56.169337 [info ] [MainThread]: 
[0m03:19:56.170487 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:19:56.179476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:19:56.196078 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:19:56.197084 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:19:56.198073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:19:58.110245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.913 seconds
[0m03:19:58.112546 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:19:58.934443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:19:58.950679 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:19:58.951668 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:19:58.952666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:00.676644 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.724 seconds
[0m03:20:00.681639 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:20:01.501207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B600FD0>]}
[0m03:20:01.502381 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:20:01.504698 [info ] [MainThread]: 
[0m03:20:01.514154 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:20:01.516258 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:20:01.517517 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:20:01.518573 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:20:01.519593 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:20:01.521593 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:20:01.523873 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:20:01.526231 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:20:01.522847 [info ] [Thread-1  ]: 1 of 15 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:20:01.528259 [info ] [Thread-2  ]: 2 of 15 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:20:01.531548 [info ] [Thread-3  ]: 3 of 15 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:20:01.532786 [info ] [Thread-4  ]: 4 of 15 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:20:01.535259 [info ] [Thread-5  ]: 5 of 15 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:20:01.537816 [info ] [Thread-6  ]: 6 of 15 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:20:01.539700 [info ] [Thread-7  ]: 7 of 15 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:20:01.542720 [info ] [Thread-8  ]: 8 of 15 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:20:01.544237 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:20:01.546247 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:20:01.549269 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:20:01.550331 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:20:01.552802 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:20:01.556413 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:20:01.557823 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:20:01.560332 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:20:01.561362 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:20:01.563390 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:20:01.564786 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:20:01.567258 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:20:01.568387 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:20:01.569402 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:20:01.571404 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:20:01.573557 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:20:01.591916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:20:01.624608 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:20:01.630147 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:20:01.636156 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:20:01.644893 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:20:01.650890 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:20:01.657876 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:20:01.664886 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:20:01.666885 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:20:01.667878 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:20:01.670875 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:20:01.672528 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:20:01.673551 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:20:01.675547 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:20:01.676542 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:20:01.687201 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:20:01.726569 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:20:01.733541 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:20:01.740561 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:20:01.747544 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:20:01.753541 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:20:01.761001 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:20:01.768061 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:20:01.773976 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:20:01.776960 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:20:01.778960 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:20:01.781516 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:20:01.783867 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:20:01.788182 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:20:01.789273 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:20:01.792293 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:20:01.793291 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:20:01.794494 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:20:01.796524 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:20:01.797541 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:20:01.798545 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:20:01.800201 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:20:01.801212 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:20:01.802235 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:20:01.804227 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:20:01.805234 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:20:01.807251 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:20:01.808284 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:20:01.809280 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:20:01.810295 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:20:01.811822 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:20:01.812833 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:20:01.817488 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:20:04.047708 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.236 seconds
[0m03:20:04.094974 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:20:04.267285 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.454 seconds
[0m03:20:04.271258 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.463 seconds
[0m03:20:04.275497 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:20:04.276549 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.470 seconds
[0m03:20:04.278695 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.461 seconds
[0m03:20:04.281262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.477 seconds
[0m03:20:04.284434 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:20:04.293501 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:20:04.298896 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:20:04.300947 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.492 seconds
[0m03:20:04.304436 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:20:04.317191 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:20:04.456895 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.647 seconds
[0m03:20:04.460892 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:20:04.874056 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57DB4AD30>]}
[0m03:20:04.876054 [info ] [Thread-6  ]: 6 of 15 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 3.32s]
[0m03:20:04.878659 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:20:05.088145 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC400>]}
[0m03:20:05.090622 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FE97DF0>]}
[0m03:20:05.091915 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC9D0>]}
[0m03:20:05.093172 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC7F0>]}
[0m03:20:05.095871 [info ] [Thread-2  ]: 2 of 15 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 3.54s]
[0m03:20:05.097265 [info ] [Thread-7  ]: 7 of 15 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 3.53s]
[0m03:20:05.099805 [info ] [Thread-4  ]: 4 of 15 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 3.54s]
[0m03:20:05.102281 [info ] [Thread-3  ]: 3 of 15 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 3.54s]
[0m03:20:05.104307 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:20:05.106412 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:20:05.108407 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:20:05.109662 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:20:05.113121 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_region
[0m03:20:05.115583 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_orders
[0m03:20:05.117081 [debug] [Thread-2  ]: Began running node model.dbtairflow.fct_orders
[0m03:20:05.118628 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_nation
[0m03:20:05.120702 [info ] [Thread-10 ]: 9 of 15 START sql table model dbt_schema.dim_region ............................ [RUN]
[0m03:20:05.122682 [info ] [Thread-6  ]: 10 of 15 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m03:20:05.124704 [info ] [Thread-2  ]: 11 of 15 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:20:05.126004 [info ] [Thread-9  ]: 12 of 15 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:20:05.129485 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_region'
[0m03:20:05.131408 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_orders)
[0m03:20:05.133395 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.fct_orders)
[0m03:20:05.135027 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_nation'
[0m03:20:05.136052 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_region
[0m03:20:05.138074 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_orders
[0m03:20:05.139616 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:20:05.140622 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:20:05.150356 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:20:05.157794 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:20:05.168251 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:20:05.176832 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:20:05.178730 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_region
[0m03:20:05.180725 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_orders
[0m03:20:05.227281 [debug] [Thread-2  ]: Began executing node model.dbtairflow.fct_orders
[0m03:20:05.228693 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:20:05.234950 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:20:05.236060 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_nation
[0m03:20:05.242078 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:20:05.245393 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:20:05.246586 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:20:05.252973 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:20:05.253971 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:20:05.258635 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:20:05.259661 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:20:05.262779 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:20:05.263807 [debug] [Thread-2  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

int_order_items_sum as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
),

final as (
    select
        orders.*,
        order_item_summary.gross_item_sales_amount,
        order_item_summary.item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        int_order_items_sum as order_item_summary
            on orders.order_key = order_item_summary.order_key
    order by 
        orders.order_date
)

select * from final
        );
[0m03:20:05.265314 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:20:05.266328 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:20:05.271546 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:20:05.274032 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:20:05.282429 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCD48B0>]}
[0m03:20:05.284441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC310>]}
[0m03:20:05.290322 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCD4370>]}
[0m03:20:05.296517 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:20:05.300466 [info ] [Thread-8  ]: 8 of 15 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 3.72s]
[0m03:20:05.302975 [info ] [Thread-1  ]: 1 of 15 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 3.74s]
[0m03:20:05.304966 [info ] [Thread-5  ]: 5 of 15 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 3.74s]
[0m03:20:05.311263 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:20:05.314674 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:20:05.315703 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:20:05.318255 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_supplier
[0m03:20:05.321161 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_customer
[0m03:20:05.323255 [debug] [Thread-3  ]: Began running node model.dbtairflow.dim_part
[0m03:20:05.324265 [info ] [Thread-7  ]: 13 of 15 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:20:05.327788 [info ] [Thread-4  ]: 14 of 15 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:20:05.330141 [info ] [Thread-3  ]: 15 of 15 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:20:05.332142 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_supplier)
[0m03:20:05.334144 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_customer)
[0m03:20:05.337267 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.dim_part)
[0m03:20:05.338263 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:20:05.340520 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:20:05.341546 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.dim_part
[0m03:20:05.432221 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:20:05.438283 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:20:05.445053 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:20:05.447840 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_customer
[0m03:20:05.457115 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:20:05.458182 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:20:05.460528 [debug] [Thread-3  ]: Began executing node model.dbtairflow.dim_part
[0m03:20:05.467028 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:20:05.469032 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:20:05.478541 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:20:05.480543 [debug] [Thread-4  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:20:05.482990 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:20:05.484012 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:20:05.487510 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:20:05.488523 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:20:05.493523 [debug] [Thread-3  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:20:05.496527 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m03:20:05.497754 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:20:08.867682 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.602 seconds
[0m03:20:08.872668 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: Close
[0m03:20:08.887668 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.626 seconds
[0m03:20:08.892724 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: Close
[0m03:20:09.076645 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.581 seconds
[0m03:20:09.081629 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: Close
[0m03:20:09.405258 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.109 seconds
[0m03:20:09.408265 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: Close
[0m03:20:09.653553 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC820>]}
[0m03:20:09.655550 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FF1E610>]}
[0m03:20:09.656582 [info ] [Thread-10 ]: 9 of 15 OK created sql table model dbt_schema.dim_region ....................... [[32mSUCCESS 1[0m in 4.53s]
[0m03:20:09.659982 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_region
[0m03:20:09.657562 [info ] [Thread-6  ]: 10 of 15 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 4.52s]
[0m03:20:09.660971 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_orders
[0m03:20:09.886717 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.389 seconds
[0m03:20:09.888657 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.405 seconds
[0m03:20:09.892298 [debug] [Thread-3  ]: On model.dbtairflow.dim_part: Close
[0m03:20:09.896818 [debug] [Thread-4  ]: On model.dbtairflow.dim_customer: Close
[0m03:20:10.008262 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E82C640>]}
[0m03:20:10.010264 [info ] [Thread-7  ]: 13 of 15 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 4.68s]
[0m03:20:10.012635 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:20:10.201613 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FCAC580>]}
[0m03:20:10.202597 [info ] [Thread-9  ]: 12 of 15 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 5.07s]
[0m03:20:10.205570 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_nation
[0m03:20:10.504103 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.233 seconds
[0m03:20:10.509651 [debug] [Thread-2  ]: On model.dbtairflow.fct_orders: Close
[0m03:20:10.707492 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E7543D0>]}
[0m03:20:10.709504 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FC61AF0>]}
[0m03:20:10.711503 [info ] [Thread-4  ]: 14 of 15 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 5.37s]
[0m03:20:10.713503 [info ] [Thread-3  ]: 15 of 15 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 5.37s]
[0m03:20:10.715500 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_customer
[0m03:20:10.718615 [debug] [Thread-3  ]: Finished running node model.dbtairflow.dim_part
[0m03:20:11.335297 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '368df3d8-9d36-42b5-a0bf-9a75cadbdd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57FF46EE0>]}
[0m03:20:11.337296 [info ] [Thread-2  ]: 11 of 15 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 6.20s]
[0m03:20:11.339293 [debug] [Thread-2  ]: Finished running node model.dbtairflow.fct_orders
[0m03:20:11.342711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:20:11.344740 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:20:11.345739 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:20:11.347895 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_customer' was properly closed.
[0m03:20:11.351913 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:20:11.353766 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:20:11.355132 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:20:11.357205 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_part' was properly closed.
[0m03:20:11.358916 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:20:11.360092 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:20:11.361799 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_supplier' was properly closed.
[0m03:20:11.363474 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:20:11.365586 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:20:11.366896 [info ] [MainThread]: 
[0m03:20:11.369340 [info ] [MainThread]: Finished running 8 view models, 7 table models in 0 hours 0 minutes and 15.20 seconds (15.20s).
[0m03:20:11.375920 [debug] [MainThread]: Command end result
[0m03:20:11.476196 [info ] [MainThread]: 
[0m03:20:11.477492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:20:11.479667 [info ] [MainThread]: 
[0m03:20:11.482174 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m03:20:11.485031 [debug] [MainThread]: Command `dbt run` succeeded at 03:20:11.485031 after 17.71 seconds
[0m03:20:11.487061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57AC482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E5AADC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E49C6D0>]}
[0m03:20:11.488062 [debug] [MainThread]: Flushing usage events
[0m03:21:04.882953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029102AC82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291055DCB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291055DCD60>]}


============================== 03:21:04.891221 | 4034e191-8ba9-43b0-ad9d-139aa5a0b48a ==============================
[0m03:21:04.891221 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:21:04.893222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:21:06.013804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291062A32E0>]}
[0m03:21:06.130699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291053D39A0>]}
[0m03:21:06.133716 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:21:06.156994 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:21:06.631459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:21:06.634118 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fct_orders.sql
[0m03:21:07.152894 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:21:07.154406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291066D9280>]}
[0m03:21:07.518156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910792CEB0>]}
[0m03:21:07.796112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910792CE20>]}
[0m03:21:07.797192 [info ] [MainThread]: Found 15 models, 9 data tests, 8 sources, 565 macros
[0m03:21:07.798727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291066A35B0>]}
[0m03:21:07.801739 [info ] [MainThread]: 
[0m03:21:07.803737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:21:07.812917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:21:07.829501 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:21:07.830498 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:21:07.831487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:09.697770 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.866 seconds
[0m03:21:09.700327 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:21:10.516076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:21:10.541326 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:21:10.543326 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:21:10.544328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:12.251247 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.707 seconds
[0m03:21:12.254735 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:21:13.079584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029103012D30>]}
[0m03:21:13.082057 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:21:13.083794 [info ] [MainThread]: 
[0m03:21:13.093393 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:21:13.094524 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:21:13.095622 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:21:13.096647 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:21:13.096647 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:21:13.098138 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:21:13.099153 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:21:13.100662 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:21:13.101680 [info ] [Thread-1  ]: 1 of 15 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:21:13.103688 [info ] [Thread-2  ]: 2 of 15 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:21:13.104687 [info ] [Thread-3  ]: 3 of 15 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:21:13.107140 [info ] [Thread-4  ]: 4 of 15 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:21:13.108274 [info ] [Thread-5  ]: 5 of 15 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:21:13.110290 [info ] [Thread-6  ]: 6 of 15 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:21:13.112689 [info ] [Thread-7  ]: 7 of 15 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:21:13.113741 [info ] [Thread-8  ]: 8 of 15 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:21:13.120439 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:21:13.122455 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:21:13.124662 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:21:13.125674 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:21:13.128183 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:21:13.131199 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:21:13.132239 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:21:13.147754 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:21:13.136137 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:21:13.171312 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:21:13.173314 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:21:13.137649 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:21:13.142667 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:21:13.144757 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:21:13.133639 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:21:13.139694 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:21:13.141653 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:21:13.194410 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:21:13.228356 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:21:13.249593 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:21:13.255633 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:21:13.260628 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:21:13.261630 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:21:13.269179 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:21:13.273848 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:21:13.275849 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:21:13.278443 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:21:13.280003 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:21:13.281526 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:21:13.282559 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:21:13.288573 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:21:13.290572 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:21:13.297285 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:21:13.298300 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:21:13.300294 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:21:13.307139 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:21:13.314426 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:21:13.322319 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:21:13.324313 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:21:13.329302 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:21:13.332309 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:21:13.337153 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:21:13.338154 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:21:13.341678 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:21:13.344111 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:21:13.349002 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:21:13.351019 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:21:13.353494 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:21:13.355525 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:21:13.359595 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:21:13.360604 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:21:13.365006 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:21:13.368538 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:21:13.369688 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:21:13.370725 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:21:13.372056 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:21:13.372056 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:21:13.373071 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:21:13.374557 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:21:13.374557 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:21:13.375577 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:21:13.378366 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:21:13.381681 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:21:13.393825 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:21:15.847328 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.473 seconds
[0m03:21:15.850829 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.478 seconds
[0m03:21:15.852833 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.479 seconds
[0m03:21:15.854160 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.461 seconds
[0m03:21:15.856180 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.478 seconds
[0m03:21:15.857178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.519 seconds
[0m03:21:15.884485 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.514 seconds
[0m03:21:15.897287 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:21:15.901824 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:21:15.905227 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:21:15.907349 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:21:15.911267 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:21:15.915463 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:21:15.919267 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:21:15.943335 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.562 seconds
[0m03:21:15.947196 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:21:16.763897 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107E09EE0>]}
[0m03:21:16.767891 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CEFDC0>]}
[0m03:21:16.769017 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CEF670>]}
[0m03:21:16.770956 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107EB1910>]}
[0m03:21:16.772105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CC9940>]}
[0m03:21:16.766893 [info ] [Thread-2  ]: 2 of 15 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 3.64s]
[0m03:21:16.775653 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107E7F970>]}
[0m03:21:16.776663 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CEFB50>]}
[0m03:21:16.773656 [info ] [Thread-6  ]: 6 of 15 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 3.64s]
[0m03:21:16.780700 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CEF8E0>]}
[0m03:21:16.778666 [info ] [Thread-3  ]: 3 of 15 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 3.65s]
[0m03:21:16.782694 [info ] [Thread-7  ]: 7 of 15 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 3.64s]
[0m03:21:16.785046 [info ] [Thread-1  ]: 1 of 15 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 3.65s]
[0m03:21:16.786918 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:21:16.788256 [info ] [Thread-8  ]: 8 of 15 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 3.64s]
[0m03:21:16.791271 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:21:16.790277 [info ] [Thread-5  ]: 5 of 15 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 3.65s]
[0m03:21:16.793796 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:21:16.792283 [info ] [Thread-4  ]: 4 of 15 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 3.65s]
[0m03:21:16.795276 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:21:16.795794 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:21:16.797815 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:21:16.800026 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:21:16.802046 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_nation
[0m03:21:16.803048 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:21:16.805045 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_region
[0m03:21:16.806043 [debug] [Thread-3  ]: Began running node model.dbtairflow.dim_customer
[0m03:21:16.808043 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_supplier
[0m03:21:16.809203 [debug] [Thread-1  ]: Began running node model.dbtairflow.dim_part
[0m03:21:16.810227 [info ] [Thread-10 ]: 9 of 15 START sql table model dbt_schema.dim_nation ............................ [RUN]
[0m03:21:16.812223 [debug] [Thread-8  ]: Began running node model.dbtairflow.dim_orders
[0m03:21:16.812223 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m03:21:16.814173 [info ] [Thread-2  ]: 10 of 15 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:21:16.815203 [info ] [Thread-3  ]: 11 of 15 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:21:16.818190 [info ] [Thread-7  ]: 12 of 15 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:21:16.819495 [info ] [Thread-1  ]: 13 of 15 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:21:16.820509 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_nation'
[0m03:21:16.822853 [info ] [Thread-8  ]: 14 of 15 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m03:21:16.825594 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_region)
[0m03:21:16.823846 [info ] [Thread-5  ]: 15 of 15 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:21:16.826614 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.dim_customer)
[0m03:21:16.827617 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_supplier)
[0m03:21:16.829636 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.dim_part)
[0m03:21:16.830618 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_nation
[0m03:21:16.831623 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.dim_orders)
[0m03:21:16.832616 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_region
[0m03:21:16.835103 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.fct_orders)
[0m03:21:16.836499 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:21:16.837517 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:21:16.838512 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.dim_part
[0m03:21:16.844022 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:21:16.845017 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.dim_orders
[0m03:21:16.851804 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:21:16.853349 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:21:16.858391 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:21:16.864374 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:21:16.868998 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:21:16.875198 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:21:16.876196 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_nation
[0m03:21:16.882232 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:21:16.883231 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_region
[0m03:21:16.886076 [debug] [Thread-3  ]: Began executing node model.dbtairflow.dim_customer
[0m03:21:16.886076 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:21:16.888106 [debug] [Thread-1  ]: Began executing node model.dbtairflow.dim_part
[0m03:21:16.924704 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:21:16.926877 [debug] [Thread-8  ]: Began executing node model.dbtairflow.dim_orders
[0m03:21:16.933432 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:21:16.938670 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:21:16.939663 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m03:21:16.944645 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:21:16.950207 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:21:16.956305 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:21:16.957428 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:21:16.960097 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:21:16.965381 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:21:16.967379 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:21:16.969912 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:21:16.971904 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:21:16.972916 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:21:16.975209 [debug] [Thread-10 ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:21:16.976208 [debug] [Thread-2  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:21:16.979466 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:21:16.980469 [debug] [Thread-3  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:21:16.981480 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:21:16.982478 [debug] [Thread-1  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:21:16.983878 [debug] [Thread-8  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:21:16.984923 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:21:16.986904 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:21:16.987898 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
),

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:21:16.988896 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:21:16.988896 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m03:21:16.991336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:21:16.992350 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m03:21:17.001150 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:21:18.852788 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01b6a305-0001-3c84-0002-0e4200042022
[0m03:21:18.853786 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 49 at position 0 unexpected 'select'.
[0m03:21:18.855994 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m03:21:19.517059 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.527 seconds
[0m03:21:19.521164 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: Close
[0m03:21:19.629115 [debug] [Thread-5  ]: Database Error in model fct_orders (models\marts\fct_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 49 at position 0 unexpected 'select'.
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m03:21:19.631144 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910671E310>]}
[0m03:21:19.633139 [error] [Thread-5  ]: 15 of 15 ERROR creating sql table model dbt_schema.fct_orders .................. [[31mERROR[0m in 2.80s]
[0m03:21:19.635196 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m03:21:19.786738 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.798 seconds
[0m03:21:19.793387 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.808 seconds
[0m03:21:19.796793 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.810 seconds
[0m03:21:19.801967 [debug] [Thread-3  ]: On model.dbtairflow.dim_customer: Close
[0m03:21:19.808092 [debug] [Thread-10 ]: On model.dbtairflow.dim_nation: Close
[0m03:21:19.813821 [debug] [Thread-2  ]: On model.dbtairflow.dim_region: Close
[0m03:21:20.250140 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.258 seconds
[0m03:21:20.262032 [debug] [Thread-8  ]: On model.dbtairflow.dim_orders: Close
[0m03:21:20.445377 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.454 seconds
[0m03:21:20.446521 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107CEF9A0>]}
[0m03:21:20.451044 [debug] [Thread-1  ]: On model.dbtairflow.dim_part: Close
[0m03:21:20.453044 [info ] [Thread-7  ]: 12 of 15 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 3.62s]
[0m03:21:20.457045 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:21:20.662001 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291063C0DF0>]}
[0m03:21:20.665858 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107E0F100>]}
[0m03:21:20.664935 [info ] [Thread-2  ]: 10 of 15 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.84s]
[0m03:21:20.667953 [info ] [Thread-10 ]: 9 of 15 OK created sql table model dbt_schema.dim_nation ....................... [[32mSUCCESS 1[0m in 3.85s]
[0m03:21:20.669023 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_region
[0m03:21:20.671366 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_nation
[0m03:21:21.062483 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107D4CFD0>]}
[0m03:21:21.064696 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029104505D30>]}
[0m03:21:21.065741 [info ] [Thread-8  ]: 14 of 15 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 4.23s]
[0m03:21:21.068264 [info ] [Thread-3  ]: 11 of 15 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 4.24s]
[0m03:21:21.070666 [debug] [Thread-8  ]: Finished running node model.dbtairflow.dim_orders
[0m03:21:21.071686 [debug] [Thread-3  ]: Finished running node model.dbtairflow.dim_customer
[0m03:21:21.268284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4034e191-8ba9-43b0-ad9d-139aa5a0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029107A161C0>]}
[0m03:21:21.270524 [info ] [Thread-1  ]: 13 of 15 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 4.44s]
[0m03:21:21.273864 [debug] [Thread-1  ]: Finished running node model.dbtairflow.dim_part
[0m03:21:21.277492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:21.279691 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:21:21.280718 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:21:21.282716 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:21:21.283852 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:21:21.284731 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:21:21.285725 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_orders' was properly closed.
[0m03:21:21.287730 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:21:21.289738 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_partsupp' was properly closed.
[0m03:21:21.290736 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:21:21.292252 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:21:21.293555 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:21:21.296282 [info ] [MainThread]: 
[0m03:21:21.298837 [info ] [MainThread]: Finished running 8 view models, 7 table models in 0 hours 0 minutes and 13.49 seconds (13.49s).
[0m03:21:21.306877 [debug] [MainThread]: Command end result
[0m03:21:21.398977 [info ] [MainThread]: 
[0m03:21:21.400445 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:21:21.402504 [info ] [MainThread]: 
[0m03:21:21.403903 [error] [MainThread]:   Database Error in model fct_orders (models\marts\fct_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 49 at position 0 unexpected 'select'.
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m03:21:21.406814 [info ] [MainThread]: 
[0m03:21:21.408682 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m03:21:21.411248 [debug] [MainThread]: Command `dbt run` failed at 03:21:21.411248 after 16.66 seconds
[0m03:21:21.413844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029102AC82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002910303E520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291066E2E80>]}
[0m03:21:21.415811 [debug] [MainThread]: Flushing usage events
[0m03:22:26.131407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158FDF982E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015880AD1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015880AD1F40>]}


============================== 03:22:26.138328 | 86856069-2461-4391-a991-cc4cc213e0fb ==============================
[0m03:22:26.138328 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:22:26.139387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:22:26.719197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158818DB940>]}
[0m03:22:26.779118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158818B3490>]}
[0m03:22:26.781124 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:22:26.797341 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:22:27.059219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:22:27.061455 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fct_orders.sql
[0m03:22:27.434725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:22:27.436754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158818AC550>]}
[0m03:22:27.651982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015882F3DEE0>]}
[0m03:22:27.825357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015882F3DAC0>]}
[0m03:22:27.826361 [info ] [MainThread]: Found 15 models, 9 data tests, 8 sources, 565 macros
[0m03:22:27.828369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881CB38B0>]}
[0m03:22:27.831542 [info ] [MainThread]: 
[0m03:22:27.833243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:22:27.840270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:22:27.857294 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:22:27.858445 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:22:27.860266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:29.274039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.415 seconds
[0m03:22:29.277426 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:22:29.990134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:22:30.001697 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:22:30.002679 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:22:30.002679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:31.339582 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.337 seconds
[0m03:22:31.342568 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:22:32.049587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158FFFD12B0>]}
[0m03:22:32.050694 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:22:32.052133 [info ] [MainThread]: 
[0m03:22:32.060282 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:22:32.062507 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:22:32.064198 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:22:32.064198 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:22:32.065233 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:22:32.066231 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:22:32.067222 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:22:32.068231 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:22:32.069228 [info ] [Thread-1  ]: 1 of 15 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:22:32.070222 [info ] [Thread-2  ]: 2 of 15 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:22:32.072222 [info ] [Thread-3  ]: 3 of 15 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:22:32.074243 [info ] [Thread-4  ]: 4 of 15 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:22:32.075245 [info ] [Thread-5  ]: 5 of 15 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:22:32.076459 [info ] [Thread-6  ]: 6 of 15 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:22:32.078706 [info ] [Thread-7  ]: 7 of 15 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:22:32.081588 [info ] [Thread-8  ]: 8 of 15 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:22:32.083004 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:22:32.085022 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:22:32.087035 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:22:32.089031 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:22:32.090026 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:22:32.092017 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:22:32.093017 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:22:32.094819 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:22:32.095840 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:22:32.097853 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:22:32.098845 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:22:32.099836 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:22:32.100837 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:22:32.101877 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:22:32.102841 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:22:32.103831 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:22:32.115501 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:22:32.137230 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:22:32.141924 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:22:32.147923 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:22:32.151924 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:22:32.156367 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:22:32.161423 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:22:32.167641 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:22:32.169650 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:22:32.170163 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:22:32.171675 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:22:32.172968 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:22:32.174015 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:22:32.175537 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:22:32.176048 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:22:32.201692 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:22:32.219223 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:22:32.223464 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:22:32.228474 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:22:32.234578 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:22:32.239602 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:22:32.244596 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:22:32.250099 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:22:32.254103 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:22:32.256098 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:22:32.258102 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:22:32.260102 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:22:32.263107 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:22:32.264811 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:22:32.266806 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:22:32.268805 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:22:32.269806 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:22:32.270806 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:22:32.271814 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:22:32.272804 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:22:32.274797 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:22:32.275801 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:22:32.276805 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:22:32.278803 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:22:32.281298 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:22:32.282485 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:22:32.283592 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:22:32.285614 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:22:32.286670 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:22:32.287680 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:22:32.288684 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:22:32.289684 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:22:32.290786 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:22:34.091874 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.803 seconds
[0m03:22:34.130574 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:22:34.133612 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.851 seconds
[0m03:22:34.136605 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:22:34.172457 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.881 seconds
[0m03:22:34.177465 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:22:34.189139 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.903 seconds
[0m03:22:34.192251 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:22:34.237401 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.951 seconds
[0m03:22:34.238486 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.951 seconds
[0m03:22:34.241507 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:22:34.245515 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:22:34.247517 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.958 seconds
[0m03:22:34.258572 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:22:34.265382 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.981 seconds
[0m03:22:34.269399 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:22:34.822229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158833B7130>]}
[0m03:22:34.823628 [info ] [Thread-1  ]: 1 of 15 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 2.74s]
[0m03:22:34.825248 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:22:34.826950 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_customer
[0m03:22:34.828571 [info ] [Thread-10 ]: 9 of 15 START sql table model dbt_schema.dim_customer .......................... [RUN]
[0m03:22:34.830202 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_customer'
[0m03:22:34.831302 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_customer
[0m03:22:34.835619 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:22:34.837245 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_customer
[0m03:22:34.872959 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:22:34.876959 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:22:34.878955 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588330B6A0>]}
[0m03:22:34.879957 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015883300D90>]}
[0m03:22:34.881951 [debug] [Thread-10 ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:22:34.883202 [info ] [Thread-8  ]: 8 of 15 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 2.78s]
[0m03:22:34.886483 [info ] [Thread-6  ]: 6 of 15 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 2.79s]
[0m03:22:34.888507 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:22:34.890498 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:22:34.892856 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:22:34.901932 [debug] [Thread-1  ]: Began running node model.dbtairflow.dim_supplier
[0m03:22:34.904950 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158832C9160>]}
[0m03:22:34.905952 [info ] [Thread-1  ]: 10 of 15 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:22:34.906957 [info ] [Thread-3  ]: 3 of 15 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 2.82s]
[0m03:22:34.908945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.dim_supplier)
[0m03:22:34.910950 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:22:34.912955 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:22:34.915958 [debug] [Thread-8  ]: Began running node model.dbtairflow.dim_nation
[0m03:22:34.921946 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:22:34.923945 [info ] [Thread-8  ]: 11 of 15 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:22:34.924944 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.dim_nation)
[0m03:22:34.925950 [debug] [Thread-1  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:22:34.926943 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:22:34.932949 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:22:34.937970 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:22:34.941973 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:22:34.943962 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158833008B0>]}
[0m03:22:34.945011 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015883300B20>]}
[0m03:22:34.946020 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158832D9220>]}
[0m03:22:34.947034 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:22:34.948659 [debug] [Thread-8  ]: Began executing node model.dbtairflow.dim_nation
[0m03:22:34.949671 [info ] [Thread-4  ]: 4 of 15 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 2.85s]
[0m03:22:34.951680 [info ] [Thread-5  ]: 5 of 15 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 2.85s]
[0m03:22:34.952669 [info ] [Thread-2  ]: 2 of 15 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 2.86s]
[0m03:22:34.953674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:22:34.957668 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:22:34.959676 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:22:34.961684 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:22:34.964481 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:22:34.969494 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_orders
[0m03:22:34.970498 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:22:34.971496 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_part
[0m03:22:34.973498 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m03:22:34.973498 [info ] [Thread-6  ]: 12 of 15 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m03:22:34.975495 [debug] [Thread-8  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:22:34.976493 [info ] [Thread-9  ]: 13 of 15 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:22:34.978501 [info ] [Thread-5  ]: 14 of 15 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:22:34.979610 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_orders)
[0m03:22:34.981135 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m03:22:34.982136 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_part'
[0m03:22:34.984151 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.fct_orders)
[0m03:22:34.985150 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588330B3D0>]}
[0m03:22:34.986145 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_orders
[0m03:22:34.989146 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_part
[0m03:22:34.990146 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:22:34.992146 [info ] [Thread-7  ]: 7 of 15 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 2.89s]
[0m03:22:34.999358 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:22:35.003883 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:22:35.010565 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:22:35.012099 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:22:35.014096 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_orders
[0m03:22:35.016093 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_part
[0m03:22:35.017092 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_region
[0m03:22:35.018234 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m03:22:35.024243 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:22:35.029935 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:22:35.030937 [info ] [Thread-4  ]: 15 of 15 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:22:35.035935 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:22:35.037935 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:22:35.038934 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_region)
[0m03:22:35.040937 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:22:35.041936 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:22:35.045321 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:22:35.046331 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_region
[0m03:22:35.047332 [debug] [Thread-9  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:22:35.048331 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:22:35.049334 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:22:35.054332 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:22:35.055330 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:22:35.061777 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:22:35.067362 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_region
[0m03:22:35.075371 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:22:35.077545 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:22:35.079034 [debug] [Thread-4  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:22:35.080044 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:22:37.460816 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.507 seconds
[0m03:22:37.464225 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: Close
[0m03:22:37.562142 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.674 seconds
[0m03:22:37.566993 [debug] [Thread-10 ]: On model.dbtairflow.dim_customer: Close
[0m03:22:37.998268 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.918 seconds
[0m03:22:38.001794 [debug] [Thread-4  ]: On model.dbtairflow.dim_region: Close
[0m03:22:38.050974 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.070 seconds
[0m03:22:38.053003 [debug] [Thread-8  ]: On model.dbtairflow.dim_nation: Close
[0m03:22:38.105328 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.056 seconds
[0m03:22:38.108164 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: Close
[0m03:22:38.165660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588349FB20>]}
[0m03:22:38.167385 [info ] [Thread-1  ]: 10 of 15 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 3.26s]
[0m03:22:38.169002 [debug] [Thread-1  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:22:38.244511 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588338E550>]}
[0m03:22:38.245524 [info ] [Thread-10 ]: 9 of 15 OK created sql table model dbt_schema.dim_customer ..................... [[32mSUCCESS 1[0m in 3.41s]
[0m03:22:38.246523 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_customer
[0m03:22:38.402795 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.347 seconds
[0m03:22:38.406798 [debug] [Thread-9  ]: On model.dbtairflow.dim_part: Close
[0m03:22:38.695148 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881BF9C40>]}
[0m03:22:38.697161 [info ] [Thread-4  ]: 15 of 15 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.66s]
[0m03:22:38.698324 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_region
[0m03:22:38.728180 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588328EA60>]}
[0m03:22:38.729399 [info ] [Thread-8  ]: 11 of 15 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.80s]
[0m03:22:38.731416 [debug] [Thread-8  ]: Finished running node model.dbtairflow.dim_nation
[0m03:22:38.758636 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881CE1160>]}
[0m03:22:38.759645 [info ] [Thread-6  ]: 12 of 15 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 3.78s]
[0m03:22:38.760647 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_orders
[0m03:22:38.846295 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.786 seconds
[0m03:22:38.849347 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m03:22:39.086469 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881D7F070>]}
[0m03:22:39.088109 [info ] [Thread-9  ]: 13 of 15 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 4.10s]
[0m03:22:39.089803 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_part
[0m03:22:39.564401 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86856069-2461-4391-a991-cc4cc213e0fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881CFB370>]}
[0m03:22:39.565955 [info ] [Thread-5  ]: 14 of 15 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 4.58s]
[0m03:22:39.567934 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m03:22:39.570897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:39.570897 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:22:39.572330 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:22:39.572330 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:22:39.573506 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_line_items' was properly closed.
[0m03:22:39.573506 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_nation' was properly closed.
[0m03:22:39.574939 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:22:39.574939 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:22:39.576441 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:22:39.577515 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_region' was properly closed.
[0m03:22:39.577515 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:22:39.578545 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:22:39.578545 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:22:39.580647 [info ] [MainThread]: 
[0m03:22:39.581684 [info ] [MainThread]: Finished running 8 view models, 7 table models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m03:22:39.587039 [debug] [MainThread]: Command end result
[0m03:22:39.645524 [info ] [MainThread]: 
[0m03:22:39.646526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:22:39.647715 [info ] [MainThread]: 
[0m03:22:39.649337 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m03:22:39.650367 [debug] [MainThread]: Command `dbt run` succeeded at 03:22:39.650367 after 13.59 seconds
[0m03:22:39.651699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158FDF982E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015880613400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015881CD9CD0>]}
[0m03:22:39.651699 [debug] [MainThread]: Flushing usage events
[0m03:41:08.233665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B9A482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC562B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC562D60>]}


============================== 03:41:08.242723 | 4dce60c4-1f5b-4011-8566-3b20401c6bee ==============================
[0m03:41:08.242723 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:41:08.243722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:41:09.043078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD2232E0>]}
[0m03:41:09.100619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC3539A0>]}
[0m03:41:09.102365 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:41:09.120479 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:41:09.426646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:41:09.427664 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\fact_ability_of_supplier.sql
[0m03:41:09.776168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BE76E130>]}
[0m03:41:09.969668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD343B50>]}
[0m03:41:09.969668 [info ] [MainThread]: Found 16 models, 9 data tests, 8 sources, 565 macros
[0m03:41:09.971802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD6F33D0>]}
[0m03:41:09.974786 [info ] [MainThread]: 
[0m03:41:09.976786 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:09.984769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:41:10.001489 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:41:10.002501 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:41:10.002501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:11.670349 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.667 seconds
[0m03:41:11.672343 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:41:12.401257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:41:12.411842 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:41:12.412842 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:41:12.413842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:13.669001 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.255 seconds
[0m03:41:13.671995 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:41:14.395063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD687970>]}
[0m03:41:14.396081 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:41:14.397853 [info ] [MainThread]: 
[0m03:41:14.408006 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:41:14.408988 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:41:14.408988 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:41:14.409995 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:41:14.411004 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:41:14.412102 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:41:14.414127 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:41:14.415117 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:41:14.413119 [info ] [Thread-1  ]: 1 of 16 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:41:14.416114 [info ] [Thread-2  ]: 2 of 16 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:41:14.418123 [info ] [Thread-3  ]: 3 of 16 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:41:14.419132 [info ] [Thread-4  ]: 4 of 16 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:41:14.421122 [info ] [Thread-5  ]: 5 of 16 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:41:14.422133 [info ] [Thread-6  ]: 6 of 16 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:41:14.424134 [info ] [Thread-7  ]: 7 of 16 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:41:14.427124 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:41:14.425121 [info ] [Thread-8  ]: 8 of 16 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:41:14.428116 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:41:14.429120 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:41:14.430111 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:41:14.431137 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:41:14.432129 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:41:14.434124 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:41:14.435119 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:41:14.436112 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:41:14.437122 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:41:14.438120 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:41:14.439119 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:41:14.440131 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:41:14.441133 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:41:14.441133 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:41:14.450675 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:41:14.452678 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:41:14.462887 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:41:14.473854 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:41:14.477863 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:41:14.482869 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:41:14.486888 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:41:14.492559 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:41:14.497553 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:41:14.498552 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:41:14.500542 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:41:14.500542 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:41:14.501542 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:41:14.502554 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:41:14.504543 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:41:14.505539 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:41:14.505539 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:41:14.534594 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:41:14.539563 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:41:14.543950 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:41:14.549251 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:41:14.554273 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:41:14.557838 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:41:14.562849 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:41:14.566839 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:41:14.568823 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:41:14.571117 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:41:14.572109 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:41:14.575010 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:41:14.576034 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:41:14.578303 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:41:14.579324 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:41:14.580337 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:41:14.582347 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:41:14.582887 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:41:14.582887 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:41:14.584903 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:41:14.585944 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:41:14.587174 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:41:14.588484 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:41:14.589357 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:41:14.589952 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:41:14.590960 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:41:14.591983 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:41:14.592996 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:41:14.594016 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:41:14.595014 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:41:14.595014 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:41:14.598150 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:41:16.355709 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.762 seconds
[0m03:41:16.392990 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:41:16.425588 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.830 seconds
[0m03:41:16.429497 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:41:16.433217 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.840 seconds
[0m03:41:16.436352 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:41:16.453504 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.863 seconds
[0m03:41:16.457660 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:41:16.468233 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.877 seconds
[0m03:41:16.471760 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:41:16.496978 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.899 seconds
[0m03:41:16.499407 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:41:16.519121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.930 seconds
[0m03:41:16.520540 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.926 seconds
[0m03:41:16.522554 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:41:16.525548 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:41:17.063330 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEADCFD0>]}
[0m03:41:17.064408 [info ] [Thread-5  ]: 5 of 16 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 2.63s]
[0m03:41:17.066003 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:41:17.067058 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_part
[0m03:41:17.068134 [info ] [Thread-10 ]: 9 of 16 START sql table model dbt_schema.dim_part .............................. [RUN]
[0m03:41:17.070282 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_part'
[0m03:41:17.070809 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_part
[0m03:41:17.074956 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:41:17.076060 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_part
[0m03:41:17.099841 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:41:17.101820 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:41:17.102820 [debug] [Thread-10 ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:41:17.103815 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:41:17.126940 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEADCC40>]}
[0m03:41:17.127940 [info ] [Thread-4  ]: 4 of 16 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 2.70s]
[0m03:41:17.128941 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:41:17.130940 [debug] [Thread-5  ]: Began running node model.dbtairflow.dim_orders
[0m03:41:17.131940 [info ] [Thread-5  ]: 10 of 16 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m03:41:17.133932 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.dim_orders)
[0m03:41:17.133932 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.dim_orders
[0m03:41:17.138931 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:41:17.139931 [debug] [Thread-5  ]: Began executing node model.dbtairflow.dim_orders
[0m03:41:17.144291 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:41:17.145291 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:41:17.146273 [debug] [Thread-5  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:41:17.146273 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:41:17.155570 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEAE48B0>]}
[0m03:41:17.155570 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEADCA60>]}
[0m03:41:17.158052 [info ] [Thread-7  ]: 7 of 16 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 2.72s]
[0m03:41:17.162084 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:41:17.161072 [info ] [Thread-3  ]: 3 of 16 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 2.73s]
[0m03:41:17.164470 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_region
[0m03:41:17.165482 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:41:17.167501 [info ] [Thread-4  ]: 11 of 16 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:41:17.168501 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_nation
[0m03:41:17.170991 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_region)
[0m03:41:17.171978 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_region
[0m03:41:17.170991 [info ] [Thread-7  ]: 12 of 16 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:41:17.177081 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:41:17.178060 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_nation)
[0m03:41:17.179300 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEAAE4C0>]}
[0m03:41:17.180630 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_region
[0m03:41:17.181649 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:41:17.183643 [info ] [Thread-2  ]: 2 of 16 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 2.75s]
[0m03:41:17.187717 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:41:17.193543 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:41:17.194529 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:41:17.195530 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEAE49D0>]}
[0m03:41:17.196706 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_nation
[0m03:41:17.198067 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:41:17.199085 [debug] [Thread-3  ]: Began running node model.dbtairflow.fct_orders
[0m03:41:17.204256 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:41:17.200091 [info ] [Thread-8  ]: 8 of 16 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 2.76s]
[0m03:41:17.205233 [debug] [Thread-4  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:41:17.206694 [info ] [Thread-3  ]: 13 of 16 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:41:17.208729 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:41:17.210031 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:41:17.211039 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:41:17.212049 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fct_orders)
[0m03:41:17.213057 [debug] [Thread-7  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:41:17.215060 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_supplier
[0m03:41:17.220313 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEAE4A30>]}
[0m03:41:17.221386 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:41:17.223513 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m03:41:17.224520 [info ] [Thread-2  ]: 14 of 16 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:41:17.231520 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:41:17.226523 [info ] [Thread-6  ]: 6 of 16 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 2.79s]
[0m03:41:17.238522 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_supplier)
[0m03:41:17.242157 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:41:17.243235 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fct_orders
[0m03:41:17.244242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEAAE3D0>]}
[0m03:41:17.244242 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:41:17.313404 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:41:17.313913 [debug] [Thread-8  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m03:41:17.315921 [info ] [Thread-1  ]: 1 of 16 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 2.82s]
[0m03:41:17.319935 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:41:17.323440 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:41:17.322427 [info ] [Thread-8  ]: 15 of 16 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m03:41:17.325929 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:41:17.326937 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:41:17.326937 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:41:17.328044 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.fact_ability_of_supplier)
[0m03:41:17.330363 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_customer
[0m03:41:17.331730 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:41:17.335308 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:41:17.337085 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m03:41:17.338658 [info ] [Thread-6  ]: 16 of 16 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:41:17.343084 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:41:17.348323 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:41:17.349336 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_customer)
[0m03:41:17.350435 [debug] [Thread-2  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:41:17.351789 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:41:17.352923 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:41:17.353954 [debug] [Thread-8  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m03:41:17.357954 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:41:17.366669 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:41:17.369194 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_customer
[0m03:41:17.372989 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:41:17.377296 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m03:41:17.378303 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:41:17.379293 [debug] [Thread-8  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final (
    select sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from 
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join 
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by sup.suppkey
),

select * from final
        );
[0m03:41:17.380440 [debug] [Thread-6  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:41:17.380440 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m03:41:17.381499 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:41:18.877215 [debug] [Thread-8  ]: Snowflake adapter: Snowflake query id: 01b6a319-0001-3ca2-0002-0e420004105e
[0m03:41:18.877215 [debug] [Thread-8  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'select'.
syntax error line 5 at position 23 unexpected '.'.
syntax error line 6 at position 21 unexpected '.'.
syntax error line 7 at position 21 unexpected '.'.
syntax error line 8 at position 4 unexpected 'from'.
syntax error line 12 at position 11 unexpected 'sup'.
[0m03:41:18.878194 [debug] [Thread-8  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m03:41:19.541483 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.330 seconds
[0m03:41:19.543556 [debug] [Thread-4  ]: On model.dbtairflow.dim_region: Close
[0m03:41:19.569691 [debug] [Thread-8  ]: Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'sup'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:41:19.571100 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC0EF070>]}
[0m03:41:19.572112 [error] [Thread-8  ]: 15 of 16 ERROR creating sql table model dbt_schema.fact_ability_of_supplier .... [[31mERROR[0m in 2.24s]
[0m03:41:19.573107 [debug] [Thread-8  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m03:41:19.585572 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.362 seconds
[0m03:41:19.587815 [debug] [Thread-7  ]: On model.dbtairflow.dim_nation: Close
[0m03:41:20.008721 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.655 seconds
[0m03:41:20.010719 [debug] [Thread-2  ]: On model.dbtairflow.dim_supplier: Close
[0m03:41:20.051814 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.906 seconds
[0m03:41:20.054890 [debug] [Thread-5  ]: On model.dbtairflow.dim_orders: Close
[0m03:41:20.187807 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.806 seconds
[0m03:41:20.189865 [debug] [Thread-6  ]: On model.dbtairflow.dim_customer: Close
[0m03:41:20.190864 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BED5CC40>]}
[0m03:41:20.193507 [info ] [Thread-4  ]: 11 of 16 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.02s]
[0m03:41:20.195872 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_region
[0m03:41:20.252098 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.148 seconds
[0m03:41:20.254100 [debug] [Thread-10 ]: On model.dbtairflow.dim_part: Close
[0m03:41:20.284052 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BED8ED00>]}
[0m03:41:20.285145 [info ] [Thread-7  ]: 12 of 16 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.11s]
[0m03:41:20.286450 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_nation
[0m03:41:20.686026 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEA5AF40>]}
[0m03:41:20.687037 [info ] [Thread-2  ]: 14 of 16 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 3.45s]
[0m03:41:20.689518 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:41:20.722231 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEB02E80>]}
[0m03:41:20.723229 [info ] [Thread-5  ]: 10 of 16 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 3.59s]
[0m03:41:20.724234 [debug] [Thread-5  ]: Finished running node model.dbtairflow.dim_orders
[0m03:41:20.964483 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BED0E7C0>]}
[0m03:41:20.965485 [info ] [Thread-10 ]: 9 of 16 OK created sql table model dbt_schema.dim_part ......................... [[32mSUCCESS 1[0m in 3.89s]
[0m03:41:20.967492 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_part
[0m03:41:21.007632 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEB58D30>]}
[0m03:41:21.009647 [info ] [Thread-6  ]: 16 of 16 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 3.66s]
[0m03:41:21.010641 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_customer
[0m03:41:21.827756 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.497 seconds
[0m03:41:21.830764 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: Close
[0m03:41:22.538710 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce60c4-1f5b-4011-8566-3b20401c6bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BEB14340>]}
[0m03:41:22.539710 [info ] [Thread-3  ]: 13 of 16 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 5.33s]
[0m03:41:22.541710 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fct_orders
[0m03:41:22.544968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:22.545979 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:41:22.545979 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:41:22.547019 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_customer' was properly closed.
[0m03:41:22.547539 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:41:22.547539 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:41:22.549019 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:41:22.549019 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:41:22.550113 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:41:22.550113 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:41:22.550113 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m03:41:22.551237 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:41:22.551237 [info ] [MainThread]: 
[0m03:41:22.553233 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 12.58 seconds (12.58s).
[0m03:41:22.557246 [debug] [MainThread]: Command end result
[0m03:41:22.617412 [info ] [MainThread]: 
[0m03:41:22.618413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:41:22.621406 [info ] [MainThread]: 
[0m03:41:22.623408 [error] [MainThread]:   Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'sup'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:41:22.625781 [info ] [MainThread]: 
[0m03:41:22.627987 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m03:41:22.629998 [debug] [MainThread]: Command `dbt run` failed at 03:41:22.629011 after 14.52 seconds
[0m03:41:22.629998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B9A482E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC0A3C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD22EE20>]}
[0m03:41:22.631004 [debug] [MainThread]: Flushing usage events
[0m03:45:44.103795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238132882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023815D9CBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023815D9CFD0>]}


============================== 03:45:44.109888 | 8d6db677-715a-4220-b500-cdd2b1f6b273 ==============================
[0m03:45:44.109888 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:45:44.110888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:45:44.624964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238136CB0D0>]}
[0m03:45:44.676132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816B1B8B0>]}
[0m03:45:44.678142 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:45:44.692133 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:45:44.918054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m03:45:44.919069 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\fact_providing_feature_of_parts.sql
[0m03:45:44.920065 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_ability_of_supplier.sql
[0m03:45:45.230874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816FDE130>]}
[0m03:45:45.413456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816F34F40>]}
[0m03:45:45.414887 [info ] [MainThread]: Found 17 models, 9 data tests, 8 sources, 565 macros
[0m03:45:45.415392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816E5D5E0>]}
[0m03:45:45.418439 [info ] [MainThread]: 
[0m03:45:45.419421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:45:45.427279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:45:45.446276 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:45:45.447278 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:45:45.448279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:46.966036 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.518 seconds
[0m03:45:46.969038 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:45:47.658448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:45:47.669020 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:45:47.670018 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:45:47.670018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:48.908792 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.238 seconds
[0m03:45:48.911548 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:45:49.587293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816A633A0>]}
[0m03:45:49.588334 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:45:49.589308 [info ] [MainThread]: 
[0m03:45:49.597680 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:45:49.598656 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:45:49.599671 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:45:49.600670 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:45:49.600670 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:45:49.603854 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:45:49.604740 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:45:49.602833 [info ] [Thread-1  ]: 1 of 17 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:45:49.605775 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:45:49.606776 [info ] [Thread-2  ]: 2 of 17 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:45:49.608756 [info ] [Thread-3  ]: 3 of 17 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:45:49.609755 [info ] [Thread-4  ]: 4 of 17 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:45:49.610779 [info ] [Thread-5  ]: 5 of 17 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:45:49.612328 [info ] [Thread-6  ]: 6 of 17 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:45:49.614306 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:45:49.613315 [info ] [Thread-7  ]: 7 of 17 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:45:49.615321 [info ] [Thread-8  ]: 8 of 17 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:45:49.616308 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:45:49.617496 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:45:49.618880 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:45:49.620245 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:45:49.621602 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:45:49.622625 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:45:49.623672 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:45:49.625739 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:45:49.627094 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:45:49.628114 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:45:49.628114 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:45:49.629114 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:45:49.630130 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:45:49.639321 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:45:49.641323 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:45:49.641323 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:45:49.659777 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:45:49.663112 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:45:49.668221 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:45:49.672227 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:45:49.676221 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:45:49.682174 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:45:49.683159 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:45:49.687960 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:45:49.689004 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:45:49.690511 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:45:49.692539 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:45:49.693527 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:45:49.694537 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:45:49.723846 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:45:49.725882 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:45:49.730952 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:45:49.735590 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:45:49.736593 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:45:49.742312 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:45:49.745738 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:45:49.750783 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:45:49.756788 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:45:49.758782 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:45:49.761013 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:45:49.766258 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:45:49.767836 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:45:49.770412 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:45:49.770412 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:45:49.773933 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:45:49.774959 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:45:49.775950 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:45:49.777107 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:45:49.778663 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:45:49.779696 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:45:49.781136 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:45:49.782448 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:45:49.784446 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:45:49.785460 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:45:49.786489 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:45:49.787480 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:45:49.789136 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:45:49.790270 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:45:49.790270 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:45:49.791316 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:45:49.792306 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:45:49.795307 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:45:49.807660 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:45:51.571804 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.780 seconds
[0m03:45:51.572805 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.784 seconds
[0m03:45:51.601685 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:45:51.602695 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.816 seconds
[0m03:45:51.605663 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:45:51.609810 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:45:51.643731 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.848 seconds
[0m03:45:51.645770 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.837 seconds
[0m03:45:51.647756 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:45:51.649824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.865 seconds
[0m03:45:51.651168 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.861 seconds
[0m03:45:51.654180 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:45:51.658402 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:45:51.663071 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:45:51.666322 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.874 seconds
[0m03:45:51.674291 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:45:52.347938 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325CD0>]}
[0m03:45:52.348453 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381831CE50>]}
[0m03:45:52.349572 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238182F2B80>]}
[0m03:45:52.351605 [info ] [Thread-4  ]: 4 of 17 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 2.73s]
[0m03:45:52.353587 [info ] [Thread-3  ]: 3 of 17 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 2.73s]
[0m03:45:52.354587 [info ] [Thread-2  ]: 2 of 17 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 2.73s]
[0m03:45:52.355714 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:45:52.358217 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:45:52.359663 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:45:52.360916 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_orders
[0m03:45:52.362055 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_nation
[0m03:45:52.364144 [debug] [Thread-3  ]: Began running node model.dbtairflow.fct_orders
[0m03:45:52.363066 [info ] [Thread-10 ]: 9 of 17 START sql table model dbt_schema.dim_orders ............................ [RUN]
[0m03:45:52.365180 [info ] [Thread-4  ]: 10 of 17 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:45:52.367578 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_orders'
[0m03:45:52.366177 [info ] [Thread-3  ]: 11 of 17 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:45:52.368607 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_nation)
[0m03:45:52.368607 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_orders
[0m03:45:52.369617 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fct_orders)
[0m03:45:52.370639 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:45:52.375273 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:45:52.377541 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:45:52.383499 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:45:52.384495 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325B50>]}
[0m03:45:52.391897 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:45:52.393912 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325E20>]}
[0m03:45:52.395248 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_orders
[0m03:45:52.396847 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_nation
[0m03:45:52.398870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238182F2700>]}
[0m03:45:52.397857 [info ] [Thread-5  ]: 5 of 17 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 2.76s]
[0m03:45:52.402440 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fct_orders
[0m03:45:52.400151 [info ] [Thread-6  ]: 6 of 17 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 2.77s]
[0m03:45:52.428096 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:45:52.433905 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:45:52.434991 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325CA0>]}
[0m03:45:52.436008 [info ] [Thread-1  ]: 1 of 17 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 2.79s]
[0m03:45:52.438010 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:45:52.439206 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325A30>]}
[0m03:45:52.443688 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:45:52.444704 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:45:52.446703 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:45:52.448229 [info ] [Thread-7  ]: 7 of 17 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 2.81s]
[0m03:45:52.449504 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:45:52.450515 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:45:52.451580 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_part
[0m03:45:52.452590 [info ] [Thread-8  ]: 8 of 17 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 2.81s]
[0m03:45:52.456185 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:45:52.457200 [debug] [Thread-5  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:45:52.458193 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:45:52.460201 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:45:52.461195 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_customer
[0m03:45:52.462241 [debug] [Thread-4  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:45:52.463252 [info ] [Thread-2  ]: 12 of 17 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:45:52.464499 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:45:52.465511 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:45:52.467890 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:45:52.466875 [info ] [Thread-5  ]: 13 of 17 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m03:45:52.470314 [debug] [Thread-1  ]: Began running node model.dbtairflow.dim_region
[0m03:45:52.469295 [info ] [Thread-6  ]: 14 of 17 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:45:52.471745 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:45:52.472756 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_part)
[0m03:45:52.473760 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_supplier
[0m03:45:52.474877 [debug] [Thread-9  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m03:45:52.475883 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:45:52.479426 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.fact_providing_feature_of_parts)
[0m03:45:52.483549 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_customer)
[0m03:45:52.481950 [info ] [Thread-1  ]: 15 of 17 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:45:52.486447 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_part
[0m03:45:52.488865 [info ] [Thread-7  ]: 16 of 17 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:45:52.489867 [info ] [Thread-9  ]: 17 of 17 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m03:45:52.494348 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m03:45:52.496358 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:45:52.497856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.dim_region)
[0m03:45:52.503351 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:45:52.505356 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_supplier)
[0m03:45:52.506723 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.fact_ability_of_supplier'
[0m03:45:52.512051 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:45:52.583534 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:45:52.583534 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.dim_region
[0m03:45:52.587021 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:45:52.587525 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_part
[0m03:45:52.588536 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m03:45:52.589531 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m03:45:52.594974 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:45:52.594974 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_customer
[0m03:45:52.598697 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:45:52.603754 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:45:52.609752 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:45:52.613411 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:45:52.619394 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:45:52.620395 [debug] [Thread-1  ]: Began executing node model.dbtairflow.dim_region
[0m03:45:52.621398 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:45:52.623391 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:45:52.624391 [debug] [Thread-9  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m03:45:52.630401 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:45:52.631391 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:45:52.632395 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:45:52.636907 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:45:52.637438 [debug] [Thread-2  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:45:52.642833 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:45:52.644832 [debug] [Thread-5  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final (
    select part.part_key ,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from 
        DBT_DB.dbt_schema.stg_tpch_part as part
    join 
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by part.part_key 
)

select * from final
        );
[0m03:45:52.645839 [debug] [Thread-6  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:45:52.645839 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:45:52.647835 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:45:52.648348 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:45:52.650371 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:45:52.651357 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:45:52.652354 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m03:45:52.653354 [debug] [Thread-1  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:45:52.657366 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:45:52.663231 [debug] [Thread-9  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final (
    select sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from 
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join 
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by sup.suppkey
)

select * from final
        );
[0m03:45:52.664706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:45:52.666161 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m03:45:52.667538 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:45:54.257844 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01b6a31d-0001-3c91-0002-0e420003f07e
[0m03:45:54.258844 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'select'.
syntax error line 5 at position 23 unexpected '.'.
syntax error line 6 at position 21 unexpected '.'.
syntax error line 7 at position 21 unexpected '.'.
syntax error line 8 at position 4 unexpected 'from'.
syntax error line 12 at position 11 unexpected 'part'.
[0m03:45:54.259834 [debug] [Thread-5  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m03:45:54.417661 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01b6a31d-0001-3c84-0002-0e4200042076
[0m03:45:54.419086 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'select'.
syntax error line 5 at position 23 unexpected '.'.
syntax error line 6 at position 21 unexpected '.'.
syntax error line 7 at position 21 unexpected '.'.
syntax error line 8 at position 4 unexpected 'from'.
syntax error line 12 at position 11 unexpected 'sup'.
[0m03:45:54.420455 [debug] [Thread-9  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m03:45:54.717034 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.245 seconds
[0m03:45:54.718587 [debug] [Thread-4  ]: On model.dbtairflow.dim_nation: Close
[0m03:45:54.911067 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.244 seconds
[0m03:45:54.912801 [debug] [Thread-7  ]: On model.dbtairflow.dim_supplier: Close
[0m03:45:54.929945 [debug] [Thread-5  ]: Database Error in model fact_providing_feature_of_parts (models\marts\fact_providing_feature_of_parts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'part'.
  compiled Code at target\run\dbtairflow\models\marts\fact_providing_feature_of_parts.sql
[0m03:45:54.930945 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818325520>]}
[0m03:45:54.931946 [error] [Thread-5  ]: 13 of 17 ERROR creating sql table model dbt_schema.fact_providing_feature_of_parts  [[31mERROR[0m in 2.45s]
[0m03:45:54.932946 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:45:55.008127 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.540 seconds
[0m03:45:55.011143 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: Close
[0m03:45:55.114519 [debug] [Thread-9  ]: Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'sup'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:45:55.115517 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816B33C70>]}
[0m03:45:55.116523 [error] [Thread-9  ]: 17 of 17 ERROR creating sql table model dbt_schema.fact_ability_of_supplier .... [[31mERROR[0m in 2.61s]
[0m03:45:55.117520 [debug] [Thread-9  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m03:45:55.379499 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818399C10>]}
[0m03:45:55.380515 [info ] [Thread-4  ]: 10 of 17 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.01s]
[0m03:45:55.382518 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_nation
[0m03:45:55.506191 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.858 seconds
[0m03:45:55.508192 [debug] [Thread-2  ]: On model.dbtairflow.dim_part: Close
[0m03:45:55.539848 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.874 seconds
[0m03:45:55.542514 [debug] [Thread-1  ]: On model.dbtairflow.dim_region: Close
[0m03:45:55.571541 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818252160>]}
[0m03:45:55.572582 [info ] [Thread-7  ]: 16 of 17 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 3.07s]
[0m03:45:55.574572 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:45:55.584334 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.932 seconds
[0m03:45:55.586920 [debug] [Thread-6  ]: On model.dbtairflow.dim_customer: Close
[0m03:45:55.701595 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818301280>]}
[0m03:45:55.703604 [info ] [Thread-10 ]: 9 of 17 OK created sql table model dbt_schema.dim_orders ....................... [[32mSUCCESS 1[0m in 3.34s]
[0m03:45:55.705603 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_orders
[0m03:45:56.024923 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.549 seconds
[0m03:45:56.028938 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: Close
[0m03:45:56.181344 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238184DC700>]}
[0m03:45:56.182385 [info ] [Thread-2  ]: 12 of 17 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 3.71s]
[0m03:45:56.183355 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_part
[0m03:45:56.235998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238183BD2E0>]}
[0m03:45:56.236515 [info ] [Thread-1  ]: 15 of 17 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.74s]
[0m03:45:56.238556 [debug] [Thread-1  ]: Finished running node model.dbtairflow.dim_region
[0m03:45:56.294245 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818470A90>]}
[0m03:45:56.295252 [info ] [Thread-6  ]: 14 of 17 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 3.81s]
[0m03:45:56.296264 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_customer
[0m03:45:56.737089 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6db677-715a-4220-b500-cdd2b1f6b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238170C1970>]}
[0m03:45:56.739107 [info ] [Thread-3  ]: 11 of 17 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 4.37s]
[0m03:45:56.740130 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fct_orders
[0m03:45:56.743430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:56.744432 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:45:56.745432 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:45:56.745432 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:45:56.746780 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:45:56.746780 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:45:56.747806 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:45:56.747806 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m03:45:56.748819 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:45:56.748819 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:45:56.749817 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_supplier' was properly closed.
[0m03:45:56.750813 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:45:56.750813 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m03:45:56.751823 [info ] [MainThread]: 
[0m03:45:56.752790 [info ] [MainThread]: Finished running 8 view models, 9 table models in 0 hours 0 minutes and 11.33 seconds (11.33s).
[0m03:45:56.757271 [debug] [MainThread]: Command end result
[0m03:45:56.805073 [info ] [MainThread]: 
[0m03:45:56.806076 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:45:56.808061 [info ] [MainThread]: 
[0m03:45:56.810070 [error] [MainThread]:   Database Error in model fact_providing_feature_of_parts (models\marts\fact_providing_feature_of_parts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'part'.
  compiled Code at target\run\dbtairflow\models\marts\fact_providing_feature_of_parts.sql
[0m03:45:56.812052 [info ] [MainThread]: 
[0m03:45:56.814050 [error] [MainThread]:   Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'select'.
  syntax error line 5 at position 23 unexpected '.'.
  syntax error line 6 at position 21 unexpected '.'.
  syntax error line 7 at position 21 unexpected '.'.
  syntax error line 8 at position 4 unexpected 'from'.
  syntax error line 12 at position 11 unexpected 'sup'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:45:56.816146 [info ] [MainThread]: 
[0m03:45:56.817676 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m03:45:56.818698 [debug] [MainThread]: Command `dbt run` failed at 03:45:56.818698 after 12.79 seconds
[0m03:45:56.819711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238132882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023816E8FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238182F2A90>]}
[0m03:45:56.820705 [debug] [MainThread]: Flushing usage events
[0m03:47:23.381578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06E5782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07108BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07108BFD0>]}


============================== 03:47:23.387762 | e1ffe274-077c-4b8b-a1cd-de78c8ce7468 ==============================
[0m03:47:23.387762 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:47:23.388763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:47:23.902744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06E9BB0D0>]}
[0m03:47:23.951822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A071E0A8B0>]}
[0m03:47:23.953821 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:47:23.969335 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:47:24.194819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:47:24.195821 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_providing_feature_of_parts.sql
[0m03:47:24.196854 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_ability_of_supplier.sql
[0m03:47:24.504343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0722CD130>]}
[0m03:47:24.667640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06EA9BC40>]}
[0m03:47:24.668919 [info ] [MainThread]: Found 17 models, 9 data tests, 8 sources, 565 macros
[0m03:47:24.669435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06EACC370>]}
[0m03:47:24.671976 [info ] [MainThread]: 
[0m03:47:24.674007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:47:24.681004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:47:24.696702 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:47:24.696702 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:47:24.698366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:26.303575 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.606 seconds
[0m03:47:26.305553 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:47:27.012694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:47:27.023463 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:47:27.024474 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:47:27.024474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:28.304852 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.281 seconds
[0m03:47:28.308341 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:47:28.990328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06EA1B490>]}
[0m03:47:28.991749 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:47:28.992911 [info ] [MainThread]: 
[0m03:47:28.999362 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:47:29.000359 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:47:29.001365 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:47:29.002354 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:47:29.003365 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:47:29.003365 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:47:29.004885 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:47:29.005906 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:47:29.006910 [info ] [Thread-1  ]: 1 of 17 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:47:29.007898 [info ] [Thread-2  ]: 2 of 17 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:47:29.009899 [info ] [Thread-3  ]: 3 of 17 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:47:29.010908 [info ] [Thread-4  ]: 4 of 17 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:47:29.012713 [info ] [Thread-5  ]: 5 of 17 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:47:29.014731 [info ] [Thread-6  ]: 6 of 17 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:47:29.015730 [info ] [Thread-7  ]: 7 of 17 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:47:29.016738 [info ] [Thread-8  ]: 8 of 17 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:47:29.018735 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:47:29.019726 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:47:29.020770 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:47:29.021809 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:47:29.022793 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:47:29.023791 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:47:29.024796 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:47:29.025793 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:47:29.026791 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:47:29.027799 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:47:29.028793 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:47:29.029790 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:47:29.030788 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:47:29.032792 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:47:29.033794 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:47:29.034790 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:47:29.044797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:47:29.063815 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:47:29.067803 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:47:29.071814 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:47:29.076367 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:47:29.082361 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:47:29.088463 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:47:29.093410 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:47:29.095206 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:47:29.096447 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:47:29.096956 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:47:29.098969 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:47:29.098969 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:47:29.100471 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:47:29.101481 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:47:29.126016 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:47:29.132715 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:47:29.137387 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:47:29.141549 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:47:29.146387 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:47:29.150142 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:47:29.154701 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:47:29.158990 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:47:29.163071 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:47:29.166037 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:47:29.168566 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:47:29.170113 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:47:29.171091 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:47:29.172172 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:47:29.174182 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:47:29.175807 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:47:29.176837 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:47:29.177846 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:47:29.179392 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:47:29.180370 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:47:29.180370 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:47:29.181393 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:47:29.182833 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:47:29.183727 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:47:29.184386 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:47:29.185188 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:47:29.185858 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:47:29.186897 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:47:29.188718 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:47:29.189749 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:47:29.189749 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:47:29.190753 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:47:29.191732 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:47:30.912749 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.723 seconds
[0m03:47:30.948479 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:47:30.951481 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.762 seconds
[0m03:47:30.953481 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.766 seconds
[0m03:47:30.956481 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:47:30.961481 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:47:30.973729 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.783 seconds
[0m03:47:30.976735 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:47:30.987835 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.798 seconds
[0m03:47:30.992218 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:47:31.050175 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.864 seconds
[0m03:47:31.053217 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:47:31.102685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.918 seconds
[0m03:47:31.106403 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:47:31.342107 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.151 seconds
[0m03:47:31.346232 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:47:31.645323 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0736F3F70>]}
[0m03:47:31.646315 [info ] [Thread-4  ]: 4 of 17 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 2.62s]
[0m03:47:31.648319 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:47:31.649313 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_orders
[0m03:47:31.650404 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A073739C70>]}
[0m03:47:31.651428 [info ] [Thread-10 ]: 9 of 17 START sql table model dbt_schema.dim_orders ............................ [RUN]
[0m03:47:31.652442 [info ] [Thread-6  ]: 6 of 17 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 2.63s]
[0m03:47:31.653447 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_orders'
[0m03:47:31.654822 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:47:31.656242 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_orders
[0m03:47:31.661255 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:47:31.663251 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_orders
[0m03:47:31.690039 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:47:31.693662 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:47:31.694660 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A073613D90>]}
[0m03:47:31.695667 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07360CE20>]}
[0m03:47:31.696661 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A073613DF0>]}
[0m03:47:31.697672 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:47:31.700728 [info ] [Thread-7  ]: 7 of 17 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 2.67s]
[0m03:47:31.703426 [info ] [Thread-3  ]: 3 of 17 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 2.67s]
[0m03:47:31.704452 [info ] [Thread-5  ]: 5 of 17 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 2.67s]
[0m03:47:31.705458 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:47:31.707446 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:47:31.708450 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:47:31.709480 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:47:31.713982 [debug] [Thread-3  ]: Began running node model.dbtairflow.dim_region
[0m03:47:31.715001 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_nation
[0m03:47:31.717003 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_part
[0m03:47:31.719001 [debug] [Thread-4  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:47:31.720008 [info ] [Thread-3  ]: 10 of 17 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:47:31.722033 [info ] [Thread-9  ]: 11 of 17 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:47:31.723026 [info ] [Thread-7  ]: 12 of 17 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:47:31.724539 [info ] [Thread-4  ]: 13 of 17 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m03:47:31.725570 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.dim_region)
[0m03:47:31.726911 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_nation'
[0m03:47:31.728288 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_part)
[0m03:47:31.729972 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.fact_providing_feature_of_parts)
[0m03:47:31.732098 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.dim_region
[0m03:47:31.734126 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:47:31.735129 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_part
[0m03:47:31.737121 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m03:47:31.745574 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:47:31.752572 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:47:31.759567 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0735D6850>]}
[0m03:47:31.760577 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:47:31.766544 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:47:31.768546 [debug] [Thread-3  ]: Began executing node model.dbtairflow.dim_region
[0m03:47:31.771547 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_nation
[0m03:47:31.770543 [info ] [Thread-2  ]: 2 of 17 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 2.74s]
[0m03:47:31.773043 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_part
[0m03:47:31.780279 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:47:31.781753 [debug] [Thread-4  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m03:47:31.785764 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:47:31.787769 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:47:31.793460 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:47:31.864279 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:47:31.865257 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:47:31.868254 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:47:31.869265 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m03:47:31.870275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0738584F0>]}
[0m03:47:31.872269 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:47:31.874259 [debug] [Thread-3  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:47:31.875266 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:47:31.876275 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:47:31.878260 [info ] [Thread-5  ]: 14 of 17 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:47:31.880252 [debug] [Thread-7  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:47:31.879278 [info ] [Thread-1  ]: 1 of 17 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 2.85s]
[0m03:47:31.882119 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:47:31.883153 [debug] [Thread-4  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final as (
    select
        part.part_key,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_part as part
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by
        part.part_key
)

select
    *
from
    final;
[0m03:47:31.883153 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:47:31.885617 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.fct_orders)
[0m03:47:31.886615 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m03:47:31.887625 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:47:31.891912 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:47:31.895896 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:47:31.899925 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_customer
[0m03:47:31.908745 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:47:31.911753 [info ] [Thread-2  ]: 15 of 17 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:47:31.913759 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_customer)
[0m03:47:31.914769 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:47:31.915778 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m03:47:31.919139 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:47:31.923516 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:47:31.925825 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_customer
[0m03:47:31.930299 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:47:31.933304 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:47:31.934349 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:47:31.935312 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:47:31.936325 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:47:31.939204 [debug] [Thread-2  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:47:31.940241 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:47:32.044904 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0736131C0>]}
[0m03:47:32.045905 [info ] [Thread-8  ]: 8 of 17 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 3.02s]
[0m03:47:32.047906 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:47:32.049904 [debug] [Thread-1  ]: Began running node model.dbtairflow.dim_supplier
[0m03:47:32.049904 [debug] [Thread-6  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m03:47:32.051902 [info ] [Thread-1  ]: 16 of 17 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m03:47:32.051902 [info ] [Thread-6  ]: 17 of 17 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m03:47:32.053912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.dim_supplier)
[0m03:47:32.054913 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.fact_ability_of_supplier)
[0m03:47:32.055905 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:47:32.056907 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m03:47:32.062911 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:47:32.067911 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:47:32.069912 [debug] [Thread-1  ]: Began executing node model.dbtairflow.dim_supplier
[0m03:47:32.070920 [debug] [Thread-6  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m03:47:32.074910 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:47:32.080435 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:47:32.082435 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:47:32.083435 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:47:32.085435 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m03:47:32.086444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:47:32.087440 [debug] [Thread-6  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final as (
    select
        sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by
        sup.suppkey
)

select
    *
from
    final;
[0m03:47:32.090437 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:47:33.510020 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01b6a31f-0001-3c91-0002-0e420003f092
[0m03:47:33.511043 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 9 unexpected ';'.
[0m03:47:33.512043 [debug] [Thread-4  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m03:47:34.009385 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01b6a31f-0001-3bfa-0002-0e4200045072
[0m03:47:34.010395 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 9 unexpected ';'.
[0m03:47:34.011395 [debug] [Thread-6  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m03:47:34.156917 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.452 seconds
[0m03:47:34.160518 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: Close
[0m03:47:34.211465 [debug] [Thread-4  ]: Database Error in model fact_providing_feature_of_parts (models\marts\fact_providing_feature_of_parts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 9 unexpected ';'.
  compiled Code at target\run\dbtairflow\models\marts\fact_providing_feature_of_parts.sql
[0m03:47:34.212495 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07385D7F0>]}
[0m03:47:34.213497 [error] [Thread-4  ]: 13 of 17 ERROR creating sql table model dbt_schema.fact_providing_feature_of_parts  [[31mERROR[0m in 2.48s]
[0m03:47:34.215480 [debug] [Thread-4  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:47:34.308026 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.424 seconds
[0m03:47:34.310043 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: Close
[0m03:47:34.456279 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.575 seconds
[0m03:47:34.459737 [debug] [Thread-3  ]: On model.dbtairflow.dim_region: Close
[0m03:47:34.483781 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.398 seconds
[0m03:47:34.488620 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: Close
[0m03:47:34.709621 [debug] [Thread-6  ]: Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 9 unexpected ';'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:47:34.710791 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A073800C70>]}
[0m03:47:34.711882 [error] [Thread-6  ]: 17 of 17 ERROR creating sql table model dbt_schema.fact_ability_of_supplier .... [[31mERROR[0m in 2.66s]
[0m03:47:34.712895 [debug] [Thread-6  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m03:47:34.818579 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.933 seconds
[0m03:47:34.821193 [debug] [Thread-7  ]: On model.dbtairflow.dim_part: Close
[0m03:47:34.826654 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07383FF70>]}
[0m03:47:34.827668 [info ] [Thread-10 ]: 9 of 17 OK created sql table model dbt_schema.dim_orders ....................... [[32mSUCCESS 1[0m in 3.17s]
[0m03:47:34.829080 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_orders
[0m03:47:34.855474 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.915 seconds
[0m03:47:34.858651 [debug] [Thread-2  ]: On model.dbtairflow.dim_customer: Close
[0m03:47:34.993950 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0738B5DF0>]}
[0m03:47:34.996377 [info ] [Thread-9  ]: 11 of 17 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.27s]
[0m03:47:34.998403 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_nation
[0m03:47:35.158762 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07360CF10>]}
[0m03:47:35.160762 [info ] [Thread-3  ]: 10 of 17 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.43s]
[0m03:47:35.162762 [debug] [Thread-3  ]: Finished running node model.dbtairflow.dim_region
[0m03:47:35.212849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A071E5F700>]}
[0m03:47:35.215861 [info ] [Thread-1  ]: 16 of 17 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 3.16s]
[0m03:47:35.217861 [debug] [Thread-1  ]: Finished running node model.dbtairflow.dim_supplier
[0m03:47:35.579975 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.644 seconds
[0m03:47:35.582006 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m03:47:35.583013 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0737B3F40>]}
[0m03:47:35.585006 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0737B3AF0>]}
[0m03:47:35.588011 [info ] [Thread-7  ]: 12 of 17 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 3.86s]
[0m03:47:35.591020 [info ] [Thread-2  ]: 15 of 17 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 3.67s]
[0m03:47:35.593007 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_part
[0m03:47:35.594004 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_customer
[0m03:47:36.276330 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ffe274-077c-4b8b-a1cd-de78c8ce7468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07233E220>]}
[0m03:47:36.277340 [info ] [Thread-5  ]: 14 of 17 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 4.39s]
[0m03:47:36.279750 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m03:47:36.283182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:36.284645 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:47:36.285834 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:47:36.287275 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:47:36.289569 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:47:36.290719 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:47:36.292734 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m03:47:36.294088 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:47:36.295539 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m03:47:36.296551 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:47:36.297877 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_supplier' was properly closed.
[0m03:47:36.298886 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:47:36.299919 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:47:36.302133 [info ] [MainThread]: 
[0m03:47:36.303603 [info ] [MainThread]: Finished running 8 view models, 9 table models in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m03:47:36.309038 [debug] [MainThread]: Command end result
[0m03:47:36.391295 [info ] [MainThread]: 
[0m03:47:36.393298 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:47:36.394629 [info ] [MainThread]: 
[0m03:47:36.395650 [error] [MainThread]:   Database Error in model fact_providing_feature_of_parts (models\marts\fact_providing_feature_of_parts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 9 unexpected ';'.
  compiled Code at target\run\dbtairflow\models\marts\fact_providing_feature_of_parts.sql
[0m03:47:36.398645 [info ] [MainThread]: 
[0m03:47:36.399649 [error] [MainThread]:   Database Error in model fact_ability_of_supplier (models\marts\fact_ability_of_supplier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 9 unexpected ';'.
  compiled Code at target\run\dbtairflow\models\marts\fact_ability_of_supplier.sql
[0m03:47:36.400772 [info ] [MainThread]: 
[0m03:47:36.401745 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m03:47:36.404115 [debug] [MainThread]: Command `dbt run` failed at 03:47:36.404115 after 13.10 seconds
[0m03:47:36.405111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A06E5782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A071E0A8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A071DFEAF0>]}
[0m03:47:36.406114 [debug] [MainThread]: Flushing usage events
[0m03:49:09.872631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD66982E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD91B2BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD91B2FD0>]}


============================== 03:49:09.878977 | 4b188858-3a67-44f5-836d-c8e3886fabf9 ==============================
[0m03:49:09.878977 [info ] [MainThread]: Running with dbt=1.8.5
[0m03:49:09.879990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:49:10.470809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6ADB0D0>]}
[0m03:49:10.531341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD9F2A8B0>]}
[0m03:49:10.532465 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m03:49:10.552200 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m03:49:10.809751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:49:10.810795 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_ability_of_supplier.sql
[0m03:49:10.811773 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_providing_feature_of_parts.sql
[0m03:49:11.284555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDA3EF130>]}
[0m03:49:11.488144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6BC0C40>]}
[0m03:49:11.489446 [info ] [MainThread]: Found 17 models, 9 data tests, 8 sources, 565 macros
[0m03:49:11.490744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6BEC370>]}
[0m03:49:11.493761 [info ] [MainThread]: 
[0m03:49:11.495754 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:49:11.503345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m03:49:11.528898 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m03:49:11.530005 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m03:49:11.530005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:13.125976 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.595 seconds
[0m03:49:13.129952 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m03:49:13.835129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m03:49:13.845172 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m03:49:13.845172 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m03:49:13.846171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:15.152890 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.307 seconds
[0m03:49:15.156317 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m03:49:15.864116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6B3A490>]}
[0m03:49:15.865137 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:49:15.866168 [info ] [MainThread]: 
[0m03:49:15.875482 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m03:49:15.876505 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m03:49:15.876505 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m03:49:15.877995 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m03:49:15.879315 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m03:49:15.880476 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m03:49:15.882622 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m03:49:15.883690 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m03:49:15.881557 [info ] [Thread-1  ]: 1 of 17 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m03:49:15.884740 [info ] [Thread-2  ]: 2 of 17 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m03:49:15.887125 [info ] [Thread-3  ]: 3 of 17 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m03:49:15.888142 [info ] [Thread-4  ]: 4 of 17 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m03:49:15.890136 [info ] [Thread-5  ]: 5 of 17 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m03:49:15.891162 [info ] [Thread-6  ]: 6 of 17 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m03:49:15.893517 [info ] [Thread-7  ]: 7 of 17 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m03:49:15.896622 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m03:49:15.895186 [info ] [Thread-8  ]: 8 of 17 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m03:49:15.898830 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m03:49:15.900046 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m03:49:15.902626 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m03:49:15.904084 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m03:49:15.905206 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m03:49:15.906874 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m03:49:15.907421 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m03:49:15.909050 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m03:49:15.910281 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m03:49:15.911359 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m03:49:15.912449 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m03:49:15.914177 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m03:49:15.915803 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m03:49:15.916956 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m03:49:15.929288 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m03:49:15.931006 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m03:49:15.958137 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m03:49:15.963670 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m03:49:15.967965 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m03:49:15.972341 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m03:49:15.978406 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:49:15.986582 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m03:49:15.988913 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m03:49:15.999188 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m03:49:16.001674 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m03:49:16.003954 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m03:49:16.006142 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m03:49:16.007835 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m03:49:16.009897 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m03:49:16.050387 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m03:49:16.051522 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m03:49:16.057296 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m03:49:16.058431 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m03:49:16.061441 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m03:49:16.067716 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m03:49:16.073764 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m03:49:16.078573 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m03:49:16.083509 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m03:49:16.085787 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m03:49:16.087293 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m03:49:16.091933 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m03:49:16.093384 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m03:49:16.095421 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m03:49:16.097550 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m03:49:16.099558 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m03:49:16.100676 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m03:49:16.101960 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m03:49:16.102999 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m03:49:16.104011 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m03:49:16.105004 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m03:49:16.106006 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m03:49:16.107363 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m03:49:16.108373 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m03:49:16.109376 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m03:49:16.109376 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:49:16.110852 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:49:16.111867 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:49:16.113126 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m03:49:16.113998 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:49:16.114508 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m03:49:16.115016 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m03:49:16.116045 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m03:49:16.126379 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m03:49:17.809007 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.698 seconds
[0m03:49:17.840610 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m03:49:17.856792 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.731 seconds
[0m03:49:17.858800 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m03:49:17.885698 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.774 seconds
[0m03:49:17.889139 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m03:49:17.918521 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.808 seconds
[0m03:49:17.920534 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m03:49:17.962104 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.848 seconds
[0m03:49:17.965115 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m03:49:17.987625 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.871 seconds
[0m03:49:17.991789 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m03:49:17.994062 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.879 seconds
[0m03:49:17.996215 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m03:49:18.012227 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.898 seconds
[0m03:49:18.015322 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m03:49:18.518224 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB89FF10>]}
[0m03:49:18.519963 [info ] [Thread-8  ]: 8 of 17 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 2.61s]
[0m03:49:18.521595 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m03:49:18.524399 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_supplier
[0m03:49:18.526070 [info ] [Thread-10 ]: 9 of 17 START sql table model dbt_schema.dim_supplier .......................... [RUN]
[0m03:49:18.527794 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_supplier'
[0m03:49:18.528840 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_supplier
[0m03:49:18.534394 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m03:49:18.536129 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_supplier
[0m03:49:18.566958 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m03:49:18.570807 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m03:49:18.571860 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB6F7F70>]}
[0m03:49:18.572881 [debug] [Thread-10 ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m03:49:18.575744 [info ] [Thread-2  ]: 2 of 17 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 2.67s]
[0m03:49:18.576765 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m03:49:18.578759 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m03:49:18.583801 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB72CE20>]}
[0m03:49:18.586351 [info ] [Thread-3  ]: 3 of 17 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 2.68s]
[0m03:49:18.588484 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m03:49:18.590497 [debug] [Thread-8  ]: Began running node model.dbtairflow.dim_nation
[0m03:49:18.592502 [info ] [Thread-8  ]: 10 of 17 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m03:49:18.593504 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.dim_nation)
[0m03:49:18.594497 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.dim_nation
[0m03:49:18.600924 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m03:49:18.603336 [debug] [Thread-8  ]: Began executing node model.dbtairflow.dim_nation
[0m03:49:18.605345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB91B730>]}
[0m03:49:18.611581 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m03:49:18.612587 [info ] [Thread-1  ]: 1 of 17 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 2.71s]
[0m03:49:18.614609 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m03:49:18.615839 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m03:49:18.618334 [debug] [Thread-8  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m03:49:18.618334 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_customer
[0m03:49:18.620556 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m03:49:18.621566 [info ] [Thread-2  ]: 11 of 17 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m03:49:18.627308 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_customer)
[0m03:49:18.630298 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_customer
[0m03:49:18.636304 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m03:49:18.638301 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_customer
[0m03:49:18.646969 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m03:49:18.649550 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m03:49:18.650566 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB733CA0>]}
[0m03:49:18.652562 [debug] [Thread-2  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m03:49:18.653561 [info ] [Thread-4  ]: 4 of 17 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 2.75s]
[0m03:49:18.654560 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:49:18.656070 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m03:49:18.662965 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_orders
[0m03:49:18.665483 [debug] [Thread-1  ]: Began running node model.dbtairflow.fct_orders
[0m03:49:18.667485 [info ] [Thread-9  ]: 12 of 17 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m03:49:18.669476 [info ] [Thread-1  ]: 13 of 17 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m03:49:18.672478 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_orders'
[0m03:49:18.673529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.fct_orders)
[0m03:49:18.676159 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_orders
[0m03:49:18.677176 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.fct_orders
[0m03:49:18.684785 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m03:49:18.694071 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m03:49:18.697576 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_orders
[0m03:49:18.699589 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB733DF0>]}
[0m03:49:18.806392 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m03:49:18.806392 [debug] [Thread-1  ]: Began executing node model.dbtairflow.fct_orders
[0m03:49:18.810519 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8D28B0>]}
[0m03:49:18.809453 [info ] [Thread-6  ]: 6 of 17 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 2.79s]
[0m03:49:18.815288 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m03:49:18.816301 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8DF970>]}
[0m03:49:18.817301 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m03:49:18.819304 [info ] [Thread-5  ]: 5 of 17 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 2.91s]
[0m03:49:18.820307 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m03:49:18.821305 [info ] [Thread-7  ]: 7 of 17 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 2.91s]
[0m03:49:18.825197 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m03:49:18.825197 [debug] [Thread-9  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m03:49:18.827224 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m03:49:18.829231 [debug] [Thread-4  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m03:49:18.829231 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m03:49:18.830234 [debug] [Thread-1  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m03:49:18.832692 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m03:49:18.833692 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_part
[0m03:49:18.834699 [debug] [Thread-3  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:49:18.834699 [info ] [Thread-4  ]: 14 of 17 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m03:49:18.837525 [debug] [Thread-5  ]: Began running node model.dbtairflow.dim_region
[0m03:49:18.837525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:49:18.842445 [info ] [Thread-6  ]: 15 of 17 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m03:49:18.843917 [info ] [Thread-3  ]: 16 of 17 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m03:49:18.846148 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.fact_ability_of_supplier)
[0m03:49:18.848303 [info ] [Thread-5  ]: 17 of 17 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m03:49:18.852505 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_part)
[0m03:49:18.853515 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fact_providing_feature_of_parts)
[0m03:49:18.854794 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m03:49:18.855806 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.dim_region)
[0m03:49:18.856826 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_part
[0m03:49:18.858286 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m03:49:18.863917 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:49:18.864959 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.dim_region
[0m03:49:18.870161 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m03:49:18.875431 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:49:18.876485 [debug] [Thread-4  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m03:49:18.881492 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m03:49:18.883485 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_part
[0m03:49:18.889807 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m03:49:18.890820 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m03:49:18.896094 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m03:49:18.897093 [debug] [Thread-5  ]: Began executing node model.dbtairflow.dim_region
[0m03:49:18.901472 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:49:18.902482 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m03:49:18.907493 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m03:49:18.909652 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m03:49:18.911650 [debug] [Thread-4  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final as (
    select
        sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by
        sup.suppkey
)

select
    *
from
    final
        );
[0m03:49:18.914194 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m03:49:18.915208 [debug] [Thread-6  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m03:49:18.916421 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m03:49:18.916421 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:49:18.918430 [debug] [Thread-3  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final as (
    select
        part.part_key,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_part as part
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by
        part.part_key
)

select
    *
from
    final
        );
[0m03:49:18.918430 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m03:49:18.919818 [debug] [Thread-5  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m03:49:18.923752 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:49:18.928367 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m03:49:20.904262 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.284 seconds
[0m03:49:20.907263 [debug] [Thread-8  ]: On model.dbtairflow.dim_nation: Close
[0m03:49:21.183164 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.606 seconds
[0m03:49:21.186707 [debug] [Thread-10 ]: On model.dbtairflow.dim_supplier: Close
[0m03:49:21.442578 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.515 seconds
[0m03:49:21.445620 [debug] [Thread-5  ]: On model.dbtairflow.dim_region: Close
[0m03:49:21.598710 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB717430>]}
[0m03:49:21.600512 [info ] [Thread-8  ]: 10 of 17 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.01s]
[0m03:49:21.602148 [debug] [Thread-8  ]: Finished running node model.dbtairflow.dim_nation
[0m03:49:21.654229 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.823 seconds
[0m03:49:21.656985 [debug] [Thread-9  ]: On model.dbtairflow.dim_orders: Close
[0m03:49:21.663130 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.008 seconds
[0m03:49:21.665881 [debug] [Thread-2  ]: On model.dbtairflow.dim_customer: Close
[0m03:49:21.685893 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.769 seconds
[0m03:49:21.688439 [debug] [Thread-4  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m03:49:21.857825 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8D2E20>]}
[0m03:49:21.858960 [info ] [Thread-10 ]: 9 of 17 OK created sql table model dbt_schema.dim_supplier ..................... [[32mSUCCESS 1[0m in 3.33s]
[0m03:49:21.860438 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_supplier
[0m03:49:21.910756 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.991 seconds
[0m03:49:21.912785 [debug] [Thread-6  ]: On model.dbtairflow.dim_part: Close
[0m03:49:22.105323 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8A76D0>]}
[0m03:49:22.106324 [info ] [Thread-5  ]: 17 of 17 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 3.25s]
[0m03:49:22.108320 [debug] [Thread-5  ]: Finished running node model.dbtairflow.dim_region
[0m03:49:22.318628 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB9B3CD0>]}
[0m03:49:22.319635 [info ] [Thread-9  ]: 12 of 17 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 3.65s]
[0m03:49:22.321641 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_orders
[0m03:49:22.383316 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB980EB0>]}
[0m03:49:22.384331 [info ] [Thread-2  ]: 11 of 17 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 3.76s]
[0m03:49:22.387738 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_customer
[0m03:49:22.391218 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD8CF2CD0>]}
[0m03:49:22.392737 [info ] [Thread-4  ]: 14 of 17 OK created sql table model dbt_schema.fact_ability_of_supplier ........ [[32mSUCCESS 1[0m in 3.55s]
[0m03:49:22.394741 [debug] [Thread-4  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m03:49:22.460990 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.538 seconds
[0m03:49:22.463986 [debug] [Thread-3  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m03:49:22.619269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.782 seconds
[0m03:49:22.622469 [debug] [Thread-1  ]: On model.dbtairflow.fct_orders: Close
[0m03:49:22.622469 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB741D30>]}
[0m03:49:22.626965 [info ] [Thread-6  ]: 15 of 17 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 3.77s]
[0m03:49:22.629643 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_part
[0m03:49:23.317018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8F4910>]}
[0m03:49:23.318025 [info ] [Thread-1  ]: 13 of 17 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 4.64s]
[0m03:49:23.319019 [debug] [Thread-1  ]: Finished running node model.dbtairflow.fct_orders
[0m03:49:23.593960 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b188858-3a67-44f5-836d-c8e3886fabf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDB8A21C0>]}
[0m03:49:23.595266 [info ] [Thread-3  ]: 16 of 17 OK created sql table model dbt_schema.fact_providing_feature_of_parts . [[32mSUCCESS 1[0m in 4.74s]
[0m03:49:23.597294 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m03:49:23.599934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:23.599934 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m03:49:23.600945 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m03:49:23.601929 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m03:49:23.602941 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m03:49:23.603928 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m03:49:23.604931 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m03:49:23.604931 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m03:49:23.605929 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m03:49:23.607020 [debug] [MainThread]: Connection 'model.dbtairflow.stg_tpch_region' was properly closed.
[0m03:49:23.607528 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m03:49:23.608535 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m03:49:23.609552 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m03:49:23.610559 [info ] [MainThread]: 
[0m03:49:23.612556 [info ] [MainThread]: Finished running 8 view models, 9 table models in 0 hours 0 minutes and 12.11 seconds (12.11s).
[0m03:49:23.618064 [debug] [MainThread]: Command end result
[0m03:49:23.670163 [info ] [MainThread]: 
[0m03:49:23.672165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:49:23.673166 [info ] [MainThread]: 
[0m03:49:23.673166 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m03:49:23.675158 [debug] [MainThread]: Command `dbt run` succeeded at 03:49:23.675158 after 13.88 seconds
[0m03:49:23.676158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD66982E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD8CE3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDA37A130>]}
[0m03:49:23.676158 [debug] [MainThread]: Flushing usage events
[0m04:09:45.348041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206406282E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064313DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064313DFA0>]}


============================== 04:09:45.355511 | cadeae2c-3f95-4ce7-99b1-e83a34397b48 ==============================
[0m04:09:45.355511 [info ] [MainThread]: Running with dbt=1.8.5
[0m04:09:45.356525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:09:46.172850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064311D430>]}
[0m04:09:46.238654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020642FD34F0>]}
[0m04:09:46.242065 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:09:46.273686 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m04:09:46.660299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m04:09:46.660299 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\fact_line_item_ship.sql
[0m04:09:46.661302 [debug] [MainThread]: Partial parsing: added file: dbtairflow://models\marts\fact_line_item_properties.sql
[0m04:09:46.662303 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\staging\stg_tpch_line_items.sql
[0m04:09:47.086233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064531F130>]}
[0m04:09:47.282603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064532CEB0>]}
[0m04:09:47.283617 [info ] [MainThread]: Found 19 models, 9 data tests, 8 sources, 565 macros
[0m04:09:47.284608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020645358C70>]}
[0m04:09:47.287643 [info ] [MainThread]: 
[0m04:09:47.288645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:09:47.297556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m04:09:47.312307 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m04:09:47.313328 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m04:09:47.313328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:09:48.995050 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.681 seconds
[0m04:09:48.998678 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m04:09:49.728176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m04:09:49.826658 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m04:09:49.832043 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m04:09:49.837638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:09:52.053878 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 2.217 seconds
[0m04:09:52.056669 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m04:09:52.884150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020640ACBE50>]}
[0m04:09:52.885566 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m04:09:52.887024 [info ] [MainThread]: 
[0m04:09:52.897811 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m04:09:52.898805 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m04:09:52.899814 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m04:09:52.899814 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m04:09:52.900807 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m04:09:52.902826 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m04:09:52.905808 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m04:09:52.906810 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m04:09:52.903814 [info ] [Thread-1  ]: 1 of 19 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m04:09:52.907814 [info ] [Thread-2  ]: 2 of 19 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m04:09:52.909180 [info ] [Thread-3  ]: 3 of 19 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m04:09:52.911689 [info ] [Thread-4  ]: 4 of 19 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m04:09:52.912726 [info ] [Thread-5  ]: 5 of 19 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m04:09:52.914139 [info ] [Thread-6  ]: 6 of 19 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m04:09:52.915528 [info ] [Thread-7  ]: 7 of 19 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m04:09:52.918907 [info ] [Thread-8  ]: 8 of 19 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m04:09:52.921361 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m04:09:52.923907 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m04:09:52.925282 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m04:09:52.926756 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m04:09:52.928258 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m04:09:52.930931 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m04:09:52.934304 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m04:09:52.936392 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m04:09:52.937395 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m04:09:52.938831 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m04:09:52.940107 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m04:09:52.942325 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m04:09:52.943322 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m04:09:52.944782 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m04:09:52.947183 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m04:09:52.948636 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m04:09:52.963414 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m04:09:52.969440 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m04:09:52.974685 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m04:09:52.978850 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m04:09:52.983889 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m04:09:52.989861 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:09:52.994939 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m04:09:52.999050 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m04:09:53.002106 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m04:09:53.003124 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m04:09:53.004125 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m04:09:53.006124 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m04:09:53.007128 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m04:09:53.008128 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m04:09:53.009196 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m04:09:53.050006 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m04:09:53.051462 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m04:09:53.056676 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m04:09:53.062655 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m04:09:53.070686 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m04:09:53.077684 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m04:09:53.084758 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:09:53.093012 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m04:09:53.099056 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m04:09:53.103039 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m04:09:53.106416 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m04:09:53.108880 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m04:09:53.109897 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m04:09:53.112819 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m04:09:53.114839 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m04:09:53.117304 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m04:09:53.118334 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m04:09:53.120326 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m04:09:53.122319 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(L_ORDERKEY as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(L_LINENUMBER as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
    L_COMMITDATE as commit_date,
    L_DISCOUNT as discount,
    L_EXTENDEDPRICE as extended_price,
    L_LINENUMBER as line_number,
    L_LINESTATUS as line_status,
    L_ORDERKEY as order_key,
    L_PARTKEY as part_key,
    L_QUANTITY as quantity,
    L_RECEIPTDATE as receipt_date,
    L_RETURNFLAG as return_flag,
    L_SHIPDATE as ship_date,
    L_SHIPINSTRUCT as ship_instruct,
    L_SHIPMODE as ship_mode,
    L_SUPPKEY as supp_key,
    L_TAX as tax
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m04:09:53.124323 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m04:09:53.125319 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m04:09:53.126467 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m04:09:53.127923 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m04:09:53.131716 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m04:09:53.132731 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m04:09:53.135117 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m04:09:53.136509 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:09:53.137524 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:09:53.138529 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m04:09:53.139992 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:09:53.141387 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m04:09:53.142648 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m04:09:53.147650 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m04:09:55.421945 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.278 seconds
[0m04:09:55.423934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.291 seconds
[0m04:09:55.480110 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m04:09:55.484119 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m04:09:55.558687 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.417 seconds
[0m04:09:55.564207 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m04:09:55.573579 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.426 seconds
[0m04:09:55.577836 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.440 seconds
[0m04:09:55.580027 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.439 seconds
[0m04:09:55.582069 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.445 seconds
[0m04:09:55.588059 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m04:09:55.590059 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.451 seconds
[0m04:09:55.595576 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m04:09:55.601944 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m04:09:55.607436 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m04:09:55.615020 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m04:09:56.469593 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456C13D0>]}
[0m04:09:56.473413 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D7940>]}
[0m04:09:56.475426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D73A0>]}
[0m04:09:56.477831 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456C1D30>]}
[0m04:09:56.481219 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D7E20>]}
[0m04:09:56.483232 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D76D0>]}
[0m04:09:56.484497 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D7370>]}
[0m04:09:56.485982 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D7BB0>]}
[0m04:09:56.488476 [info ] [Thread-7  ]: 7 of 19 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 3.53s]
[0m04:09:56.491696 [info ] [Thread-4  ]: 4 of 19 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 3.55s]
[0m04:09:56.494696 [info ] [Thread-1  ]: 1 of 19 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 3.55s]
[0m04:09:56.497224 [info ] [Thread-8  ]: 8 of 19 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 3.54s]
[0m04:09:56.499768 [info ] [Thread-6  ]: 6 of 19 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 3.55s]
[0m04:09:56.502789 [info ] [Thread-3  ]: 3 of 19 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 3.56s]
[0m04:09:56.504786 [info ] [Thread-2  ]: 2 of 19 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 3.56s]
[0m04:09:56.508266 [info ] [Thread-5  ]: 5 of 19 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 3.56s]
[0m04:09:56.510638 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m04:09:56.512654 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m04:09:56.515352 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m04:09:56.517729 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m04:09:56.520804 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m04:09:56.522722 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m04:09:56.525727 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m04:09:56.527867 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m04:09:56.530886 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_region
[0m04:09:56.532396 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_orders
[0m04:09:56.535999 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_customer
[0m04:09:56.537998 [debug] [Thread-1  ]: Began running node model.dbtairflow.dim_supplier
[0m04:09:56.538999 [debug] [Thread-8  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m04:09:56.541371 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_nation
[0m04:09:56.544032 [debug] [Thread-3  ]: Began running node model.dbtairflow.fact_line_item_properties
[0m04:09:56.546265 [debug] [Thread-6  ]: Began running node model.dbtairflow.fact_line_item_ship
[0m04:09:56.547442 [debug] [Thread-5  ]: Began running node model.dbtairflow.fct_orders
[0m04:09:56.549459 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_part
[0m04:09:56.551820 [info ] [Thread-10 ]: 9 of 19 START sql table model dbt_schema.dim_region ............................ [RUN]
[0m04:09:56.553817 [info ] [Thread-7  ]: 10 of 19 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m04:09:56.555822 [info ] [Thread-4  ]: 11 of 19 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m04:09:56.559190 [info ] [Thread-1  ]: 12 of 19 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m04:09:56.561192 [info ] [Thread-8  ]: 13 of 19 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m04:09:56.562692 [info ] [Thread-9  ]: 14 of 19 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m04:09:56.565217 [info ] [Thread-3  ]: 15 of 19 START sql table model dbt_schema.fact_line_item_properties ............ [RUN]
[0m04:09:56.569514 [info ] [Thread-6  ]: 16 of 19 START sql table model dbt_schema.fact_line_item_ship .................. [RUN]
[0m04:09:56.571512 [info ] [Thread-5  ]: 17 of 19 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m04:09:56.573574 [info ] [Thread-2  ]: 18 of 19 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m04:09:56.576344 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_region'
[0m04:09:56.577395 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_orders)
[0m04:09:56.579663 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_customer)
[0m04:09:56.581700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.dim_supplier)
[0m04:09:56.584114 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.fact_ability_of_supplier)
[0m04:09:56.586540 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_nation'
[0m04:09:56.588562 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fact_line_item_properties)
[0m04:09:56.590561 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.fact_line_item_ship)
[0m04:09:56.591561 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.fct_orders)
[0m04:09:56.593563 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_part)
[0m04:09:56.595561 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_region
[0m04:09:56.597561 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_orders
[0m04:09:56.599085 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_customer
[0m04:09:56.600090 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.dim_supplier
[0m04:09:56.602579 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m04:09:56.604579 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_nation
[0m04:09:56.606903 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fact_line_item_properties
[0m04:09:56.608303 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.fact_line_item_ship
[0m04:09:56.610321 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fct_orders
[0m04:09:56.611321 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_part
[0m04:09:56.618761 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m04:09:56.627635 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m04:09:56.635643 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m04:09:56.642147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m04:09:56.648147 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:09:56.655109 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m04:09:56.663516 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_properties"
[0m04:09:56.672264 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_ship"
[0m04:09:56.769262 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m04:09:56.776712 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m04:09:56.779712 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_region
[0m04:09:56.783135 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_orders
[0m04:09:56.788923 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_customer
[0m04:09:56.791725 [debug] [Thread-8  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m04:09:56.794866 [debug] [Thread-1  ]: Began executing node model.dbtairflow.dim_supplier
[0m04:09:56.797797 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_nation
[0m04:09:56.799736 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fact_line_item_properties
[0m04:09:56.802498 [debug] [Thread-6  ]: Began executing node model.dbtairflow.fact_line_item_ship
[0m04:09:56.804499 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fct_orders
[0m04:09:56.847465 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_part
[0m04:09:56.906514 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m04:09:56.914789 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m04:09:56.927013 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m04:09:56.935727 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:09:56.944790 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m04:09:56.953630 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m04:09:56.962497 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_properties"
[0m04:09:56.971754 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_ship"
[0m04:09:56.979815 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m04:09:56.988250 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m04:09:56.991515 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m04:09:56.993770 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m04:09:56.997166 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m04:09:57.001938 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m04:09:57.004291 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m04:09:57.006449 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m04:09:57.011391 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fact_line_item_properties"
[0m04:09:57.015597 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.fact_line_item_ship"
[0m04:09:57.021289 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m04:09:57.022957 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m04:09:57.025223 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m04:09:57.026369 [debug] [Thread-7  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m04:09:57.027987 [debug] [Thread-4  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m04:09:57.029630 [debug] [Thread-8  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final as (
    select
        sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by
        sup.suppkey
)

select
    *
from
    final
        );
[0m04:09:57.031321 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m04:09:57.032510 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m04:09:57.034385 [debug] [Thread-3  ]: On model.dbtairflow.fact_line_item_properties: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_properties"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_properties
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        commit_date,
        receipt_date,
        return_flag,
        ship_date,
        ship_instruct,
        ship_mode
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    final
        );
[0m04:09:57.036098 [debug] [Thread-6  ]: On model.dbtairflow.fact_line_item_ship: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_ship"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_ship
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        discount,
        extended_price,
        line_number,
        line_status,
        quantity,
        tax
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    fina
        );
[0m04:09:57.037200 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m04:09:57.038696 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m04:09:57.040038 [debug] [Thread-2  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m04:09:57.041533 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m04:09:57.042688 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m04:09:57.043695 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m04:09:57.045197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:09:57.046740 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m04:09:57.047291 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:09:57.048774 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m04:09:57.050935 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m04:09:57.054288 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:09:59.758391 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01b6a336-0001-3c91-0002-0e420003f0ea
[0m04:09:59.759406 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01b6a336-0001-3c0b-0002-0e42000400ea
[0m04:09:59.761769 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 37
invalid identifier 'LINE_ITEM.DISCOUNT_PERCENTAGE'
[0m04:09:59.762791 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINA' does not exist or not authorized.
[0m04:09:59.765186 [debug] [Thread-5  ]: On model.dbtairflow.fct_orders: Close
[0m04:09:59.767204 [debug] [Thread-6  ]: On model.dbtairflow.fact_line_item_ship: Close
[0m04:10:00.559022 [debug] [Thread-5  ]: Database Error in model fct_orders (models\marts\fct_orders.sql)
  000904 (42000): SQL compilation error: error line 13 at position 37
  invalid identifier 'LINE_ITEM.DISCOUNT_PERCENTAGE'
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m04:10:00.561243 [debug] [Thread-6  ]: Database Error in model fact_line_item_ship (models\marts\fact_line_item_ship.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINA' does not exist or not authorized.
  compiled Code at target\run\dbtairflow\models\marts\fact_line_item_ship.sql
[0m04:10:00.562223 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020645833DC0>]}
[0m04:10:00.563540 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206457683A0>]}
[0m04:10:00.566063 [error] [Thread-5  ]: 17 of 19 ERROR creating sql table model dbt_schema.fct_orders .................. [[31mERROR[0m in 3.97s]
[0m04:10:00.567548 [error] [Thread-6  ]: 16 of 19 ERROR creating sql table model dbt_schema.fact_line_item_ship ......... [[31mERROR[0m in 3.97s]
[0m04:10:00.570230 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fct_orders
[0m04:10:00.571495 [debug] [Thread-6  ]: Finished running node model.dbtairflow.fact_line_item_ship
[0m04:10:00.572536 [debug] [Thread-5  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:10:00.575525 [info ] [Thread-5  ]: 19 of 19 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m04:10:00.577550 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.fct_orders, now model.dbtairflow.fact_providing_feature_of_parts)
[0m04:10:00.578544 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m04:10:00.588692 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:10:00.591803 [debug] [Thread-5  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m04:10:00.599189 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:10:00.602993 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:10:00.604019 [debug] [Thread-5  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final as (
    select
        part.part_key,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_part as part
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by
        part.part_key
)

select
    *
from
    final
        );
[0m04:10:00.605006 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m04:10:00.856409 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.818 seconds
[0m04:10:00.861241 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: Close
[0m04:10:00.867977 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.822 seconds
[0m04:10:00.874199 [debug] [Thread-9  ]: On model.dbtairflow.dim_nation: Close
[0m04:10:01.070934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.025 seconds
[0m04:10:01.075393 [debug] [Thread-1  ]: On model.dbtairflow.dim_supplier: Close
[0m04:10:01.187779 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.133 seconds
[0m04:10:01.189792 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.145 seconds
[0m04:10:01.193331 [debug] [Thread-2  ]: On model.dbtairflow.dim_part: Close
[0m04:10:01.196857 [debug] [Thread-8  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m04:10:01.390027 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.348 seconds
[0m04:10:01.397022 [debug] [Thread-7  ]: On model.dbtairflow.dim_orders: Close
[0m04:10:01.402035 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.359 seconds
[0m04:10:01.413125 [debug] [Thread-4  ]: On model.dbtairflow.dim_customer: Close
[0m04:10:01.695677 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206456D7850>]}
[0m04:10:01.697674 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020645833BE0>]}
[0m04:10:01.701667 [info ] [Thread-9  ]: 14 of 19 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 5.11s]
[0m04:10:01.705210 [info ] [Thread-10 ]: 9 of 19 OK created sql table model dbt_schema.dim_region ....................... [[32mSUCCESS 1[0m in 5.12s]
[0m04:10:01.708212 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_nation
[0m04:10:01.710212 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_region
[0m04:10:01.789299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064545D6A0>]}
[0m04:10:01.791336 [info ] [Thread-1  ]: 12 of 19 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 5.21s]
[0m04:10:01.793593 [debug] [Thread-1  ]: Finished running node model.dbtairflow.dim_supplier
[0m04:10:02.092991 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064424EDF0>]}
[0m04:10:02.094455 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064586E490>]}
[0m04:10:02.096474 [info ] [Thread-8  ]: 13 of 19 OK created sql table model dbt_schema.fact_ability_of_supplier ........ [[32mSUCCESS 1[0m in 5.51s]
[0m04:10:02.098473 [info ] [Thread-2  ]: 18 of 19 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 5.50s]
[0m04:10:02.100714 [debug] [Thread-8  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m04:10:02.103733 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_part
[0m04:10:02.192357 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064423C160>]}
[0m04:10:02.193380 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020643F2EA60>]}
[0m04:10:02.195368 [info ] [Thread-7  ]: 10 of 19 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 5.61s]
[0m04:10:02.197364 [info ] [Thread-4  ]: 11 of 19 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 5.61s]
[0m04:10:02.200584 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_orders
[0m04:10:02.202591 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_customer
[0m04:10:03.736251 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.131 seconds
[0m04:10:03.740897 [debug] [Thread-5  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m04:10:04.662076 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064570C190>]}
[0m04:10:04.664084 [info ] [Thread-5  ]: 19 of 19 OK created sql table model dbt_schema.fact_providing_feature_of_parts . [[32mSUCCESS 1[0m in 4.08s]
[0m04:10:04.666118 [debug] [Thread-5  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:10:08.345477 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 11.298 seconds
[0m04:10:08.349471 [debug] [Thread-3  ]: On model.dbtairflow.fact_line_item_properties: Close
[0m04:10:09.160252 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadeae2c-3f95-4ce7-99b1-e83a34397b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206442539D0>]}
[0m04:10:09.162454 [info ] [Thread-3  ]: 15 of 19 OK created sql table model dbt_schema.fact_line_item_properties ....... [[32mSUCCESS 1[0m in 12.57s]
[0m04:10:09.164419 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fact_line_item_properties
[0m04:10:09.175418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:10:09.176440 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m04:10:09.178441 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m04:10:09.179437 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m04:10:09.180436 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m04:10:09.181440 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_properties' was properly closed.
[0m04:10:09.182436 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m04:10:09.183435 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m04:10:09.184435 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_ship' was properly closed.
[0m04:10:09.184435 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m04:10:09.185435 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m04:10:09.186435 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m04:10:09.187437 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m04:10:09.188436 [info ] [MainThread]: 
[0m04:10:09.190524 [info ] [MainThread]: Finished running 8 view models, 11 table models in 0 hours 0 minutes and 21.90 seconds (21.90s).
[0m04:10:09.197869 [debug] [MainThread]: Command end result
[0m04:10:09.301314 [info ] [MainThread]: 
[0m04:10:09.302318 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:10:09.304387 [info ] [MainThread]: 
[0m04:10:09.310875 [error] [MainThread]:   Database Error in model fct_orders (models\marts\fct_orders.sql)
  000904 (42000): SQL compilation error: error line 13 at position 37
  invalid identifier 'LINE_ITEM.DISCOUNT_PERCENTAGE'
  compiled Code at target\run\dbtairflow\models\marts\fct_orders.sql
[0m04:10:09.313667 [info ] [MainThread]: 
[0m04:10:09.315686 [error] [MainThread]:   Database Error in model fact_line_item_ship (models\marts\fact_line_item_ship.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINA' does not exist or not authorized.
  compiled Code at target\run\dbtairflow\models\marts\fact_line_item_ship.sql
[0m04:10:09.317690 [info ] [MainThread]: 
[0m04:10:09.319217 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=2 SKIP=0 TOTAL=19
[0m04:10:09.322797 [debug] [MainThread]: Command `dbt run` failed at 04:10:09.322797 after 24.06 seconds
[0m04:10:09.323788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206406282E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020642FD34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020643F235B0>]}
[0m04:10:09.325779 [debug] [MainThread]: Flushing usage events
[0m04:11:16.620720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028776DB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287798CCC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287798CCFA0>]}


============================== 04:11:16.630718 | ea2a446d-a953-4078-9fd4-1b1431c27f08 ==============================
[0m04:11:16.630718 [info ] [MainThread]: Running with dbt=1.8.5
[0m04:11:16.632717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:11:17.431092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287798B1430>]}
[0m04:11:17.504365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287797624F0>]}
[0m04:11:17.506609 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:11:17.534073 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m04:11:17.867809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:11:17.870145 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\staging\stg_tpch_line_items.sql
[0m04:11:17.871278 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_line_item_ship.sql
[0m04:11:18.369191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877AAD7130>]}
[0m04:11:18.632753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877AAE36D0>]}
[0m04:11:18.633756 [info ] [MainThread]: Found 19 models, 9 data tests, 8 sources, 565 macros
[0m04:11:18.634762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877A9DA0D0>]}
[0m04:11:18.637813 [info ] [MainThread]: 
[0m04:11:18.639789 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:11:18.649475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m04:11:18.666475 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m04:11:18.667476 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m04:11:18.668476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:20.629976 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.962 seconds
[0m04:11:20.633193 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m04:11:21.451760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m04:11:21.468859 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m04:11:21.469860 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m04:11:21.469860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:23.205415 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.735 seconds
[0m04:11:23.209966 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m04:11:24.013422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877A593CA0>]}
[0m04:11:24.014446 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m04:11:24.015608 [info ] [MainThread]: 
[0m04:11:24.022121 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m04:11:24.023354 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m04:11:24.023354 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m04:11:24.024377 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m04:11:24.024377 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m04:11:24.025715 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m04:11:24.027005 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m04:11:24.028015 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m04:11:24.028015 [info ] [Thread-1  ]: 1 of 19 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m04:11:24.030018 [info ] [Thread-2  ]: 2 of 19 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m04:11:24.031730 [info ] [Thread-3  ]: 3 of 19 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m04:11:24.033125 [info ] [Thread-4  ]: 4 of 19 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m04:11:24.036882 [info ] [Thread-5  ]: 5 of 19 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m04:11:24.038329 [info ] [Thread-6  ]: 6 of 19 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m04:11:24.041499 [info ] [Thread-7  ]: 7 of 19 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m04:11:24.044008 [info ] [Thread-8  ]: 8 of 19 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m04:11:24.046158 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m04:11:24.047780 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m04:11:24.048879 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m04:11:24.050494 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m04:11:24.051049 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m04:11:24.052538 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m04:11:24.054018 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m04:11:24.055003 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m04:11:24.056427 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m04:11:24.057445 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m04:11:24.059909 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m04:11:24.059909 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m04:11:24.061304 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m04:11:24.062410 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m04:11:24.065123 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m04:11:24.067397 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m04:11:24.084240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m04:11:24.091252 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m04:11:24.098874 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m04:11:24.105265 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m04:11:24.113153 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m04:11:24.120161 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:11:24.125165 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m04:11:24.130703 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m04:11:24.132704 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m04:11:24.133719 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m04:11:24.135166 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m04:11:24.136509 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m04:11:24.137896 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m04:11:24.139387 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m04:11:24.140544 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m04:11:24.181045 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m04:11:24.182083 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m04:11:24.187055 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m04:11:24.193667 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m04:11:24.202856 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m04:11:24.209481 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m04:11:24.215204 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:11:24.220759 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m04:11:24.225779 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m04:11:24.229602 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m04:11:24.232252 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m04:11:24.233455 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m04:11:24.236112 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m04:11:24.237146 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m04:11:24.240130 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m04:11:24.241157 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m04:11:24.242173 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m04:11:24.243937 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m04:11:24.245434 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(L_ORDERKEY as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(L_LINENUMBER as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
    L_COMMITDATE as commit_date,
    L_DISCOUNT as discount_percentage,
    L_EXTENDEDPRICE as extended_price,
    L_LINENUMBER as line_number,
    L_LINESTATUS as line_status,
    L_ORDERKEY as order_key,
    L_PARTKEY as part_key,
    L_QUANTITY as quantity,
    L_RECEIPTDATE as receipt_date,
    L_RETURNFLAG as return_flag,
    L_SHIPDATE as ship_date,
    L_SHIPINSTRUCT as ship_instruct,
    L_SHIPMODE as ship_mode,
    L_SUPPKEY as supp_key,
    L_TAX as tax
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m04:11:24.246469 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m04:11:24.247892 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m04:11:24.247892 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m04:11:24.249211 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m04:11:24.250256 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m04:11:24.251664 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m04:11:24.252755 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m04:11:24.252755 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:11:24.253777 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:11:24.254768 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:11:24.255777 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m04:11:24.256779 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m04:11:24.257789 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m04:11:24.263263 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m04:11:26.479192 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.221 seconds
[0m04:11:26.528913 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m04:11:26.531917 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.275 seconds
[0m04:11:26.535452 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.280 seconds
[0m04:11:26.540457 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m04:11:26.546451 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m04:11:26.669579 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.417 seconds
[0m04:11:26.674576 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m04:11:26.773570 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.519 seconds
[0m04:11:26.774587 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.519 seconds
[0m04:11:26.776490 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.525 seconds
[0m04:11:26.780890 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m04:11:26.784544 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m04:11:26.789384 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m04:11:27.396872 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.134 seconds
[0m04:11:27.400387 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE50910>]}
[0m04:11:27.405413 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m04:11:27.406593 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE509D0>]}
[0m04:11:27.408124 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE503D0>]}
[0m04:11:27.409142 [info ] [Thread-6  ]: 6 of 19 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 3.35s]
[0m04:11:27.413148 [info ] [Thread-7  ]: 7 of 19 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 3.35s]
[0m04:11:27.416758 [info ] [Thread-4  ]: 4 of 19 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 3.36s]
[0m04:11:27.420776 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m04:11:27.422785 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m04:11:27.424788 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m04:11:27.427786 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_region
[0m04:11:27.429783 [debug] [Thread-6  ]: Began running node model.dbtairflow.dim_orders
[0m04:11:27.430786 [info ] [Thread-10 ]: 9 of 19 START sql table model dbt_schema.dim_region ............................ [RUN]
[0m04:11:27.432901 [info ] [Thread-6  ]: 10 of 19 START sql table model dbt_schema.dim_orders ........................... [RUN]
[0m04:11:27.434916 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_region'
[0m04:11:27.435913 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.dim_orders)
[0m04:11:27.436915 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_region
[0m04:11:27.437911 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.dim_orders
[0m04:11:27.445911 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m04:11:27.452945 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m04:11:27.454951 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_region
[0m04:11:27.469013 [debug] [Thread-6  ]: Began executing node model.dbtairflow.dim_orders
[0m04:11:27.492553 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m04:11:27.496920 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m04:11:27.498926 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m04:11:27.501390 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m04:11:27.502400 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m04:11:27.502400 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m04:11:27.504405 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m04:11:27.505401 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m04:11:27.696711 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE50D90>]}
[0m04:11:27.696711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE50E20>]}
[0m04:11:27.698114 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE3E190>]}
[0m04:11:27.699153 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE32040>]}
[0m04:11:27.700346 [info ] [Thread-5  ]: 5 of 19 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 3.64s]
[0m04:11:27.701869 [info ] [Thread-1  ]: 1 of 19 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 3.65s]
[0m04:11:27.703282 [info ] [Thread-2  ]: 2 of 19 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 3.65s]
[0m04:11:27.705713 [info ] [Thread-3  ]: 3 of 19 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 3.65s]
[0m04:11:27.708110 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m04:11:27.709133 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m04:11:27.711128 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m04:11:27.712131 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m04:11:27.714128 [debug] [Thread-9  ]: Began running node model.dbtairflow.dim_part
[0m04:11:27.715125 [debug] [Thread-4  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:11:27.717186 [debug] [Thread-5  ]: Began running node model.dbtairflow.dim_customer
[0m04:11:27.718508 [debug] [Thread-1  ]: Began running node model.dbtairflow.fact_line_item_properties
[0m04:11:27.719940 [debug] [Thread-3  ]: Began running node model.dbtairflow.fact_line_item_ship
[0m04:11:27.720961 [debug] [Thread-7  ]: Began running node model.dbtairflow.fct_orders
[0m04:11:27.722427 [debug] [Thread-2  ]: Began running node model.dbtairflow.dim_nation
[0m04:11:27.723535 [info ] [Thread-9  ]: 11 of 19 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m04:11:27.724557 [info ] [Thread-4  ]: 12 of 19 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m04:11:27.726867 [info ] [Thread-5  ]: 13 of 19 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m04:11:27.727876 [info ] [Thread-1  ]: 14 of 19 START sql table model dbt_schema.fact_line_item_properties ............ [RUN]
[0m04:11:27.728946 [info ] [Thread-3  ]: 15 of 19 START sql table model dbt_schema.fact_line_item_ship .................. [RUN]
[0m04:11:27.730187 [info ] [Thread-7  ]: 16 of 19 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m04:11:27.732038 [info ] [Thread-2  ]: 17 of 19 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m04:11:27.733723 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.dim_part'
[0m04:11:27.735795 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.fact_providing_feature_of_parts)
[0m04:11:27.736818 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.dim_customer)
[0m04:11:27.738810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.fact_line_item_properties)
[0m04:11:27.739826 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fact_line_item_ship)
[0m04:11:27.740815 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.fct_orders)
[0m04:11:27.742300 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.dim_nation)
[0m04:11:27.743309 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.dim_part
[0m04:11:27.743309 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m04:11:27.745626 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.dim_customer
[0m04:11:27.746814 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.fact_line_item_properties
[0m04:11:27.747824 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fact_line_item_ship
[0m04:11:27.747824 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.fct_orders
[0m04:11:27.750191 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.dim_nation
[0m04:11:27.754230 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m04:11:27.759227 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:11:27.763238 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m04:11:27.770188 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_properties"
[0m04:11:27.846207 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_ship"
[0m04:11:27.855350 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m04:11:27.861772 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m04:11:27.863440 [debug] [Thread-9  ]: Began executing node model.dbtairflow.dim_part
[0m04:11:27.865454 [debug] [Thread-4  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m04:11:27.866451 [debug] [Thread-5  ]: Began executing node model.dbtairflow.dim_customer
[0m04:11:27.866451 [debug] [Thread-1  ]: Began executing node model.dbtairflow.fact_line_item_properties
[0m04:11:27.869234 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fact_line_item_ship
[0m04:11:27.870559 [debug] [Thread-7  ]: Began executing node model.dbtairflow.fct_orders
[0m04:11:27.875125 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m04:11:27.875637 [debug] [Thread-2  ]: Began executing node model.dbtairflow.dim_nation
[0m04:11:27.881161 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:11:27.888339 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m04:11:27.895044 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_properties"
[0m04:11:27.899659 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_ship"
[0m04:11:27.906864 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m04:11:27.914236 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m04:11:27.915355 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m04:11:27.919054 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:11:27.921329 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m04:11:27.923600 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.fact_line_item_properties"
[0m04:11:27.925605 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fact_line_item_ship"
[0m04:11:27.928868 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m04:11:27.929867 [debug] [Thread-9  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m04:11:27.931293 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m04:11:27.932626 [debug] [Thread-4  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final as (
    select
        part.part_key,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_part as part
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by
        part.part_key
)

select
    *
from
    final
        );
[0m04:11:27.933635 [debug] [Thread-5  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m04:11:27.934645 [debug] [Thread-1  ]: On model.dbtairflow.fact_line_item_properties: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_properties"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_properties
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        commit_date,
        receipt_date,
        return_flag,
        ship_date,
        ship_instruct,
        ship_mode
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    final
        );
[0m04:11:27.935723 [debug] [Thread-3  ]: On model.dbtairflow.fact_line_item_ship: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_ship"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_ship
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        discount,
        extended_price,
        line_number,
        line_status,
        quantity,
        tax
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    final
        );
[0m04:11:27.936735 [debug] [Thread-7  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m04:11:27.936735 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m04:11:27.938207 [debug] [Thread-2  ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m04:11:27.939473 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m04:11:27.940493 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m04:11:27.941507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:11:27.943033 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:11:27.944332 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m04:11:27.946355 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:11:28.217382 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE50AC0>]}
[0m04:11:28.221403 [info ] [Thread-8  ]: 8 of 19 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 4.16s]
[0m04:11:28.223561 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m04:11:28.225206 [debug] [Thread-8  ]: Began running node model.dbtairflow.dim_supplier
[0m04:11:28.226284 [info ] [Thread-8  ]: 18 of 19 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m04:11:28.227345 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.dim_supplier)
[0m04:11:28.228449 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.dim_supplier
[0m04:11:28.234529 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m04:11:28.236671 [debug] [Thread-8  ]: Began executing node model.dbtairflow.dim_supplier
[0m04:11:28.243202 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m04:11:28.244784 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m04:11:28.246419 [debug] [Thread-8  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m04:11:28.247593 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m04:11:29.854728 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.351 seconds
[0m04:11:29.858713 [debug] [Thread-10 ]: On model.dbtairflow.dim_region: Close
[0m04:11:30.062933 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01b6a337-0001-3c8e-0002-0e420003d0b2
[0m04:11:30.065028 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 8
invalid identifier 'DISCOUNT'
[0m04:11:30.067231 [debug] [Thread-3  ]: On model.dbtairflow.fact_line_item_ship: Close
[0m04:11:30.159022 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.654 seconds
[0m04:11:30.164997 [debug] [Thread-6  ]: On model.dbtairflow.dim_orders: Close
[0m04:11:30.678248 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE50910>]}
[0m04:11:30.680249 [info ] [Thread-10 ]: 9 of 19 OK created sql table model dbt_schema.dim_region ....................... [[32mSUCCESS 1[0m in 3.24s]
[0m04:11:30.682817 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_region
[0m04:11:30.683848 [debug] [Thread-10 ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m04:11:30.685831 [info ] [Thread-10 ]: 19 of 19 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m04:11:30.688420 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.dbtairflow.dim_region, now model.dbtairflow.fact_ability_of_supplier)
[0m04:11:30.689949 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m04:11:30.697124 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:11:30.698540 [debug] [Thread-10 ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m04:11:30.704578 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:11:30.707608 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m04:11:30.708598 [debug] [Thread-10 ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final as (
    select
        sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by
        sup.suppkey
)

select
    *
from
    final
        );
[0m04:11:30.709989 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m04:11:30.981592 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE3ECA0>]}
[0m04:11:30.983858 [info ] [Thread-6  ]: 10 of 19 OK created sql table model dbt_schema.dim_orders ...................... [[32mSUCCESS 1[0m in 3.55s]
[0m04:11:30.985220 [debug] [Thread-6  ]: Finished running node model.dbtairflow.dim_orders
[0m04:11:30.986999 [debug] [Thread-3  ]: Database Error in model fact_line_item_ship (models\marts\fact_line_item_ship.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'DISCOUNT'
  compiled Code at target\run\dbtairflow\models\marts\fact_line_item_ship.sql
[0m04:11:30.988974 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BE66A30>]}
[0m04:11:30.990484 [error] [Thread-3  ]: 15 of 19 ERROR creating sql table model dbt_schema.fact_line_item_ship ......... [[31mERROR[0m in 3.25s]
[0m04:11:30.992796 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fact_line_item_ship
[0m04:11:31.080716 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.134 seconds
[0m04:11:31.084243 [debug] [Thread-2  ]: On model.dbtairflow.dim_nation: Close
[0m04:11:31.219077 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.277 seconds
[0m04:11:31.223077 [debug] [Thread-5  ]: On model.dbtairflow.dim_customer: Close
[0m04:11:31.492780 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.245 seconds
[0m04:11:31.494780 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.557 seconds
[0m04:11:31.497780 [debug] [Thread-8  ]: On model.dbtairflow.dim_supplier: Close
[0m04:11:31.503384 [debug] [Thread-9  ]: On model.dbtairflow.dim_part: Close
[0m04:11:32.012301 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BFC2100>]}
[0m04:11:32.015308 [info ] [Thread-2  ]: 17 of 19 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 4.27s]
[0m04:11:32.025301 [debug] [Thread-2  ]: Finished running node model.dbtairflow.dim_nation
[0m04:11:32.204818 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.265 seconds
[0m04:11:32.206760 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877A9B0B20>]}
[0m04:11:32.211320 [debug] [Thread-4  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m04:11:32.213320 [info ] [Thread-5  ]: 13 of 19 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 4.47s]
[0m04:11:32.218360 [debug] [Thread-5  ]: Finished running node model.dbtairflow.dim_customer
[0m04:11:32.515488 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877C00DF70>]}
[0m04:11:32.517492 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877A833610>]}
[0m04:11:32.518899 [info ] [Thread-9  ]: 11 of 19 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 4.78s]
[0m04:11:32.521422 [info ] [Thread-8  ]: 18 of 19 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 4.29s]
[0m04:11:32.524435 [debug] [Thread-9  ]: Finished running node model.dbtairflow.dim_part
[0m04:11:32.525031 [debug] [Thread-8  ]: Finished running node model.dbtairflow.dim_supplier
[0m04:11:32.812433 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.869 seconds
[0m04:11:32.816429 [debug] [Thread-7  ]: On model.dbtairflow.fct_orders: Close
[0m04:11:33.019757 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877C0057F0>]}
[0m04:11:33.020759 [info ] [Thread-4  ]: 12 of 19 OK created sql table model dbt_schema.fact_providing_feature_of_parts . [[32mSUCCESS 1[0m in 5.28s]
[0m04:11:33.023484 [debug] [Thread-4  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:11:33.540286 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.830 seconds
[0m04:11:33.544304 [debug] [Thread-10 ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m04:11:33.638701 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BFABD00>]}
[0m04:11:33.640725 [info ] [Thread-7  ]: 16 of 19 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 5.90s]
[0m04:11:33.643176 [debug] [Thread-7  ]: Finished running node model.dbtairflow.fct_orders
[0m04:11:34.462411 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877C031670>]}
[0m04:11:34.463936 [info ] [Thread-10 ]: 19 of 19 OK created sql table model dbt_schema.fact_ability_of_supplier ........ [[32mSUCCESS 1[0m in 3.78s]
[0m04:11:34.467540 [debug] [Thread-10 ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m04:11:39.175063 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 11.233 seconds
[0m04:11:39.180822 [debug] [Thread-1  ]: On model.dbtairflow.fact_line_item_properties: Close
[0m04:11:40.191293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2a446d-a953-4078-9fd4-1b1431c27f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002877BFFF970>]}
[0m04:11:40.194025 [info ] [Thread-1  ]: 14 of 19 OK created sql table model dbt_schema.fact_line_item_properties ....... [[32mSUCCESS 1[0m in 12.45s]
[0m04:11:40.196688 [debug] [Thread-1  ]: Finished running node model.dbtairflow.fact_line_item_properties
[0m04:11:40.202775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:40.204771 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m04:11:40.205774 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m04:11:40.207770 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_properties' was properly closed.
[0m04:11:40.209758 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m04:11:40.210763 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_ship' was properly closed.
[0m04:11:40.211759 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m04:11:40.212760 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m04:11:40.214770 [debug] [MainThread]: Connection 'model.dbtairflow.dim_orders' was properly closed.
[0m04:11:40.216314 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m04:11:40.218318 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m04:11:40.220312 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m04:11:40.221306 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m04:11:40.223337 [info ] [MainThread]: 
[0m04:11:40.226032 [info ] [MainThread]: Finished running 8 view models, 11 table models in 0 hours 0 minutes and 21.58 seconds (21.58s).
[0m04:11:40.236066 [debug] [MainThread]: Command end result
[0m04:11:40.349202 [info ] [MainThread]: 
[0m04:11:40.353337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:11:40.355631 [info ] [MainThread]: 
[0m04:11:40.358652 [error] [MainThread]:   Database Error in model fact_line_item_ship (models\marts\fact_line_item_ship.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'DISCOUNT'
  compiled Code at target\run\dbtairflow\models\marts\fact_line_item_ship.sql
[0m04:11:40.360999 [info ] [MainThread]: 
[0m04:11:40.363226 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 TOTAL=19
[0m04:11:40.367818 [debug] [MainThread]: Command `dbt run` failed at 04:11:40.367818 after 23.85 seconds
[0m04:11:40.369238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028776DB82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287797624F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028779403940>]}
[0m04:11:40.371796 [debug] [MainThread]: Flushing usage events
[0m04:13:33.238317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047ECD82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040181DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040181DFD0>]}


============================== 04:13:33.246662 | 4e04603d-3026-4f24-97c7-180a943c1a37 ==============================
[0m04:13:33.246662 [info ] [MainThread]: Running with dbt=1.8.5
[0m04:13:33.248680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:13:34.366818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F11B0D0>]}
[0m04:13:34.512943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204026BA8B0>]}
[0m04:13:34.515647 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:13:34.546271 [debug] [MainThread]: checksum: c71732273854280a8fefe3dc2b53f8dd70fc7857017cb467e5e9f7da2847e4fa, vars: {}, profile: , target: dev, version: 1.8.5
[0m04:13:34.985693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:13:34.986728 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_line_item_properties.sql
[0m04:13:34.987736 [debug] [MainThread]: Partial parsing: updated file: dbtairflow://models\marts\fact_line_item_ship.sql
[0m04:13:35.550263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020402B80130>]}
[0m04:13:35.839010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020402648040>]}
[0m04:13:35.840021 [info ] [MainThread]: Found 19 models, 9 data tests, 8 sources, 565 macros
[0m04:13:35.842310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F6800D0>]}
[0m04:13:35.846587 [info ] [MainThread]: 
[0m04:13:35.848563 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:13:35.858560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB'
[0m04:13:35.885743 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB"
[0m04:13:35.885743 [debug] [ThreadPool]: On list_DBT_DB: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB"} */
show terse schemas in database DBT_DB
    limit 10000
[0m04:13:35.887180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:13:37.846286 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.959 seconds
[0m04:13:37.850865 [debug] [ThreadPool]: On list_DBT_DB: Close
[0m04:13:38.771714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DB_dbt_schema'
[0m04:13:38.792244 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DB_dbt_schema"
[0m04:13:38.793282 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "connection_name": "list_DBT_DB_dbt_schema"} */
show objects in DBT_DB.dbt_schema limit 10000
[0m04:13:38.794271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:13:40.517555 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.723 seconds
[0m04:13:40.521599 [debug] [ThreadPool]: On list_DBT_DB_dbt_schema: Close
[0m04:13:41.332490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F6800D0>]}
[0m04:13:41.334542 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m04:13:41.335353 [info ] [MainThread]: 
[0m04:13:41.348251 [debug] [Thread-1  ]: Began running node model.dbtairflow.stg_tpch_customer
[0m04:13:41.349241 [debug] [Thread-2  ]: Began running node model.dbtairflow.stg_tpch_line_items
[0m04:13:41.351247 [debug] [Thread-3  ]: Began running node model.dbtairflow.stg_tpch_nation
[0m04:13:41.352240 [debug] [Thread-4  ]: Began running node model.dbtairflow.stg_tpch_orders
[0m04:13:41.353242 [debug] [Thread-5  ]: Began running node model.dbtairflow.stg_tpch_part
[0m04:13:41.355239 [debug] [Thread-6  ]: Began running node model.dbtairflow.stg_tpch_partsupp
[0m04:13:41.357233 [debug] [Thread-7  ]: Began running node model.dbtairflow.stg_tpch_region
[0m04:13:41.358244 [debug] [Thread-8  ]: Began running node model.dbtairflow.stg_tpch_supplier
[0m04:13:41.356233 [info ] [Thread-1  ]: 1 of 19 START sql view model dbt_schema.stg_tpch_customer ...................... [RUN]
[0m04:13:41.360236 [info ] [Thread-2  ]: 2 of 19 START sql view model dbt_schema.stg_tpch_line_items .................... [RUN]
[0m04:13:41.362726 [info ] [Thread-3  ]: 3 of 19 START sql view model dbt_schema.stg_tpch_nation ........................ [RUN]
[0m04:13:41.369443 [info ] [Thread-4  ]: 4 of 19 START sql view model dbt_schema.stg_tpch_orders ........................ [RUN]
[0m04:13:41.377231 [info ] [Thread-5  ]: 5 of 19 START sql view model dbt_schema.stg_tpch_part .......................... [RUN]
[0m04:13:41.384652 [info ] [Thread-6  ]: 6 of 19 START sql view model dbt_schema.stg_tpch_partsupp ...................... [RUN]
[0m04:13:41.387843 [info ] [Thread-7  ]: 7 of 19 START sql view model dbt_schema.stg_tpch_region ........................ [RUN]
[0m04:13:41.394271 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_customer'
[0m04:13:41.391860 [info ] [Thread-8  ]: 8 of 19 START sql view model dbt_schema.stg_tpch_supplier ...................... [RUN]
[0m04:13:41.397244 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_line_items'
[0m04:13:41.400687 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_nation'
[0m04:13:41.406087 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_orders'
[0m04:13:41.409680 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_part'
[0m04:13:41.411665 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_partsupp'
[0m04:13:41.413734 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_region'
[0m04:13:41.416024 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.stg_tpch_customer
[0m04:13:41.418341 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.dbtairflow.stg_tpch_supplier'
[0m04:13:41.421363 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.stg_tpch_line_items
[0m04:13:41.427387 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.stg_tpch_nation
[0m04:13:41.429384 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.stg_tpch_orders
[0m04:13:41.432380 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.stg_tpch_part
[0m04:13:41.434872 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.stg_tpch_partsupp
[0m04:13:41.436390 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.stg_tpch_region
[0m04:13:41.463611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_customer"
[0m04:13:41.464609 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.stg_tpch_supplier
[0m04:13:41.500509 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_line_items"
[0m04:13:41.507998 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_nation"
[0m04:13:41.515141 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_orders"
[0m04:13:41.524359 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_part"
[0m04:13:41.531517 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:13:41.543055 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_region"
[0m04:13:41.552238 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.stg_tpch_supplier"
[0m04:13:41.553296 [debug] [Thread-1  ]: Began executing node model.dbtairflow.stg_tpch_customer
[0m04:13:41.555897 [debug] [Thread-2  ]: Began executing node model.dbtairflow.stg_tpch_line_items
[0m04:13:41.556923 [debug] [Thread-3  ]: Began executing node model.dbtairflow.stg_tpch_nation
[0m04:13:41.557929 [debug] [Thread-4  ]: Began executing node model.dbtairflow.stg_tpch_orders
[0m04:13:41.560056 [debug] [Thread-5  ]: Began executing node model.dbtairflow.stg_tpch_part
[0m04:13:41.562190 [debug] [Thread-6  ]: Began executing node model.dbtairflow.stg_tpch_partsupp
[0m04:13:41.564240 [debug] [Thread-7  ]: Began executing node model.dbtairflow.stg_tpch_region
[0m04:13:41.595022 [debug] [Thread-8  ]: Began executing node model.dbtairflow.stg_tpch_supplier
[0m04:13:41.615636 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_customer"
[0m04:13:41.622888 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_line_items"
[0m04:13:41.630631 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_nation"
[0m04:13:41.638120 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_orders"
[0m04:13:41.645121 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_part"
[0m04:13:41.652827 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_partsupp"
[0m04:13:41.660147 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_region"
[0m04:13:41.667124 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.stg_tpch_supplier"
[0m04:13:41.672171 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.stg_tpch_customer"
[0m04:13:41.675057 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.stg_tpch_line_items"
[0m04:13:41.677072 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.stg_tpch_orders"
[0m04:13:41.679086 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.stg_tpch_nation"
[0m04:13:41.682574 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.stg_tpch_part"
[0m04:13:41.683602 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.stg_tpch_partsupp"
[0m04:13:41.686879 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.stg_tpch_region"
[0m04:13:41.688911 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.stg_tpch_supplier"
[0m04:13:41.689916 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_customer"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_customer
  
   as (
    select
    C_ACCTBAL as acc_tbal,
    C_ADDRESS as cust_address,
    C_COMMENT as comment,
    C_CUSTKEY as cust_key,
    C_MKTSEGMENT as mkt_segment,
    C_NAME as cust_name,
    C_NATIONKEY as nation_key,
    C_PHONE as phone
from
    snowflake_sample_data.tpch_sf1.customer
  );
[0m04:13:41.691358 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_line_items"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(L_ORDERKEY as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(L_LINENUMBER as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
    L_COMMITDATE as commit_date,
    L_DISCOUNT as discount_percentage,
    L_EXTENDEDPRICE as extended_price,
    L_LINENUMBER as line_number,
    L_LINESTATUS as line_status,
    L_ORDERKEY as order_key,
    L_PARTKEY as part_key,
    L_QUANTITY as quantity,
    L_RECEIPTDATE as receipt_date,
    L_RETURNFLAG as return_flag,
    L_SHIPDATE as ship_date,
    L_SHIPINSTRUCT as ship_instruct,
    L_SHIPMODE as ship_mode,
    L_SUPPKEY as supp_key,
    L_TAX as tax
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m04:13:41.692878 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_orders"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_orders
  
   as (
    select
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as status_code,
    o_totalprice as total_price,
    o_orderdate as order_date
from
    snowflake_sample_data.tpch_sf1.orders
  );
[0m04:13:41.693913 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_nation"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_nation
  
   as (
    select
    N_COMMENT as comment,
    N_NAME as nation_name,
    N_NATIONKEY as nation_key,
    N_REGIONKEY as region_key
from
    snowflake_sample_data.tpch_sf1.nation
  );
[0m04:13:41.694931 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_part"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_part
  
   as (
    select
    P_BRAND as brand,
    P_COMMENT as comment,
    P_NAME as name,
    P_PARTKEY as part_key,
    P_RETAILPRICE as retail_price,
    P_SIZE as part_size,
    P_TYPE as part_type
from
    snowflake_sample_data.tpch_sf1.part
  );
[0m04:13:41.696242 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_partsupp"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_partsupp
  
   as (
    select
    PS_AVAILQTY as avail_qty,
    PS_COMMENT as comment,
    PS_PARTKEY as part_key,
    PS_SUPPKEY as supp_key,
    PS_SUPPLYCOST as supply_cost
from
    snowflake_sample_data.tpch_sf1.partsupp
  );
[0m04:13:41.697881 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_region"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_region
  
   as (
    select
    R_COMMENT as comment,
    R_NAME as region_name,
    R_REGIONKEY AS region_key
from
    snowflake_sample_data.tpch_sf1.region
  );
[0m04:13:41.698901 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.stg_tpch_supplier"} */
create or replace   view DBT_DB.dbt_schema.stg_tpch_supplier
  
   as (
    select
    S_ACCTBAL as acctbal,
    S_ADDRESS as address,
    S_COMMENT as comment,
    S_NAME as name,
    S_NATIONKEY as nationkey,
    S_PHONE as phone,
    S_SUPPKEY as suppkey
from 
    snowflake_sample_data.tpch_sf1.supplier
  );
[0m04:13:41.700902 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m04:13:41.701918 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:13:41.703274 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:13:41.704293 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:13:41.705669 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m04:13:41.707011 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m04:13:41.708208 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m04:13:41.709224 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m04:13:44.201981 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.499 seconds
[0m04:13:44.253517 [debug] [Thread-4  ]: On model.dbtairflow.stg_tpch_orders: Close
[0m04:13:44.407300 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.699 seconds
[0m04:13:44.412712 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.706 seconds
[0m04:13:44.415056 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.706 seconds
[0m04:13:44.418182 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.712 seconds
[0m04:13:44.419210 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.715 seconds
[0m04:13:44.424236 [debug] [Thread-7  ]: On model.dbtairflow.stg_tpch_region: Close
[0m04:13:44.425247 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.725 seconds
[0m04:13:44.430291 [debug] [Thread-6  ]: On model.dbtairflow.stg_tpch_partsupp: Close
[0m04:13:44.435836 [debug] [Thread-8  ]: On model.dbtairflow.stg_tpch_supplier: Close
[0m04:13:44.440808 [debug] [Thread-5  ]: On model.dbtairflow.stg_tpch_part: Close
[0m04:13:44.446278 [debug] [Thread-3  ]: On model.dbtairflow.stg_tpch_nation: Close
[0m04:13:44.454295 [debug] [Thread-1  ]: On model.dbtairflow.stg_tpch_customer: Close
[0m04:13:44.486004 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.784 seconds
[0m04:13:44.498167 [debug] [Thread-2  ]: On model.dbtairflow.stg_tpch_line_items: Close
[0m04:13:45.129626 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC4CA0>]}
[0m04:13:45.132034 [info ] [Thread-4  ]: 4 of 19 OK created sql view model dbt_schema.stg_tpch_orders ................... [[32mSUCCESS 1[0m in 3.72s]
[0m04:13:45.135080 [debug] [Thread-4  ]: Finished running node model.dbtairflow.stg_tpch_orders
[0m04:13:45.137453 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_orders
[0m04:13:45.138811 [info ] [Thread-10 ]: 9 of 19 START sql table model dbt_schema.dim_orders ............................ [RUN]
[0m04:13:45.141758 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbtairflow.dim_orders'
[0m04:13:45.144311 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_orders
[0m04:13:45.153652 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_orders"
[0m04:13:45.155681 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_orders
[0m04:13:45.211446 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_orders"
[0m04:13:45.215433 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_orders"
[0m04:13:45.217435 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_orders"} */
create or replace transient table DBT_DB.dbt_schema.dim_orders
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_orders
        );
[0m04:13:45.218433 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m04:13:45.435951 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403FF0FD0>]}
[0m04:13:45.438347 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204040AE9A0>]}
[0m04:13:45.439340 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC4FA0>]}
[0m04:13:45.440339 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020404012E50>]}
[0m04:13:45.442300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC4700>]}
[0m04:13:45.443820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC46D0>]}
[0m04:13:45.444828 [info ] [Thread-6  ]: 6 of 19 OK created sql view model dbt_schema.stg_tpch_partsupp ................. [[32mSUCCESS 1[0m in 4.03s]
[0m04:13:45.448827 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC4A30>]}
[0m04:13:45.447832 [info ] [Thread-8  ]: 8 of 19 OK created sql view model dbt_schema.stg_tpch_supplier ................. [[32mSUCCESS 1[0m in 4.02s]
[0m04:13:45.450834 [info ] [Thread-5  ]: 5 of 19 OK created sql view model dbt_schema.stg_tpch_part ..................... [[32mSUCCESS 1[0m in 4.03s]
[0m04:13:45.452832 [info ] [Thread-7  ]: 7 of 19 OK created sql view model dbt_schema.stg_tpch_region ................... [[32mSUCCESS 1[0m in 4.03s]
[0m04:13:45.454841 [info ] [Thread-1  ]: 1 of 19 OK created sql view model dbt_schema.stg_tpch_customer ................. [[32mSUCCESS 1[0m in 4.05s]
[0m04:13:45.459842 [debug] [Thread-6  ]: Finished running node model.dbtairflow.stg_tpch_partsupp
[0m04:13:45.457844 [info ] [Thread-2  ]: 2 of 19 OK created sql view model dbt_schema.stg_tpch_line_items ............... [[32mSUCCESS 1[0m in 4.05s]
[0m04:13:45.463833 [debug] [Thread-8  ]: Finished running node model.dbtairflow.stg_tpch_supplier
[0m04:13:45.461836 [info ] [Thread-3  ]: 3 of 19 OK created sql view model dbt_schema.stg_tpch_nation ................... [[32mSUCCESS 1[0m in 4.05s]
[0m04:13:45.465834 [debug] [Thread-5  ]: Finished running node model.dbtairflow.stg_tpch_part
[0m04:13:45.467790 [debug] [Thread-7  ]: Finished running node model.dbtairflow.stg_tpch_region
[0m04:13:45.469900 [debug] [Thread-1  ]: Finished running node model.dbtairflow.stg_tpch_customer
[0m04:13:45.472892 [debug] [Thread-2  ]: Finished running node model.dbtairflow.stg_tpch_line_items
[0m04:13:45.474889 [debug] [Thread-4  ]: Began running node model.dbtairflow.dim_supplier
[0m04:13:45.475887 [debug] [Thread-9  ]: Began running node model.dbtairflow.fact_ability_of_supplier
[0m04:13:45.477889 [debug] [Thread-3  ]: Finished running node model.dbtairflow.stg_tpch_nation
[0m04:13:45.479504 [debug] [Thread-8  ]: Began running node model.dbtairflow.dim_part
[0m04:13:45.480877 [debug] [Thread-6  ]: Began running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:13:45.481886 [debug] [Thread-5  ]: Began running node model.dbtairflow.dim_region
[0m04:13:45.483893 [debug] [Thread-7  ]: Began running node model.dbtairflow.dim_customer
[0m04:13:45.485890 [debug] [Thread-1  ]: Began running node model.dbtairflow.fact_line_item_properties
[0m04:13:45.488051 [debug] [Thread-2  ]: Began running node model.dbtairflow.fact_line_item_ship
[0m04:13:45.489271 [info ] [Thread-4  ]: 10 of 19 START sql table model dbt_schema.dim_supplier ......................... [RUN]
[0m04:13:45.491289 [info ] [Thread-9  ]: 11 of 19 START sql table model dbt_schema.fact_ability_of_supplier ............. [RUN]
[0m04:13:45.493499 [debug] [Thread-3  ]: Began running node model.dbtairflow.fct_orders
[0m04:13:45.494927 [info ] [Thread-8  ]: 12 of 19 START sql table model dbt_schema.dim_part ............................. [RUN]
[0m04:13:45.496948 [info ] [Thread-6  ]: 13 of 19 START sql table model dbt_schema.fact_providing_feature_of_parts ...... [RUN]
[0m04:13:45.499311 [info ] [Thread-5  ]: 14 of 19 START sql table model dbt_schema.dim_region ........................... [RUN]
[0m04:13:45.501325 [info ] [Thread-7  ]: 15 of 19 START sql table model dbt_schema.dim_customer ......................... [RUN]
[0m04:13:45.504329 [info ] [Thread-1  ]: 16 of 19 START sql table model dbt_schema.fact_line_item_properties ............ [RUN]
[0m04:13:45.507329 [info ] [Thread-2  ]: 17 of 19 START sql table model dbt_schema.fact_line_item_ship .................. [RUN]
[0m04:13:45.509826 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_orders, now model.dbtairflow.dim_supplier)
[0m04:13:45.511364 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.dbtairflow.fact_ability_of_supplier'
[0m04:13:45.512396 [info ] [Thread-3  ]: 18 of 19 START sql table model dbt_schema.fct_orders ........................... [RUN]
[0m04:13:45.514894 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_supplier, now model.dbtairflow.dim_part)
[0m04:13:45.516916 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_partsupp, now model.dbtairflow.fact_providing_feature_of_parts)
[0m04:13:45.518432 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_part, now model.dbtairflow.dim_region)
[0m04:13:45.520455 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_region, now model.dbtairflow.dim_customer)
[0m04:13:45.522990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_customer, now model.dbtairflow.fact_line_item_properties)
[0m04:13:45.523986 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_line_items, now model.dbtairflow.fact_line_item_ship)
[0m04:13:45.525985 [debug] [Thread-4  ]: Began compiling node model.dbtairflow.dim_supplier
[0m04:13:45.526984 [debug] [Thread-9  ]: Began compiling node model.dbtairflow.fact_ability_of_supplier
[0m04:13:45.529009 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbtairflow.stg_tpch_nation, now model.dbtairflow.fct_orders)
[0m04:13:45.531006 [debug] [Thread-8  ]: Began compiling node model.dbtairflow.dim_part
[0m04:13:45.532677 [debug] [Thread-6  ]: Began compiling node model.dbtairflow.fact_providing_feature_of_parts
[0m04:13:45.533673 [debug] [Thread-5  ]: Began compiling node model.dbtairflow.dim_region
[0m04:13:45.535682 [debug] [Thread-7  ]: Began compiling node model.dbtairflow.dim_customer
[0m04:13:45.537198 [debug] [Thread-1  ]: Began compiling node model.dbtairflow.fact_line_item_properties
[0m04:13:45.539216 [debug] [Thread-2  ]: Began compiling node model.dbtairflow.fact_line_item_ship
[0m04:13:45.546357 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtairflow.dim_supplier"
[0m04:13:45.553431 [debug] [Thread-9  ]: Writing injected SQL for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:13:45.555429 [debug] [Thread-3  ]: Began compiling node model.dbtairflow.fct_orders
[0m04:13:45.560424 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtairflow.dim_part"
[0m04:13:45.567427 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:13:45.575059 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtairflow.dim_region"
[0m04:13:45.587741 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtairflow.dim_customer"
[0m04:13:45.676520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_properties"
[0m04:13:45.684519 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtairflow.fact_line_item_ship"
[0m04:13:45.696595 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtairflow.fct_orders"
[0m04:13:45.698595 [debug] [Thread-4  ]: Began executing node model.dbtairflow.dim_supplier
[0m04:13:45.700595 [debug] [Thread-9  ]: Began executing node model.dbtairflow.fact_ability_of_supplier
[0m04:13:45.703606 [debug] [Thread-8  ]: Began executing node model.dbtairflow.dim_part
[0m04:13:45.704604 [debug] [Thread-6  ]: Began executing node model.dbtairflow.fact_providing_feature_of_parts
[0m04:13:45.705603 [debug] [Thread-5  ]: Began executing node model.dbtairflow.dim_region
[0m04:13:45.707800 [debug] [Thread-7  ]: Began executing node model.dbtairflow.dim_customer
[0m04:13:45.709336 [debug] [Thread-1  ]: Began executing node model.dbtairflow.fact_line_item_properties
[0m04:13:45.717101 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtairflow.dim_supplier"
[0m04:13:45.718101 [debug] [Thread-2  ]: Began executing node model.dbtairflow.fact_line_item_ship
[0m04:13:45.720075 [debug] [Thread-3  ]: Began executing node model.dbtairflow.fct_orders
[0m04:13:45.727070 [debug] [Thread-9  ]: Writing runtime sql for node "model.dbtairflow.fact_ability_of_supplier"
[0m04:13:45.735339 [debug] [Thread-8  ]: Writing runtime sql for node "model.dbtairflow.dim_part"
[0m04:13:45.742306 [debug] [Thread-6  ]: Writing runtime sql for node "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:13:45.748448 [debug] [Thread-5  ]: Writing runtime sql for node "model.dbtairflow.dim_region"
[0m04:13:45.754416 [debug] [Thread-7  ]: Writing runtime sql for node "model.dbtairflow.dim_customer"
[0m04:13:45.763267 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_properties"
[0m04:13:45.771162 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtairflow.fact_line_item_ship"
[0m04:13:45.772146 [debug] [Thread-4  ]: Using snowflake connection "model.dbtairflow.dim_supplier"
[0m04:13:45.778999 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtairflow.fct_orders"
[0m04:13:45.783753 [debug] [Thread-9  ]: Using snowflake connection "model.dbtairflow.fact_ability_of_supplier"
[0m04:13:45.785176 [debug] [Thread-8  ]: Using snowflake connection "model.dbtairflow.dim_part"
[0m04:13:45.788192 [debug] [Thread-6  ]: Using snowflake connection "model.dbtairflow.fact_providing_feature_of_parts"
[0m04:13:45.790193 [debug] [Thread-5  ]: Using snowflake connection "model.dbtairflow.dim_region"
[0m04:13:45.792290 [debug] [Thread-7  ]: Using snowflake connection "model.dbtairflow.dim_customer"
[0m04:13:45.794856 [debug] [Thread-1  ]: Using snowflake connection "model.dbtairflow.fact_line_item_properties"
[0m04:13:45.796402 [debug] [Thread-4  ]: On model.dbtairflow.dim_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_supplier"} */
create or replace transient table DBT_DB.dbt_schema.dim_supplier
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_supplier
        );
[0m04:13:45.798421 [debug] [Thread-2  ]: Using snowflake connection "model.dbtairflow.fact_line_item_ship"
[0m04:13:45.799417 [debug] [Thread-9  ]: On model.dbtairflow.fact_ability_of_supplier: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_ability_of_supplier"} */
create or replace transient table DBT_DB.dbt_schema.fact_ability_of_supplier
         as
        (with final as (
    select
        sup.suppkey,
        count(part_supp.supp_key) as number_of_parts,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_supplier as sup
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on sup.suppkey = part_supp.supp_key
    group by
        sup.suppkey
)

select
    *
from
    final
        );
[0m04:13:45.803227 [debug] [Thread-3  ]: Using snowflake connection "model.dbtairflow.fct_orders"
[0m04:13:45.803734 [debug] [Thread-8  ]: On model.dbtairflow.dim_part: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_part"} */
create or replace transient table DBT_DB.dbt_schema.dim_part
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_part
        );
[0m04:13:45.805742 [debug] [Thread-6  ]: On model.dbtairflow.fact_providing_feature_of_parts: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_providing_feature_of_parts"} */
create or replace transient table DBT_DB.dbt_schema.fact_providing_feature_of_parts
         as
        (with final as (
    select
        part.part_key,
        count(part_supp.supp_key) as number_of_suppliers,
        sum(part_supp.supply_cost) as total_supply_cost,
        sum(part_supp.avail_qty) as total_supply_quantity
    from
        DBT_DB.dbt_schema.stg_tpch_part as part
    join
        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp
        on part.part_key = part_supp.part_key
    group by
        part.part_key
)

select
    *
from
    final
        );
[0m04:13:45.806742 [debug] [Thread-5  ]: On model.dbtairflow.dim_region: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_region"} */
create or replace transient table DBT_DB.dbt_schema.dim_region
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_region
        );
[0m04:13:45.807820 [debug] [Thread-7  ]: On model.dbtairflow.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_customer"} */
create or replace transient table DBT_DB.dbt_schema.dim_customer
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_customer
        );
[0m04:13:45.808915 [debug] [Thread-1  ]: On model.dbtairflow.fact_line_item_properties: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_properties"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_properties
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        discount_percentage,
        extended_price,
        line_number,
        line_status,
        quantity,
        tax
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    final
        );
[0m04:13:45.810059 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m04:13:45.811114 [debug] [Thread-2  ]: On model.dbtairflow.fact_line_item_ship: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fact_line_item_ship"} */
create or replace transient table DBT_DB.dbt_schema.fact_line_item_ship
         as
        (with final as (
    select
        order_item_key,
        order_key,
        part_key,
        supp_key,
        commit_date,
        receipt_date,
        return_flag,
        ship_date,
        ship_instruct,
        ship_mode
    from
        DBT_DB.dbt_schema.stg_tpch_line_items as part_key
)

select
    *
from
    final
        );
[0m04:13:45.812126 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m04:13:45.813325 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.fct_orders"} */
create or replace transient table DBT_DB.dbt_schema.fct_orders
         as
        (with int_order_items as (
    select
        line_item.order_item_key,
        line_item.part_key,
        line_item.line_number,
        line_item.extended_price,
        orders.order_key,
        orders.customer_key,
        orders.order_date,
        
    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)
 as item_discount_amount
    from
        DBT_DB.dbt_schema.stg_tpch_orders as orders
    join
        DBT_DB.dbt_schema.stg_tpch_line_items as line_item
            on orders.order_key = line_item.order_key
    order by
        orders.order_date
),

final as (
    select 
        order_key,
        sum(extended_price) as gross_item_sales_amount,
        sum(item_discount_amount) as item_discount_amount
    from
        int_order_items
    group by
        order_key
)

-- final as (
--     select
--         orders.*,
--         order_item_summary.gross_item_sales_amount,
--         order_item_summary.item_discount_amount
--     from
--         DBT_DB.dbt_schema.stg_tpch_orders as orders
--     join
--         int_order_items_sum as order_item_summary
--             on orders.order_key = order_item_summary.order_key
--     order by 
--         orders.order_date
-- )

select * from final
        );
[0m04:13:45.814388 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m04:13:45.815623 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m04:13:45.816742 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m04:13:45.817939 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m04:13:45.818946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:13:45.822474 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:13:45.826404 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:13:47.880086 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.662 seconds
[0m04:13:47.886085 [debug] [Thread-10 ]: On model.dbtairflow.dim_orders: Close
[0m04:13:48.699055 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047FDA6A90>]}
[0m04:13:48.701079 [info ] [Thread-10 ]: 9 of 19 OK created sql table model dbt_schema.dim_orders ....................... [[32mSUCCESS 1[0m in 3.56s]
[0m04:13:48.704513 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_orders
[0m04:13:48.705028 [debug] [Thread-10 ]: Began running node model.dbtairflow.dim_nation
[0m04:13:48.706897 [info ] [Thread-10 ]: 19 of 19 START sql table model dbt_schema.dim_nation ........................... [RUN]
[0m04:13:48.709626 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.dbtairflow.dim_orders, now model.dbtairflow.dim_nation)
[0m04:13:48.711692 [debug] [Thread-10 ]: Began compiling node model.dbtairflow.dim_nation
[0m04:13:48.719442 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbtairflow.dim_nation"
[0m04:13:48.722445 [debug] [Thread-10 ]: Began executing node model.dbtairflow.dim_nation
[0m04:13:48.730434 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbtairflow.dim_nation"
[0m04:13:48.732897 [debug] [Thread-10 ]: Using snowflake connection "model.dbtairflow.dim_nation"
[0m04:13:48.734916 [debug] [Thread-10 ]: On model.dbtairflow.dim_nation: /* {"app": "dbt", "dbt_version": "1.8.5", "profile_name": "dbtairflow", "target_name": "dev", "node_id": "model.dbtairflow.dim_nation"} */
create or replace transient table DBT_DB.dbt_schema.dim_nation
         as
        (select * from DBT_DB.dbt_schema.stg_tpch_nation
        );
[0m04:13:48.737222 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m04:13:48.784677 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.975 seconds
[0m04:13:48.790455 [debug] [Thread-4  ]: On model.dbtairflow.dim_supplier: Close
[0m04:13:49.005106 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.189 seconds
[0m04:13:49.009650 [debug] [Thread-6  ]: On model.dbtairflow.fact_providing_feature_of_parts: Close
[0m04:13:49.240992 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.424 seconds
[0m04:13:49.246509 [debug] [Thread-5  ]: On model.dbtairflow.dim_region: Close
[0m04:13:49.521817 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.710 seconds
[0m04:13:49.527869 [debug] [Thread-9  ]: On model.dbtairflow.fact_ability_of_supplier: Close
[0m04:13:49.529858 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040410AD00>]}
[0m04:13:49.533789 [info ] [Thread-4  ]: 10 of 19 OK created sql table model dbt_schema.dim_supplier .................... [[32mSUCCESS 1[0m in 4.02s]
[0m04:13:49.538258 [debug] [Thread-4  ]: Finished running node model.dbtairflow.dim_supplier
[0m04:13:49.738623 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403F11AC0>]}
[0m04:13:49.742560 [info ] [Thread-6  ]: 13 of 19 OK created sql table model dbt_schema.fact_providing_feature_of_parts . [[32mSUCCESS 1[0m in 4.22s]
[0m04:13:49.746133 [debug] [Thread-6  ]: Finished running node model.dbtairflow.fact_providing_feature_of_parts
[0m04:13:49.931056 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.113 seconds
[0m04:13:49.935927 [debug] [Thread-7  ]: On model.dbtairflow.dim_customer: Close
[0m04:13:50.236176 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040410A1F0>]}
[0m04:13:50.239193 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.424 seconds
[0m04:13:50.241257 [info ] [Thread-5  ]: 14 of 19 OK created sql table model dbt_schema.dim_region ...................... [[32mSUCCESS 1[0m in 4.72s]
[0m04:13:50.247694 [debug] [Thread-8  ]: On model.dbtairflow.dim_part: Close
[0m04:13:50.250719 [debug] [Thread-5  ]: Finished running node model.dbtairflow.dim_region
[0m04:13:50.349588 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040410AE50>]}
[0m04:13:50.351587 [info ] [Thread-9  ]: 11 of 19 OK created sql table model dbt_schema.fact_ability_of_supplier ........ [[32mSUCCESS 1[0m in 4.84s]
[0m04:13:50.353579 [debug] [Thread-9  ]: Finished running node model.dbtairflow.fact_ability_of_supplier
[0m04:13:50.756231 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403EC4640>]}
[0m04:13:50.757236 [info ] [Thread-7  ]: 15 of 19 OK created sql table model dbt_schema.dim_customer .................... [[32mSUCCESS 1[0m in 5.24s]
[0m04:13:50.760233 [debug] [Thread-7  ]: Finished running node model.dbtairflow.dim_customer
[0m04:13:51.157524 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.421 seconds
[0m04:13:51.159517 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204026A6160>]}
[0m04:13:51.163516 [debug] [Thread-10 ]: On model.dbtairflow.dim_nation: Close
[0m04:13:51.165517 [info ] [Thread-8  ]: 12 of 19 OK created sql table model dbt_schema.dim_part ........................ [[32mSUCCESS 1[0m in 5.64s]
[0m04:13:51.168938 [debug] [Thread-8  ]: Finished running node model.dbtairflow.dim_part
[0m04:13:51.884108 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.058 seconds
[0m04:13:51.889595 [debug] [Thread-3  ]: On model.dbtairflow.fct_orders: Close
[0m04:13:51.975685 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403E99220>]}
[0m04:13:51.977893 [info ] [Thread-10 ]: 19 of 19 OK created sql table model dbt_schema.dim_nation ...................... [[32mSUCCESS 1[0m in 3.27s]
[0m04:13:51.980543 [debug] [Thread-10 ]: Finished running node model.dbtairflow.dim_nation
[0m04:13:52.694449 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020403F74370>]}
[0m04:13:52.696453 [info ] [Thread-3  ]: 18 of 19 OK created sql table model dbt_schema.fct_orders ...................... [[32mSUCCESS 1[0m in 7.17s]
[0m04:13:52.698649 [debug] [Thread-3  ]: Finished running node model.dbtairflow.fct_orders
[0m04:13:59.962476 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 14.143 seconds
[0m04:13:59.964990 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 14.142 seconds
[0m04:13:59.969840 [debug] [Thread-1  ]: On model.dbtairflow.fact_line_item_properties: Close
[0m04:13:59.974841 [debug] [Thread-2  ]: On model.dbtairflow.fact_line_item_ship: Close
[0m04:14:00.785063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204041089A0>]}
[0m04:14:00.786064 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e04603d-3026-4f24-97c7-180a943c1a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020404108EE0>]}
[0m04:14:00.788410 [info ] [Thread-1  ]: 16 of 19 OK created sql table model dbt_schema.fact_line_item_properties ....... [[32mSUCCESS 1[0m in 15.26s]
[0m04:14:00.790730 [info ] [Thread-2  ]: 17 of 19 OK created sql table model dbt_schema.fact_line_item_ship ............. [[32mSUCCESS 1[0m in 15.26s]
[0m04:14:00.793620 [debug] [Thread-1  ]: Finished running node model.dbtairflow.fact_line_item_properties
[0m04:14:00.797146 [debug] [Thread-2  ]: Finished running node model.dbtairflow.fact_line_item_ship
[0m04:14:00.802075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:14:00.803451 [debug] [MainThread]: Connection 'list_DBT_DB' was properly closed.
[0m04:14:00.805869 [debug] [MainThread]: Connection 'list_DBT_DB_dbt_schema' was properly closed.
[0m04:14:00.807257 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_properties' was properly closed.
[0m04:14:00.807257 [debug] [MainThread]: Connection 'model.dbtairflow.fact_line_item_ship' was properly closed.
[0m04:14:00.809975 [debug] [MainThread]: Connection 'model.dbtairflow.fct_orders' was properly closed.
[0m04:14:00.811992 [debug] [MainThread]: Connection 'model.dbtairflow.dim_supplier' was properly closed.
[0m04:14:00.813483 [debug] [MainThread]: Connection 'model.dbtairflow.dim_region' was properly closed.
[0m04:14:00.813483 [debug] [MainThread]: Connection 'model.dbtairflow.fact_providing_feature_of_parts' was properly closed.
[0m04:14:00.816047 [debug] [MainThread]: Connection 'model.dbtairflow.dim_customer' was properly closed.
[0m04:14:00.817248 [debug] [MainThread]: Connection 'model.dbtairflow.dim_part' was properly closed.
[0m04:14:00.818655 [debug] [MainThread]: Connection 'model.dbtairflow.dim_nation' was properly closed.
[0m04:14:00.819993 [debug] [MainThread]: Connection 'model.dbtairflow.fact_ability_of_supplier' was properly closed.
[0m04:14:00.821250 [info ] [MainThread]: 
[0m04:14:00.824117 [info ] [MainThread]: Finished running 8 view models, 11 table models in 0 hours 0 minutes and 24.97 seconds (24.97s).
[0m04:14:00.832417 [debug] [MainThread]: Command end result
[0m04:14:00.929486 [info ] [MainThread]: 
[0m04:14:00.931517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:14:00.932862 [info ] [MainThread]: 
[0m04:14:00.935352 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m04:14:00.937877 [debug] [MainThread]: Command `dbt run` succeeded at 04:14:00.937877 after 27.82 seconds
[0m04:14:00.938898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047ECD82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F200C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020402648040>]}
[0m04:14:00.939895 [debug] [MainThread]: Flushing usage events
