{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2024-08-27T21:14:00.825137Z", "invocation_id": "4e04603d-3026-4f24-97c7-180a943c1a37", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.510008Z", "completed_at": "2024-08-27T21:13:41.557929Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.631608Z", "completed_at": "2024-08-27T21:13:44.253517Z"}], "thread_id": "Thread-4", "execution_time": 3.7234244346618652, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c9a-0002-0e42000470de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_orders", "compiled": true, "compiled_code": "select\n    o_orderkey as order_key,\n    o_custkey as customer_key,\n    o_orderstatus as status_code,\n    o_totalprice as total_price,\n    o_orderdate as order_date\nfrom\n    snowflake_sample_data.tpch_sf1.orders", "relation_name": "DBT_DB.dbt_schema.stg_tpch_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.526359Z", "completed_at": "2024-08-27T21:13:41.562190Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.646787Z", "completed_at": "2024-08-27T21:13:44.430291Z"}], "thread_id": "Thread-6", "execution_time": 4.025278568267822, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c2e-0002-0e4200050016"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_partsupp", "compiled": true, "compiled_code": "select\n    PS_AVAILQTY as avail_qty,\n    PS_COMMENT as comment,\n    PS_PARTKEY as part_key,\n    PS_SUPPKEY as supp_key,\n    PS_SUPPLYCOST as supply_cost\nfrom\n    snowflake_sample_data.tpch_sf1.partsupp", "relation_name": "DBT_DB.dbt_schema.stg_tpch_partsupp"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.545402Z", "completed_at": "2024-08-27T21:13:41.595022Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.661148Z", "completed_at": "2024-08-27T21:13:44.434827Z"}], "thread_id": "Thread-8", "execution_time": 4.020208835601807, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c90-0002-0e420004a0d6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_supplier", "compiled": true, "compiled_code": "select\n    S_ACCTBAL as acctbal,\n    S_ADDRESS as address,\n    S_COMMENT as comment,\n    S_NAME as name,\n    S_NATIONKEY as nationkey,\n    S_PHONE as phone,\n    S_SUPPKEY as suppkey\nfrom \n    snowflake_sample_data.tpch_sf1.supplier", "relation_name": "DBT_DB.dbt_schema.stg_tpch_supplier"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.516149Z", "completed_at": "2024-08-27T21:13:41.560056Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.639083Z", "completed_at": "2024-08-27T21:13:44.440808Z"}], "thread_id": "Thread-5", "execution_time": 4.030693292617798, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c85-0002-0e42000440c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_part", "compiled": true, "compiled_code": "select\n    P_BRAND as brand,\n    P_COMMENT as comment,\n    P_NAME as name,\n    P_PARTKEY as part_key,\n    P_RETAILPRICE as retail_price,\n    P_SIZE as part_size,\n    P_TYPE as part_type\nfrom\n    snowflake_sample_data.tpch_sf1.part", "relation_name": "DBT_DB.dbt_schema.stg_tpch_part"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.533423Z", "completed_at": "2024-08-27T21:13:41.564240Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.654085Z", "completed_at": "2024-08-27T21:13:44.424236Z"}], "thread_id": "Thread-7", "execution_time": 4.0266053676605225, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c8d-0002-0e420004daea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_region", "compiled": true, "compiled_code": "select\n    R_COMMENT as comment,\n    R_NAME as region_name,\n    R_REGIONKEY AS region_key\nfrom\n    snowflake_sample_data.tpch_sf1.region", "relation_name": "DBT_DB.dbt_schema.stg_tpch_region"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.437864Z", "completed_at": "2024-08-27T21:13:41.553296Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.565912Z", "completed_at": "2024-08-27T21:13:44.454295Z"}], "thread_id": "Thread-1", "execution_time": 4.048029184341431, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c86-0002-0e420004e0de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_customer", "compiled": true, "compiled_code": "select\n    C_ACCTBAL as acc_tbal,\n    C_ADDRESS as cust_address,\n    C_COMMENT as comment,\n    C_CUSTKEY as cust_key,\n    C_MKTSEGMENT as mkt_segment,\n    C_NAME as cust_name,\n    C_NATIONKEY as nation_key,\n    C_PHONE as phone\nfrom\n    snowflake_sample_data.tpch_sf1.customer", "relation_name": "DBT_DB.dbt_schema.stg_tpch_customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.465615Z", "completed_at": "2024-08-27T21:13:41.555897Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.616842Z", "completed_at": "2024-08-27T21:13:44.498167Z"}], "thread_id": "Thread-2", "execution_time": 4.048105239868164, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c8e-0002-0e420003d0c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_line_items", "compiled": true, "compiled_code": "select\n    md5(cast(coalesce(cast(L_ORDERKEY as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(L_LINENUMBER as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,\n    L_COMMITDATE as commit_date,\n    L_DISCOUNT as discount_percentage,\n    L_EXTENDEDPRICE as extended_price,\n    L_LINENUMBER as line_number,\n    L_LINESTATUS as line_status,\n    L_ORDERKEY as order_key,\n    L_PARTKEY as part_key,\n    L_QUANTITY as quantity,\n    L_RECEIPTDATE as receipt_date,\n    L_RETURNFLAG as return_flag,\n    L_SHIPDATE as ship_date,\n    L_SHIPINSTRUCT as ship_instruct,\n    L_SHIPMODE as ship_mode,\n    L_SUPPKEY as supp_key,\n    L_TAX as tax\nfrom\n    snowflake_sample_data.tpch_sf1.lineitem", "relation_name": "DBT_DB.dbt_schema.stg_tpch_line_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:41.502515Z", "completed_at": "2024-08-27T21:13:41.556923Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:41.623905Z", "completed_at": "2024-08-27T21:13:44.445766Z"}], "thread_id": "Thread-3", "execution_time": 4.050568342208862, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c83-0002-0e420004b0da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.stg_tpch_nation", "compiled": true, "compiled_code": "select\n    N_COMMENT as comment,\n    N_NAME as nation_name,\n    N_NATIONKEY as nation_key,\n    N_REGIONKEY as region_key\nfrom\n    snowflake_sample_data.tpch_sf1.nation", "relation_name": "DBT_DB.dbt_schema.stg_tpch_nation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.145337Z", "completed_at": "2024-08-27T21:13:45.155681Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.157690Z", "completed_at": "2024-08-27T21:13:47.886085Z"}], "thread_id": "Thread-10", "execution_time": 3.5572972297668457, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c85-0002-0e42000440ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_orders", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_orders", "relation_name": "DBT_DB.dbt_schema.dim_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.540213Z", "completed_at": "2024-08-27T21:13:45.698595Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.710600Z", "completed_at": "2024-08-27T21:13:48.790455Z"}], "thread_id": "Thread-4", "execution_time": 4.020046234130859, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c5e-0002-0e42000430e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_supplier", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_supplier", "relation_name": "DBT_DB.dbt_schema.dim_supplier"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.562429Z", "completed_at": "2024-08-27T21:13:45.703606Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.736336Z", "completed_at": "2024-08-27T21:13:49.008626Z"}], "thread_id": "Thread-6", "execution_time": 4.221473455429077, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c86-0002-0e420004e0e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.fact_providing_feature_of_parts", "compiled": true, "compiled_code": "with final as (\n    select\n        part.part_key,\n        count(part_supp.supp_key) as number_of_suppliers,\n        sum(part_supp.supply_cost) as total_supply_cost,\n        sum(part_supp.avail_qty) as total_supply_quantity\n    from\n        DBT_DB.dbt_schema.stg_tpch_part as part\n    join\n        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp\n        on part.part_key = part_supp.part_key\n    group by\n        part.part_key\n)\n\nselect\n    *\nfrom\n    final", "relation_name": "DBT_DB.dbt_schema.fact_providing_feature_of_parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.568432Z", "completed_at": "2024-08-27T21:13:45.705603Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.743303Z", "completed_at": "2024-08-27T21:13:49.246509Z"}], "thread_id": "Thread-5", "execution_time": 4.716754674911499, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c9a-0002-0e42000470e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_region", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_region", "relation_name": "DBT_DB.dbt_schema.dim_region"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.547378Z", "completed_at": "2024-08-27T21:13:45.700595Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.721077Z", "completed_at": "2024-08-27T21:13:49.526870Z"}], "thread_id": "Thread-9", "execution_time": 4.838771104812622, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c83-0002-0e420004b0de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.fact_ability_of_supplier", "compiled": true, "compiled_code": "with final as (\n    select\n        sup.suppkey,\n        count(part_supp.supp_key) as number_of_parts,\n        sum(part_supp.supply_cost) as total_supply_cost,\n        sum(part_supp.avail_qty) as total_supply_quantity\n    from\n        DBT_DB.dbt_schema.stg_tpch_supplier as sup\n    join\n        DBT_DB.dbt_schema.stg_tpch_partsupp as part_supp\n        on sup.suppkey = part_supp.supp_key\n    group by\n        sup.suppkey\n)\n\nselect\n    *\nfrom\n    final", "relation_name": "DBT_DB.dbt_schema.fact_ability_of_supplier"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.576578Z", "completed_at": "2024-08-27T21:13:45.706786Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.749420Z", "completed_at": "2024-08-27T21:13:49.935927Z"}], "thread_id": "Thread-7", "execution_time": 5.235776424407959, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c2e-0002-0e420005001e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_customer", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_customer", "relation_name": "DBT_DB.dbt_schema.dim_customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.556426Z", "completed_at": "2024-08-27T21:13:45.702606Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.728085Z", "completed_at": "2024-08-27T21:13:50.247694Z"}], "thread_id": "Thread-8", "execution_time": 5.64363169670105, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c83-0002-0e420004b0e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_part", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_part", "relation_name": "DBT_DB.dbt_schema.dim_part"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:48.712614Z", "completed_at": "2024-08-27T21:13:48.721444Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:48.724442Z", "completed_at": "2024-08-27T21:13:51.162515Z"}], "thread_id": "Thread-10", "execution_time": 3.2671780586242676, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c8a-0002-0e420004c0f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.dim_nation", "compiled": true, "compiled_code": "select * from DBT_DB.dbt_schema.stg_tpch_nation", "relation_name": "DBT_DB.dbt_schema.dim_nation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.686519Z", "completed_at": "2024-08-27T21:13:45.720075Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.773480Z", "completed_at": "2024-08-27T21:13:51.889595Z"}], "thread_id": "Thread-3", "execution_time": 7.16543984413147, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c8a-0002-0e420004c0ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.fct_orders", "compiled": true, "compiled_code": "with int_order_items as (\n    select\n        line_item.order_item_key,\n        line_item.part_key,\n        line_item.line_number,\n        line_item.extended_price,\n        orders.order_key,\n        orders.customer_key,\n        orders.order_date,\n        \n    (-1 * line_item.extended_price * line_item.discount_percentage)::decimal(16, 2)\n as item_discount_amount\n    from\n        DBT_DB.dbt_schema.stg_tpch_orders as orders\n    join\n        DBT_DB.dbt_schema.stg_tpch_line_items as line_item\n            on orders.order_key = line_item.order_key\n    order by\n        orders.order_date\n),\n\nfinal as (\n    select \n        order_key,\n        sum(extended_price) as gross_item_sales_amount,\n        sum(item_discount_amount) as item_discount_amount\n    from\n        int_order_items\n    group by\n        order_key\n)\n\n-- final as (\n--     select\n--         orders.*,\n--         order_item_summary.gross_item_sales_amount,\n--         order_item_summary.item_discount_amount\n--     from\n--         DBT_DB.dbt_schema.stg_tpch_orders as orders\n--     join\n--         int_order_items_sum as order_item_summary\n--             on orders.order_key = order_item_summary.order_key\n--     order by \n--         orders.order_date\n-- )\n\nselect * from final", "relation_name": "DBT_DB.dbt_schema.fct_orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.588849Z", "completed_at": "2024-08-27T21:13:45.709336Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.756419Z", "completed_at": "2024-08-27T21:13:59.969840Z"}], "thread_id": "Thread-1", "execution_time": 15.262087345123291, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c2e-0002-0e420005001a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.fact_line_item_properties", "compiled": true, "compiled_code": "with final as (\n    select\n        order_item_key,\n        order_key,\n        part_key,\n        supp_key,\n        discount_percentage,\n        extended_price,\n        line_number,\n        line_status,\n        quantity,\n        tax\n    from\n        DBT_DB.dbt_schema.stg_tpch_line_items as part_key\n)\n\nselect\n    *\nfrom\n    final", "relation_name": "DBT_DB.dbt_schema.fact_line_item_properties"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-27T21:13:45.677519Z", "completed_at": "2024-08-27T21:13:45.718101Z"}, {"name": "execute", "started_at": "2024-08-27T21:13:45.765392Z", "completed_at": "2024-08-27T21:13:59.973841Z"}], "thread_id": "Thread-2", "execution_time": 15.262077331542969, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b6a339-0001-3c8d-0002-0e420004daee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtairflow.fact_line_item_ship", "compiled": true, "compiled_code": "with final as (\n    select\n        order_item_key,\n        order_key,\n        part_key,\n        supp_key,\n        commit_date,\n        receipt_date,\n        return_flag,\n        ship_date,\n        ship_instruct,\n        ship_mode\n    from\n        DBT_DB.dbt_schema.stg_tpch_line_items as part_key\n)\n\nselect\n    *\nfrom\n    final", "relation_name": "DBT_DB.dbt_schema.fact_line_item_ship"}], "elapsed_time": 24.972686529159546, "args": {"defer": false, "write_json": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "quiet": false, "static_parser": true, "log_path": "E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow\\logs", "log_format_file": "debug", "log_format": "default", "use_colors": true, "vars": {}, "empty": false, "require_resource_names_without_spaces": false, "strict_mode": false, "invocation_command": "dbt run --profiles-dir . --target dev", "partial_parse": true, "exclude": [], "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "macro_debugging": false, "printer_width": 80, "select": [], "indirect_selection": "eager", "introspect": true, "log_file_max_bytes": 10485760, "log_level": "info", "version_check": true, "profiles_dir": ".", "populate_cache": true, "cache_selected_only": false, "use_colors_file": true, "enable_legacy_logger": false, "favor_state": false, "show_resource_report": false, "send_anonymous_usage_stats": true, "target": "dev", "require_explicit_package_overrides_for_builtin_materializations": true, "project_dir": "E:\\Programing\\DE\\Practice\\dbt-snowflake\\aiflow-dag\\dags\\dbt\\dbtairflow", "print": true}}